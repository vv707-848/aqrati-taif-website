<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <title>Ø§Ù„Ù†Ø®Ø¨Ø© Ø§Ù„Ø¹Ù‚Ø§Ø±ÙŠØ© â€” Ù…Ù†ØµØ© Ø¹Ù‚Ø§Ø±Ø§Øª Ø§Ø­ØªØ±Ø§ÙÙŠØ©</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="Ù…Ù†ØµØ© Ø§Ù„Ù†Ø®Ø¨Ø© Ø§Ù„Ø¹Ù‚Ø§Ø±ÙŠØ© - Ø¹Ø±Ø¶ ÙˆØ¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¹Ù‚Ø§Ø±Ø§ØªØŒ Ù…ÙˆØ§ÙÙ‚Ø© Ø¥Ø¯Ø§Ø±ÙŠØ©ØŒ ØªÙˆØ§ØµÙ„ Ø¹Ø¨Ø± ÙˆØ§ØªØ³Ø§Ø¨" />
  <style>
    /* ---------------------------
       Reset & Base
       --------------------------- */
    * { box-sizing: border-box; }
    html,body { height:100%; }
    body {
      margin:0;
      font-family: "Segoe UI", Tahoma, Arial, "Helvetica Neue", sans-serif;
      background: linear-gradient(180deg,#f5f7fb 0%, #eef3f8 100%);
      color:#1b2b34;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      direction: rtl;
      line-height:1.5;
    }
    a { color:inherit; text-decoration:none; }
    button { cursor:pointer; }

    /* ---------------------------
       Top Navbar / Header
       --------------------------- */
    .topbar {
      position:sticky;
      top:0;
      z-index:999;
      backdrop-filter: blur(6px);
      background: linear-gradient(90deg, rgba(16,24,32,0.85), rgba(20,110,120,0.85));
      color:white;
      padding:12px 20px;
      display:flex;
      align-items:center;
      gap:12px;
      box-shadow: 0 6px 18px rgba(11,30,40,0.18);
    }
    .brand {
      display:flex;
      align-items:center;
      gap:12px;
      margin-right:auto;
    }
    .logo {
      width:48px;
      height:48px;
      border-radius:10px;
      background: linear-gradient(135deg,#ffd166,#ef476f);
      display:flex;
      align-items:center;
      justify-content:center;
      font-weight:700;
      color:#112;
      box-shadow:0 6px 14px rgba(0,0,0,0.18);
    }
    .site-title {
      font-size:1.15rem;
      font-weight:700;
      letter-spacing:0.3px;
    }
    .site-tagline { font-size:0.8rem; opacity:0.9; }

    .top-actions { display:flex; gap:8px; align-items:center; }
    .btn {
      border: none;
      padding:8px 12px;
      border-radius:8px;
      font-weight:700;
      background:rgba(255,255,255,0.12);
      color:white;
      transition:transform .15s ease, background .15s ease;
    }
    .btn:hover { transform:translateY(-3px); background:rgba(255,255,255,0.18); }
    .btn-primary {
      background:linear-gradient(90deg,#ff7a7a,#ffb36b);
      color:#142026;
      box-shadow:0 6px 18px rgba(255,120,120,0.18);
    }
    .btn-outline {
      background:transparent;
      border:1px solid rgba(255,255,255,0.12);
    }
    .search-wrap {
      display:flex;
      gap:8px;
      align-items:center;
      background:rgba(255,255,255,0.06);
      padding:6px;
      border-radius:10px;
      min-width:280px;
    }
    .search-wrap input {
      background:transparent;
      border:none;
      outline:none;
      color:white;
      padding:6px;
      width:220px;
    }

    /* ---------------------------
       Main Layout
       --------------------------- */
    .container {
      max-width:1200px;
      margin:28px auto;
      padding:0 16px;
    }

    .hero {
      display:flex;
      gap:22px;
      align-items:center;
      background:linear-gradient(90deg,#ffffff, #f8fbff);
      border-radius:14px;
      padding:18px;
      box-shadow:0 8px 22px rgba(19,43,56,0.06);
      overflow:hidden;
    }
    .hero-left { flex:1; min-width:300px; }
    .hero-right { width:360px; display:flex; justify-content:center; }
    .hero h2 { margin:0 0 8px; font-size:1.6rem; color:#113; }
    .hero p { margin:0 0 12px; color:#456; }

    .quick-actions { display:flex; gap:10px; flex-wrap:wrap; }
    .quick-card {
      background:linear-gradient(180deg,#fff,#f6fdff);
      border-radius:12px;
      padding:12px;
      min-width:160px;
      box-shadow:0 6px 18px rgba(16,24,32,0.04);
      display:flex;
      gap:10px;
      align-items:center;
      border:1px solid rgba(10,40,50,0.03);
    }
    .quick-icon {
      width:44px; height:44px; border-radius:8px; display:flex; align-items:center; justify-content:center;
      background:linear-gradient(135deg,#6dd3ff,#87f0d8); color:#042; font-weight:800;
    }

    /* ---------------------------
       Filters & Categories
       --------------------------- */
    .filters {
      display:flex;
      gap:12px;
      align-items:center;
      margin:18px 0;
      flex-wrap:wrap;
    }
    .category-pill {
      padding:8px 14px;
      background:linear-gradient(180deg,#fff,#f7fbff);
      border-radius:999px;
      box-shadow:0 6px 18px rgba(10,20,30,0.03);
      border:1px solid rgba(10,20,30,0.04);
      font-weight:700;
      cursor:pointer;
      transition:transform .12s ease, background .12s;
    }
    .category-pill.active {
      background:linear-gradient(90deg,#ffd166,#ff7a7a);
      color:#152029;
      transform:translateY(-3px);
    }

    /* ---------------------------
       Grid of property cards
       --------------------------- */
    .grid {
      display:grid;
      grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
      gap:16px;
    }
    .card {
      background: linear-gradient(180deg,#ffffff,#fbfeff);
      border-radius:12px;
      overflow:hidden;
      box-shadow:0 10px 25px rgba(12,28,36,0.06);
      transition: transform .18s ease, box-shadow .18s ease;
      position:relative;
      border:1px solid rgba(8,20,28,0.03);
    }
    .card:hover { transform: translateY(-6px); box-shadow:0 18px 35px rgba(12,28,36,0.08); }

    .card-media {
      height:180px;
      background:#ddd;
      position:relative;
      overflow:hidden;
    }
    .card-media img {
      width:100%;
      height:100%;
      object-fit:cover;
      display:block;
      transition: transform .6s cubic-bezier(.2,.8,.25,1);
    }
    .card:hover .card-media img { transform: scale(1.06); }

    .badge {
      position:absolute;
      top:12px;
      left:12px;
      background:linear-gradient(90deg,#ff8a65,#ffb86b);
      color:white;
      padding:6px 8px;
      border-radius:8px;
      font-weight:800;
      font-size:0.8rem;
      box-shadow:0 8px 18px rgba(255,120,80,0.12);
    }
    .card-body { padding:12px 14px; }
    .card-title { font-weight:800; color:#044; margin:0 0 6px; }
    .card-loc { color:#568; font-size:0.9rem; margin-bottom:8px; }
    .card-meta { display:flex; justify-content:space-between; gap:8px; align-items:center; }
    .price { font-weight:900; color:#ff6b6b; font-size:1rem; }
    .meta-small { font-size:0.85rem; color:#667; }

    .card-actions { margin-top:10px; display:flex; gap:8px; align-items:center; justify-content:space-between; }
    .btn-small { padding:8px 10px; border-radius:8px; border:none; font-weight:800; }
    .btn-ghost { background:transparent; border:1px solid rgba(10,20,30,0.06); color:#123; }
    .btn-ws { background:linear-gradient(90deg,#25d366,#128c7e); color:white; }

    /* ---------------------------
       Detail view modal
       --------------------------- */
    .modal {
      position:fixed;
      inset:0;
      display:none;
      align-items:center;
      justify-content:center;
      background:linear-gradient(0deg, rgba(0,0,0,0.45), rgba(0,0,0,0.45));
      z-index:1200;
      padding:20px;
    }
    .modal.show { display:flex; }
    .detail {
      width:100%;
      max-width:1000px;
      background:white;
      border-radius:12px;
      overflow:hidden;
      display:flex;
      gap:12px;
      box-shadow:0 20px 50px rgba(12,28,36,0.25);
      animation: pop .18s ease;
    }
    @keyframes pop { from { transform:translateY(10px) scale(.99); opacity:0 } to { transform:none; opacity:1 } }
    .detail-left { flex:1; min-width:300px; background:#fafafa; padding:14px; }
    .gallery { display:flex; gap:8px; flex-direction:column; align-items:center; }
    .main-img { width:100%; height:420px; background:#ddd; border-radius:10px; overflow:hidden; }
    .main-img img { width:100%; height:100%; object-fit:cover; display:block; }
    .thumbs { display:flex; gap:8px; margin-top:12px; }
    .thumbs img { width:84px; height:62px; object-fit:cover; border-radius:8px; cursor:pointer; border:2px solid transparent; transition:border .12s ease; }
    .thumbs img.active { border-color:#00bfa6; }

    .detail-right { width:420px; background:white; padding:18px; display:flex; flex-direction:column; gap:12px; }
    .detail-right h3 { margin:0; color:#043; font-size:1.25rem; }
    .detail-row { display:flex; justify-content:space-between; align-items:center; gap:8px; }
    .detail-box { background:linear-gradient(180deg,#fff,#fbfbfe); border-radius:8px; padding:12px; border:1px solid rgba(8,20,28,0.04); }
    .label { font-weight:800; color:#2b3b3f; margin-bottom:6px; display:block; }
    .desc { color:#445; white-space:pre-line; }

    .back-link { margin-top:6px; color:#556; font-weight:700; cursor:pointer; }

    /* ---------------------------
       Add Property Modal (form)
       --------------------------- */
    .form-grid { display:grid; gap:12px; grid-template-columns: 1fr; }
    .small-hint { font-size:0.85rem; color:#667; }
    .input, textarea, select {
      width:100%;
      padding:10px 12px;
      border-radius:8px;
      border:1px solid #e0e6ea;
      outline:none;
      font-size:0.95rem;
    }
    textarea { min-height:110px; resize:vertical; }
    .images-preview { display:flex; gap:8px; margin-top:6px; }
    .img-slot { width:100px; height:72px; border-radius:8px; background:#f4f7f9; border:1px dashed #d7e2e8; display:flex; align-items:center; justify-content:center; font-weight:700; color:#99a; overflow:hidden; }
    .img-slot img { width:100%; height:100%; object-fit:cover; display:block; }

    .form-actions { display:flex; gap:8px; justify-content:flex-start; margin-top:8px; }

    /* ---------------------------
       Admin panel styles
       --------------------------- */
    .admin-panel { margin-top:16px; background:linear-gradient(180deg,#fff,#fbfeff); border-radius:12px; padding:14px; box-shadow:0 10px 24px rgba(12,28,36,0.06); }
    .admin-row { display:flex; gap:12px; flex-wrap:wrap; align-items:center; }
    .admin-card { flex:1; min-width:200px; background:white; border-radius:8px; padding:12px; border:1px solid rgba(6,20,24,0.03); box-shadow:0 8px 18px rgba(12,28,36,0.03); }
    .table { width:100%; border-collapse:collapse; margin-top:12px; font-size:0.95rem; }
    .table th, .table td { padding:8px 10px; border-bottom:1px solid #f0f3f6; text-align:right; }
    .table thead th { background:#f7fafc; color:#123; font-weight:800; }
    .tag { padding:6px 8px; border-radius:999px; font-weight:800; font-size:0.85rem; }

    /* ---------------------------
       Footer
       --------------------------- */
    footer { padding:22px; text-align:center; color:#567; font-size:0.95rem; margin-top:30px; }

    /* ---------------------------
       Responsive
       --------------------------- */
    @media (max-width:980px) {
      .detail { flex-direction:column; max-height:90vh; overflow:auto; }
      .detail-left, .detail-right { width:100%; }
      .hero-right { display:none; }
      .search-wrap input { width:120px; }
      .topbar { padding:10px; gap:8px; }
    }
  </style>
</head>
<body>

  <!-- TOP NAVBAR -->
  <div class="topbar">
    <div class="brand">
      <div class="logo" id="logoText">Ù†Ø®</div>
      <div>
        <div class="site-title" id="siteNameDisplay">Ø§Ù„Ù†Ø®Ø¨Ø© Ø§Ù„Ø¹Ù‚Ø§Ø±ÙŠØ©</div>
        <div class="site-tagline">Ù…Ù†ØµØ© Ø¹Ø±Ø¶ ÙˆØ¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¹Ù‚Ø§Ø±Ø§Øª</div>
      </div>
    </div>

    <div class="search-wrap" title="Ø¨Ø­Ø« Ø³Ø±ÙŠØ¹">
      <svg width="18" height="18" viewBox="0 0 24 24" fill="none" style="opacity:.95;margin-left:6px">
        <path d="M21 21l-4.35-4.35" stroke="white" stroke-width="1.6" stroke-linecap="round"/>
        <circle cx="11" cy="11" r="6" stroke="white" stroke-width="1.6"/>
      </svg>
      <input id="globalSearch" placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† Ø¹Ù†ÙˆØ§Ù†ØŒ Ù…ÙˆÙ‚Ø¹ØŒ Ø³Ø¹Ø±..." />
    </div>

    <div class="top-actions">
      <button class="btn btn-outline" id="btnShowAdd">Ø¥Ø¶Ø§ÙØ© Ø¹Ù‚Ø§Ø±</button>
      <button class="btn btn-outline" id="btnSiteEdit">ØªØ¹Ø¯ÙŠÙ„ Ø§Ø³Ù… Ø§Ù„Ù…ÙˆÙ‚Ø¹</button>
      <button class="btn btn-primary" id="btnLogin">Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…Ø¯ÙŠØ±</button>
    </div>
  </div>

  <!-- MAIN CONTAINER -->
  <div class="container">

    <!-- HERO -->
    <section class="hero" aria-label="Ù…Ù‚Ø¯Ù…Ø©">
      <div class="hero-left">
        <h2>Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ø§Ù„Ù†Ø®Ø¨Ø© Ø§Ù„Ø¹Ù‚Ø§Ø±ÙŠØ©</h2>
        <p>Ø§Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ø¹Ù‚Ø§Ø± Ø§Ù„Ù…Ù†Ø§Ø³Ø¨ Ø£Ùˆ Ø£Ø¶Ù Ø¹Ø±Ø¶Ùƒ Ø¨Ø³Ù‡ÙˆÙ„Ø© â€” Ø³Ù†Ø±Ø¹Ø§Ù‡ Ø­ØªÙ‰ ÙŠÙˆØ§ÙÙ‚ Ø§Ù„Ù…Ø¯ÙŠØ± Ù‚Ø¨Ù„ Ø§Ù„Ù†Ø´Ø± Ø§Ù„Ø¹Ø§Ù….</p>

        <div class="quick-actions" style="margin-top:10px;">
          <div class="quick-card">
            <div class="quick-icon">ğŸ </div>
            <div>
              <div style="font-weight:900">Ø¹Ø±Ø¶ Ù…ØªÙ†ÙˆØ¹</div>
              <div class="small-hint">ÙÙ„Ù„ØŒ Ø´Ù‚Ù‚ØŒ Ø£Ø±Ø§Ø¶ÙŠØŒ Ø§Ø³ØªØ±Ø§Ø­Ø§Øª ÙˆØ§Ù„Ù…Ø²ÙŠØ¯</div>
            </div>
          </div>
          <div class="quick-card">
            <div class="quick-icon">ğŸ›¡ï¸</div>
            <div>
              <div style="font-weight:900">Ù…ÙˆØ§ÙÙ‚Ø© Ø¢Ù…Ù†Ø©</div>
              <div class="small-hint">Ø§Ù„Ø¹Ù‚Ø§Ø±Ø§Øª ØªØ¸Ù‡Ø± Ø¨Ø¹Ø¯ Ù…ÙˆØ§ÙÙ‚Ø© Ø§Ù„Ù…Ø¯ÙŠØ±</div>
            </div>
          </div>
          <div class="quick-card">
            <div class="quick-icon">âœ‰ï¸</div>
            <div>
              <div style="font-weight:900">ØªÙˆØ§ØµÙ„ Ø¨Ø³ÙŠØ·</div>
              <div class="small-hint">Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨ ÙŠÙˆØ¬Ù‡ Ù„Ù„Ù…Ø¯ÙŠØ± Ù…Ø¹ Ø±Ù‚Ù… Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†</div>
            </div>
          </div>
        </div>
      </div>

      <div class="hero-right">
        <img src="https://images.unsplash.com/photo-1560448204-e02f11c3d0e2?q=80&w=900&auto=format&fit=crop&ixlib=rb-4.0.3&s=8f1e59f3cf5d74c8b6f6e8b6b8f2d3c1" alt="hero" style="width:100%;height:220px;object-fit:cover;border-radius:12px;box-shadow:0 10px 28px rgba(12,28,36,0.08)" />
      </div>
    </section>

    <!-- FILTERS -->
    <div class="filters" role="navigation" aria-label="ÙØ¦Ø§Øª">
      <div class="category-pill active" data-cat="all">Ø§Ù„ÙƒÙ„</div>
      <div class="category-pill" data-cat="ÙÙ„Ù„">ÙÙ„Ù„</div>
      <div class="category-pill" data-cat="Ø´Ù‚Ù‚">Ø´Ù‚Ù‚</div>
      <div class="category-pill" data-cat="Ø¹Ù…Ø§Ø¦Ø±">Ø¹Ù…Ø§Ø¦Ø±</div>
      <div class="category-pill" data-cat="Ø£Ø±Ø§Ø¶ÙŠ">Ø£Ø±Ø§Ø¶ÙŠ</div>
      <div class="category-pill" data-cat="Ø§Ø³ØªØ±Ø§Ø­Ø§Øª">Ø§Ø³ØªØ±Ø§Ø­Ø§Øª</div>
      <div class="category-pill" data-cat="Ø£Ø¯ÙˆØ§Ø± Ù…Ø³ØªÙ‚Ù„Ø©">Ø£Ø¯ÙˆØ§Ø± Ù…Ø³ØªÙ‚Ù„Ø©</div>

      <div style="margin-left:auto; display:flex; gap:8px; align-items:center;">
        <select id="sortSelect" class="input" style="width:auto; padding:8px 10px;">
          <option value="recent">Ø§Ù„Ø£Ø­Ø¯Ø«</option>
          <option value="price-asc">Ø§Ù„Ø³Ø¹Ø±: Ù…Ù† Ø§Ù„Ø£Ù‚Ù„</option>
          <option value="price-desc">Ø§Ù„Ø³Ø¹Ø±: Ù…Ù† Ø§Ù„Ø£Ø¹Ù„Ù‰</option>
        </select>
      </div>
    </div>

    <!-- PROPERTIES GRID -->
    <section>
      <div id="propertiesCount" style="font-weight:800; margin-bottom:8px; color:#234">Ø§Ù„Ø¹Ù‚Ø§Ø±Ø§Øª Ø§Ù„Ù…ØªØ§Ø­Ø©: <span id="cntVal">0</span></div>
      <div class="grid" id="propertiesGrid" aria-live="polite">
        <!-- Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ø¹Ù‚Ø§Ø±Ø§Øª ØªÙÙ…Ù„Ø£ Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ§Ù‹ -->
      </div>
    </section>

    <!-- ADMIN PANEL (collapsed by default) -->
    <section id="adminSection" style="margin-top:24px; display:none;">
      <div class="admin-panel">
        <div style="display:flex; gap:12px; align-items:center; justify-content:space-between;">
          <h3 style="margin:0">Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø¯ÙŠØ± â€” Ø¹Ø±Ø¶ ÙˆØ¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¹Ù‚Ø§Ø±Ø§Øª</h3>
          <div style="display:flex; gap:8px; align-items:center;">
            <div style="font-weight:900; color:#045">Ù…Ø±Ø­Ø¨Ø§Ù‹ØŒ Ø§Ù„Ù…Ø¯ÙŠØ±</div>
            <button class="btn btn-outline" id="btnLogout">ØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬</button>
          </div>
        </div>

        <div style="margin-top:12px;" class="admin-row">
          <div class="admin-card">
            <div style="font-size:0.85rem; color:#567">Ø¹Ù‚Ø§Ø±Ø§Øª Ø¨Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø©</div>
            <div id="pendingCount" style="font-weight:900; font-size:1.4rem; margin-top:8px">0</div>
          </div>
          <div class="admin-card">
            <div style="font-size:0.85rem; color:#567">Ø¹Ù‚Ø§Ø±Ø§Øª Ù…ÙØ¹ØªÙ…Ø¯Ø©</div>
            <div id="approvedCount" style="font-weight:900; font-size:1.4rem; margin-top:8px">0</div>
          </div>
          <div class="admin-card">
            <div style="font-size:0.85rem; color:#567">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¹Ù‚Ø§Ø±Ø§Øª</div>
            <div id="totalCount" style="font-weight:900; font-size:1.4rem; margin-top:8px">0</div>
          </div>
        </div>

        <div style="margin-top:16px;">
          <h4 style="margin-bottom:8px">Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¹Ù‚Ø§Ø±Ø§Øª Ø¨Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø©</h4>
          <table class="table" id="pendingTable" aria-describedby="pendingCount">
            <thead>
              <tr><th>Ø±Ù‚Ù…</th><th>Ø§Ù„Ø¹Ù†ÙˆØ§Ù†</th><th>Ø§Ù„Ù‚Ø³Ù…</th><th>Ø§Ù„Ø³Ø¹Ø±</th><th>Ø§Ù„Ù…Ø§Ù„Ùƒ</th><th>Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th></tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>

        <div style="margin-top:18px;">
          <h4 style="margin-bottom:8px">Ø¹Ù‚Ø§Ø±Ø§Øª Ø§Ù„Ù…Ø¯ÙŠØ±</h4>
          <table class="table" id="managerTable">
            <thead>
              <tr><th>Ø±Ù‚Ù…</th><th>Ø§Ù„Ø¹Ù†ÙˆØ§Ù†</th><th>Ø§Ù„Ù‚Ø³Ù…</th><th>Ø§Ù„Ø³Ø¹Ø±</th><th>Ø§Ù„Ø­Ø§Ù„Ø©</th><th>Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th></tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>

      </div>
    </section>

    <footer>
      Â© 2025 Ø§Ù„Ù†Ø®Ø¨Ø© Ø§Ù„Ø¹Ù‚Ø§Ø±ÙŠØ© â€” Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø©. â€” Ø§Ù„ØªØµÙ…ÙŠÙ… Ø§Ø­ØªØ±Ø§ÙÙŠ ÙˆØ¬Ø§Ù‡Ø² Ù„Ù„Ø±Ø¨Ø· Ø¨Ù€ Firebase.
    </footer>
  </div>

  <!-- ===========================
       MODALS
       =========================== -->

  <!-- Property Detail Modal -->
  <div id="detailModal" class="modal" aria-hidden="true" aria-label="ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø¹Ù‚Ø§Ø±">
    <div class="detail" role="dialog" aria-modal="true">
      <div class="detail-left">
        <div class="gallery">
          <div class="main-img" id="detailMainImg">
            <img src="" alt="ØµÙˆØ±Ø© Ø§Ù„Ø¹Ù‚Ø§Ø± Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©" id="detailMainImgImg">
          </div>
          <div class="thumbs" id="detailThumbs"></div>
        </div>
      </div>

      <div class="detail-right">
        <div style="display:flex; justify-content:space-between; align-items:center;">
          <h3 id="detailTitle">Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø¹Ù‚Ø§Ø±</h3>
          <div style="text-align:left;">
            <div class="tag" id="detailStatus" style="background:#ffd166;color:#222">Ù…ÙˆØ§ÙÙ‚</div>
          </div>
        </div>

        <div class="detail-box">
          <span class="label">Ø§Ù„Ù…ÙˆÙ‚Ø¹</span>
          <div id="detailLocation" class="meta-small">Ø§Ù„Ø±ÙŠØ§Ø¶ - Ø­ÙŠ ...</div>
        </div>

        <div class="detail-box">
          <span class="label">Ø§Ù„Ù…ÙˆØ§ØµÙØ§Øª</span>
          <div class="detail-row">
            <div class="meta-small"><strong>Ø§Ù„Ø³Ø¹Ø±:</strong> <span id="detailPrice">0</span> Ø±.Ø³</div>
            <div class="meta-small"><strong>Ø§Ù„Ù…Ø³Ø§Ø­Ø©:</strong> <span id="detailArea">0</span> Ù…Â²</div>
          </div>
        </div>

        <div class="detail-box">
          <span class="label">Ø­Ø§Ù„Ø© Ø§Ù„ØµÙƒ / Ø§Ù„Ø¨Ù†Ùƒ</span>
          <div id="detailDeed" class="meta-small">Ø§Ù„ØµÙƒ: Ù†Ø¹Ù… â€” Ù‚Ø¨ÙˆÙ„ Ø§Ù„Ø¨Ù†Ùƒ: Ù„Ø§</div>
        </div>

        <div class="detail-box">
          <span class="label">Ø§Ù„ÙˆØµÙ</span>
          <div id="detailDesc" class="desc">ÙˆØµÙ Ø§Ù„Ø¹Ù‚Ø§Ø± Ù‡Ù†Ø§...</div>
        </div>

        <div style="display:flex; gap:10px; margin-top:6px; align-items:center;">
          <a id="whatsappBtn" class="btn btn-ws" target="_blank" rel="noopener noreferrer">Ù…Ø±Ø§Ø³Ù„Ø© Ø¹Ø¨Ø± ÙˆØ§ØªØ³Ø§Ø¨ (Ù„Ù„Ù…Ø¯ÙŠØ±)</a>
          <button class="btn btn-ghost" id="backBtn" onclick="closeDetail()">Ø±Ø¬ÙˆØ¹</button>
        </div>

        <div style="font-size:0.85rem; color:#667; margin-top:6px;">
          <strong>Ù…Ù„Ø§Ø­Ø¸Ø©:</strong> Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ ÙˆØ§ØªØ³Ø§Ø¨ Ø³ÙŠÙØªØ­ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø© Ù…Ø¹ Ø±Ù‚Ù… Ø§Ù„Ù…Ø¯ÙŠØ± Ù…Ø¹ Ù†Øµ ÙŠØ­ØªÙˆÙŠ Ø±Ù‚Ù… Ø§Ù„Ø¹Ù‚Ø§Ø± Ù„ØªØ³Ù‡ÙŠÙ„ Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø©.
        </div>

      </div>
    </div>
  </div>

  <!-- Add Property Modal -->
  <div id="addModal" class="modal" aria-hidden="true" aria-label="Ø¥Ø¶Ø§ÙØ© Ø¹Ù‚Ø§Ø±">
    <div class="detail" role="dialog" style="max-width:820px;">
      <div style="flex:1; padding:18px;">
        <h3>Ù†Ù…ÙˆØ°Ø¬ Ø¥Ø¶Ø§ÙØ© Ø¹Ù‚Ø§Ø±</h3>
        <p class="small-hint">Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø±ÙØ¹ Ø­ØªÙ‰ 3 ØµÙˆØ± (ÙŠØ¬Ø¨ Ø£Ù† ØªÙƒÙˆÙ† ØµÙˆØ±Ø© Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© Ø£ÙˆÙ„ ØµÙˆØ±Ø©). Ø§Ù„ØµÙˆØ± Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©: ÙˆØ§Ø¬Ù‡Ø© Ø®Ø§Ø±Ø¬ÙŠØ©ØŒ ØµÙˆØ±Ø© Ø¯Ø§Ø®Ù„ÙŠØ©ØŒ ØµÙˆØ±Ø© Ø¹Ø§Ù…Ø©. Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ 3 ØµÙˆØ±.</p>

        <form id="addPropertyForm" class="property-form" onsubmit="onSubmitAdd(event)">
          <div class="form-grid">
            <label>Ø§Ù„ØµÙˆØ± (Ø­ØªÙ‰ 3 ØµÙˆØ±)</label>
            <input type="file" id="imagesInput" accept="image/*" multiple />
            <div class="images-preview" id="imagesPreview"></div>

            <label>Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø¹Ø±Ø¶</label>
            <input id="inputTitle" class="input" placeholder="Ù…Ø«Ø§Ù„: Ø¹Ù…Ø§Ø±Ø© Ø¯ÙˆØ±ÙŠÙ† - Ø¹Ù„Ù‰ Ø´Ø§Ø±Ø¹ Ø±Ø¦ÙŠØ³ÙŠ" required />

            <label>Ø§Ù„Ù‚Ø³Ù…</label>
            <select id="inputCategory" class="input" required>
              <option value="ÙÙ„Ù„">ÙÙ„Ù„</option>
              <option value="Ø´Ù‚Ù‚">Ø´Ù‚Ù‚</option>
              <option value="Ø¹Ù…Ø§Ø¦Ø±">Ø¹Ù…Ø§Ø¦Ø±</option>
              <option value="Ø£Ø±Ø§Ø¶ÙŠ">Ø£Ø±Ø§Ø¶ÙŠ</option>
              <option value="Ø§Ø³ØªØ±Ø§Ø­Ø§Øª">Ø§Ø³ØªØ±Ø§Ø­Ø§Øª</option>
              <option value="Ø£Ø¯ÙˆØ§Ø± Ù…Ø³ØªÙ‚Ù„Ø©">Ø£Ø¯ÙˆØ§Ø± Ù…Ø³ØªÙ‚Ù„Ø©</option>
            </select>

            <label>Ø§Ù„Ø³Ø¹Ø± (Ø¨Ø§Ù„Ø£Ø±Ù‚Ø§Ù… Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ© ÙÙ‚Ø·)</label>
            <input id="inputPrice" class="input" placeholder="Ù…Ø«Ø§Ù„: 1500000" inputmode="numeric" pattern="[0-9]*" required />

            <label>Ø§Ù„Ù…Ø³Ø§Ø­Ø© (Ù…Â²)</label>
            <input id="inputArea" class="input" placeholder="Ù…Ø«Ø§Ù„: 450" inputmode="numeric" pattern="[0-9]*" required />

            <label>Ø§Ù„Ù…ÙˆÙ‚Ø¹ (Ù†ØµÙŠÙ‹Ø§)</label>
            <input id="inputLocation" class="input" placeholder="Ù…Ø«Ø§Ù„: Ø§Ù„Ø­ÙˆÙŠØ©ØŒ Ø§Ù„Ø±ÙŠØ§Ø¶ - Ù‚Ø±ÙŠØ¨ Ø¬Ø§Ù…Ø¹ Ø§Ù„Ø³Ù…Ø§Ø­" required />

            <label>Ø±Ù‚Ù… Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨ Ù„Ù„Ù…Ø§Ù„Ùƒ (Ø³ÙŠØ¸Ù‡Ø± Ù„Ù„Ù…Ø¯ÙŠØ± ÙÙ‚Ø·)</label>
            <input id="inputOwnerPhone" class="input" placeholder="Ù…Ø«Ø§Ù„: 0551234567" required />

            <label>Ù‡Ù„ Ø§Ù„Ø¹Ù‚Ø§Ø± Ø¨ØµÙƒØŸ</label>
            <select id="inputDeed" class="input">
              <option value="Ù„Ø§">Ù„Ø§</option>
              <option value="Ù†Ø¹Ù…">Ù†Ø¹Ù…</option>
            </select>

            <div id="bankWrapper" style="display:none;">
              <label>Ù‡Ù„ ÙŠÙ‚Ø¨Ù„ Ø§Ù„Ø¨Ù†ÙƒØŸ</label>
              <select id="inputBank" class="input">
                <option value="Ù„Ø§">Ù„Ø§</option>
                <option value="Ù†Ø¹Ù…">Ù†Ø¹Ù…</option>
              </select>
            </div>

            <label>ÙˆØµÙ ÙƒØ§Ù…Ù„ Ù„Ù„Ø¹Ù‚Ø§Ø±</label>
            <textarea id="inputDesc" placeholder="Ø§ÙƒØªØ¨ ÙˆØµÙÙ‹Ø§ ÙƒØ§Ù…Ù„Ø§Ù‹ ÙˆÙ…ÙØµÙ„Ø§Ù‹ Ù„Ù„Ø¹Ù‚Ø§Ø± - Ø§Ù„Ø­Ø§Ù„Ø©ØŒ Ø§Ù„Ù…Ø±Ø§ÙÙ‚ØŒ Ø§Ù„Ù‚Ø±Ø¨ Ù…Ù† Ø§Ù„Ø®Ø¯Ù…Ø§Øª..."></textarea>

            <div style="display:flex; gap:10px; align-items:center;">
              <button type="submit" class="btn btn-primary">Ù†Ø´Ø± Ù„Ù„Ø¥Ø¯Ø§Ø±Ø© (ÙŠÙ†ØªØ¸Ø± Ù…ÙˆØ§ÙÙ‚Ø©)</button>
              <button type="button" class="btn btn-ghost" onclick="closeAdd()">Ø¥Ù„ØºØ§Ø¡</button>
            </div>
          </div>
        </form>

      </div>
      <div style="width:360px; padding:18px; background:linear-gradient(180deg,#f7fafc,#ffffff);">
        <h4 style="margin-top:0">Ù†ØµØ§Ø¦Ø­ Ù„ØªØ­Ø³ÙŠÙ† Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†</h4>
        <ul style="color:#556; line-height:1.6;">
          <li>Ø¶Ø¹ ØµÙˆØ±Ø© Ù„Ù„ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ø®Ø§Ø±Ø¬ÙŠØ© Ø£ÙˆÙ„Ø§Ù‹.</li>
          <li>Ø§Ø®ØªØ± Ø£ÙØ¶Ù„ 3 ØµÙˆØ± ØªÙ…Ø«Ù„ Ø§Ù„Ø¹Ù‚Ø§Ø±.</li>
          <li>Ø§ÙƒØªØ¨ Ø§Ù„Ø³Ø¹Ø± Ø¨Ø§Ù„Ø£Ø±Ù‚Ø§Ù… Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ© Ø¨Ø¯ÙˆÙ† ÙÙˆØ§ØµÙ„.</li>
          <li>Ø£ÙƒØªØ¨ Ù…ÙˆÙ‚Ø¹Ù‹Ø§ ÙˆØ§Ø¶Ø­Ù‹Ø§ Ù„ÙŠØ³Ù‡Ù„ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø´ØªØ±ÙŠÙ† Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„ÙŠÙ‡.</li>
          <li>Ø§Ø³ØªØ®Ø¯Ù… ÙˆØµÙÙ‹Ø§ ÙˆØ§Ø¶Ø­Ù‹Ø§ ÙˆÙ…ÙØµÙ„Ù‹Ø§ Ù„Ø²ÙŠØ§Ø¯Ø© ÙØ±Øµ Ø§Ù„Ø¨ÙŠØ¹.</li>
        </ul>
      </div>
    </div>
  </div>

  <!-- LOGIN Modal -->
  <div id="loginModal" class="modal" aria-hidden="true" aria-label="Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…Ø¯ÙŠØ±">
    <div class="detail" role="dialog" style="max-width:420px;">
      <div style="flex:1; padding:18px;">
        <h3>ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…Ø¯ÙŠØ±</h3>
        <p class="small-hint">Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙˆÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ÙƒÙ„Ø§Ù‡Ù…Ø§: <strong>IVL511</strong></p>
        <label>Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</label>
        <input id="loginUser" class="input" />
        <label>ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label>
        <input id="loginPass" type="password" class="input" />
        <div style="display:flex; gap:8px; margin-top:12px;">
          <button class="btn btn-primary" onclick="doLogin()">Ø¯Ø®ÙˆÙ„</button>
          <button class="btn btn-ghost" onclick="closeLogin()">Ø¥Ù„ØºØ§Ø¡</button>
        </div>
        <div id="loginError" style="color:#b33; margin-top:8px; display:none;"></div>
      </div>
    </div>
  </div>

  <!-- EDIT Modal (for admin editing) -->
  <div id="editModal" class="modal" aria-hidden="true" aria-label="ØªØ¹Ø¯ÙŠÙ„ Ø¥Ø¹Ù„Ø§Ù†">
    <div class="detail" role="dialog" style="max-width:820px;">
      <div style="flex:1; padding:18px;">
        <h3>ØªØ¹Ø¯ÙŠÙ„ Ø¥Ø¹Ù„Ø§Ù†</h3>
        <form id="editForm" onsubmit="onSubmitEdit(event)">
          <input type="hidden" id="editId" />
          <label>Ø§Ù„Ø¹Ù†ÙˆØ§Ù†</label><input id="editTitle" class="input" required />
          <label>Ø§Ù„Ù‚Ø³Ù…</label>
          <select id="editCategory" class="input">
            <option>ÙÙ„Ù„</option><option>Ø´Ù‚Ù‚</option><option>Ø¹Ù…Ø§Ø¦Ø±</option><option>Ø£Ø±Ø§Ø¶ÙŠ</option><option>Ø§Ø³ØªØ±Ø§Ø­Ø§Øª</option><option>Ø£Ø¯ÙˆØ§Ø± Ù…Ø³ØªÙ‚Ù„Ø©</option>
          </select>
          <label>Ø§Ù„Ø³Ø¹Ø±</label><input id="editPrice" class="input" required />
          <label>Ø§Ù„Ù…Ø³Ø§Ø­Ø©</label><input id="editArea" class="input" required />
          <label>Ø§Ù„Ù…ÙˆÙ‚Ø¹</label><input id="editLocation" class="input" required />
          <label>Ø±Ù‚Ù… Ø§Ù„Ù…Ø§Ù„Ùƒ (Ù„Ù† ÙŠØ¸Ù‡Ø± Ù„Ù„Ø¹Ø§Ù…Ø©)</label><input id="editOwnerPhone" class="input" />
          <label>Ø§Ù„ØµÙƒ</label>
          <select id="editDeed" class="input"><option>Ù†Ø¹Ù…</option><option>Ù„Ø§</option></select>
          <div id="editBankWrapper" style="display:none;"><label>Ù‚Ø¨ÙˆÙ„ Ø§Ù„Ø¨Ù†Ùƒ</label><select id="editBank" class="input"><option>Ù†Ø¹Ù…</option><option>Ù„Ø§</option></select></div>
          <label>Ø§Ù„ÙˆØµÙ</label><textarea id="editDesc" class="input"></textarea>

          <div style="display:flex; gap:8px; margin-top:10px;">
            <button class="btn btn-primary" type="submit">Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª</button>
            <button class="btn btn-ghost" type="button" onclick="closeEdit()">Ø¥Ù„ØºØ§Ø¡</button>
          </div>
        </form>
      </div>
    </div>
  </div>

<script>
/* ======================================================================================
   Data model & localStorage keys
   ====================================================================================== */
const STORAGE_KEY = 'alqaria_properties_v1';
const NEXT_ID_KEY = 'alqaria_nextid_v1';
const ADMIN_USERNAME = 'IVL511';
const ADMIN_PASSWORD = 'IVL511';
const ADMIN_WHATSAPP = '966535342404'; // Ø±Ù‚Ù… Ø§Ù„Ù…Ø¯ÙŠØ± Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙÙŠ Ø±ÙˆØ§Ø¨Ø· Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨

// load or initialize
let properties = JSON.parse(localStorage.getItem(STORAGE_KEY) || 'null') || [];
let nextId = parseInt(localStorage.getItem(NEXT_ID_KEY) || '1', 10);

// Helper: persist
function persist() {
  localStorage.setItem(STORAGE_KEY, JSON.stringify(properties));
  localStorage.setItem(NEXT_ID_KEY, String(nextId));
}

/* ======================================================================================
   Utilities
   ====================================================================================== */
function $(id){ return document.getElementById(id); }
function el(tag, attrs={}, ...children) {
  const e = document.createElement(tag);
  for (let k in attrs) {
    if (k === 'class') e.className = attrs[k];
    else if (k === 'text') e.textContent = attrs[k];
    else e.setAttribute(k, attrs[k]);
  }
  children.forEach(c=> { if (typeof c === 'string') e.appendChild(document.createTextNode(c)); else if (c) e.appendChild(c); });
  return e;
}
function formatNumber(n) {
  return Number(n).toLocaleString('en-US');
}

/* ======================================================================================
   Sample data seeding (10+ properties across categories)
   ====================================================================================== */
function seedSampleData() {
  if (properties.length > 0) return; // don't override existing
  const samples = [
    {
      title: "ÙÙŠÙ„Ø§ ÙØ§Ø®Ø±Ø© 5 ØºØ±Ù - Ø­ÙŠ Ø§Ù„Ù†Ø®ÙŠÙ„",
      category: "ÙÙ„Ù„",
      price: 2500000,
      area: 450,
      location: "Ø§Ù„Ø±ÙŠØ§Ø¶ - Ø­ÙŠ Ø§Ù„Ù†Ø®ÙŠÙ„",
      ownerPhone: "0551234001",
      deed: "Ù†Ø¹Ù…",
      bank: "Ù†Ø¹Ù…",
      desc: "ÙÙŠÙ„Ø§ ÙØ§Ø®Ø±Ø© Ù…Ø¤Ø«Ø«Ø©ØŒ Ù…Ø³Ø¨Ø­ØŒ Ø­Ø¯ÙŠÙ‚Ø© ÙƒØ¨ÙŠØ±Ø©ØŒ Ø¨Ø§Ù„Ù‚Ø±Ø¨ Ù…Ù† Ø§Ù„Ø®Ø¯Ù…Ø§Øª.",
      images: [
        "https://images.unsplash.com/photo-1600585154340-be6161a56a0c?q=80&w=1400&auto=format&fit=crop",
        "https://images.unsplash.com/photo-1568605114967-8130f3a36994?q=80&w=1400&auto=format&fit=crop",
        "https://images.unsplash.com/photo-1570129477492-45c003edd2be?q=80&w=1400&auto=format&fit=crop"
      ],
      status: "approved",
      ownerType: "owner",
      createdAt: Date.now()
    },
    {
      title: "Ø´Ù‚Ø© Ø±Ø§Ù‚ÙŠØ© 3 ØºØ±Ù - Ø¨Ø±Ø¬ Ø§Ù„ÙØ¬Ø±",
      category: "Ø´Ù‚Ù‚",
      price: 750000,
      area: 150,
      location: "Ø¬Ø¯Ø© - Ø­ÙŠ Ø§Ù„Ø¨Ù„Ø¯",
      ownerPhone: "0551234002",
      deed: "Ù†Ø¹Ù…",
      bank: "Ù†Ø¹Ù…",
      desc: "Ø´Ù‚Ø© Ø­Ø¯ÙŠØ«Ø© Ø¶Ù…Ù† Ù…Ø¬Ù…Ø¹ØŒ Ù…ØµØ¹Ø¯ØŒ Ù…ÙˆÙ‚Ù Ø®Ø§Øµ.",
      images: [
        "https://images.unsplash.com/photo-1560448204-e02f11c3d0e2?q=80&w=1400&auto=format&fit=crop",
        "https://images.unsplash.com/photo-1560449753-74f0c2b1f16a?q=80&w=1400&auto=format&fit=crop",
        "https://images.unsplash.com/photo-1600585154340-be6161a56a0c?q=80&w=1400&auto=format&fit=crop"
      ],
      status: "approved",
      ownerType: "owner",
      createdAt: Date.now()
    },
    {
      title: "Ø¹Ù…Ø§Ø±Ø© Ø³ÙƒÙ†ÙŠØ© 6 Ø´Ù‚Ù‚ - Ù…ÙˆÙ‚Ø¹ Ù…Ù…ÙŠØ²",
      category: "Ø¹Ù…Ø§Ø¦Ø±",
      price: 3200000,
      area: 600,
      location: "Ù…ÙƒØ© - Ø´Ø§Ø±Ø¹ Ø§Ù„Ø­Ø¬Ø§Ø²",
      ownerPhone: "0551234003",
      deed: "Ù†Ø¹Ù…",
      bank: "Ù†Ø¹Ù…",
      desc: "Ø¹Ù…Ø§Ø±Ø© Ø¬Ø¯ÙŠØ¯Ø© Ù…Ø¤Ø¬Ø±Ø©ØŒ Ø¹Ø§Ø¦Ø¯ Ø§Ø³ØªØ«Ù…Ø§Ø±ÙŠ Ù…Ù…ØªØ§Ø².",
      images: [
        "https://images.unsplash.com/photo-1549187774-b4e9b0445b6b?q=80&w=1400&auto=format&fit=crop",
        "https://images.unsplash.com/photo-1542314831-068cd1dbfeeb?q=80&w=1400&auto=format&fit=crop",
        "https://images.unsplash.com/photo-1572120360610-d971b9b3f5a3?q=80&w=1400&auto=format&fit=crop"
      ],
      status: "approved",
      ownerType: "owner",
      createdAt: Date.now()
    },
    {
      title: "Ø£Ø±Ø¶ Ø§Ø³ØªØ«Ù…Ø§Ø±ÙŠØ© Ù‚Ø±Ø¨ Ø§Ù„Ø·Ø±ÙŠÙ‚ Ø§Ù„Ø³Ø±ÙŠØ¹",
      category: "Ø£Ø±Ø§Ø¶ÙŠ",
      price: 5000000,
      area: 1800,
      location: "Ø¬Ø¯Ø© - Ø§Ù„ØµÙ†Ø§Ø¹ÙŠØ©",
      ownerPhone: "0551234004",
      deed: "Ù†Ø¹Ù…",
      bank: "Ù†Ø¹Ù…",
      desc: "Ø£Ø±Ø¶ ØªØ¬Ø§Ø±ÙŠØ© Ø¨Ù…ÙˆÙ‚Ø¹ Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØŒ Ù…Ù†Ø§Ø³Ø¨Ø© Ù„Ù…Ø´Ø±ÙˆØ¹ ØªØ¬Ø§Ø±ÙŠ.",
      images: [
        "https://images.unsplash.com/photo-1502672260266-1c1ef2d93688?q=80&w=1400&auto=format&fit=crop",
        "https://images.unsplash.com/photo-1470123808288-8a75b7f9d4b0?q=80&w=1400&auto=format&fit=crop",
        "https://images.unsplash.com/photo-1527689368864-3a821dbccc34?q=80&w=1400&auto=format&fit=crop"
      ],
      status: "approved",
      ownerType: "owner",
      createdAt: Date.now()
    },
    {
      title: "Ø§Ø³ØªØ±Ø§Ø­Ø© ÙØ§Ø®Ø±Ø© Ù…Ø¹ Ù…Ø³Ø¨Ø­",
      category: "Ø§Ø³ØªØ±Ø§Ø­Ø§Øª",
      price: 950000,
      area: 650,
      location: "Ø§Ù„Ø·Ø§Ø¦Ù - Ø§Ù„Ø®Ù…Ø±Ø©",
      ownerPhone: "0551234005",
      deed: "Ù†Ø¹Ù…",
      bank: "Ù„Ø§",
      desc: "Ø§Ø³ØªØ±Ø§Ø­Ø© Ù…Ø¬Ù‡Ø²Ø© Ù„Ù‚Ø¶Ø§Ø¡ Ø§Ù„Ø¹Ø·Ù„ Ù…Ø¹ Ø¹Ø§Ø¦Ù„ØªÙƒØŒ Ù…Ø³Ø§Ø­Ø© ÙˆØ§Ø³Ø¹Ø©.",
      images: [
        "https://images.unsplash.com/photo-1505691723518-36a3b7b1a5c5?q=80&w=1400&auto=format&fit=crop",
        "https://images.unsplash.com/photo-1523217582562-09d0def993a6?q=80&w=1400&auto=format&fit=crop",
        "https://images.unsplash.com/photo-1496417263034-38ec4f0b665a?q=80&w=1400&auto=format&fit=crop"
      ],
      status: "approved",
      ownerType: "owner",
      createdAt: Date.now()
    },
    {
      title: "Ø¯ÙˆØ± Ù…Ø³ØªÙ‚Ù„ ÙˆØ§Ø³Ø¹ Ù„Ù„Ø¹Ø§Ø¦Ù„Ø§Øª",
      category: "Ø£Ø¯ÙˆØ§Ø± Ù…Ø³ØªÙ‚Ù„Ø©",
      price: 600000,
      area: 300,
      location: "Ø§Ù„Ø¯Ù…Ø§Ù… - Ø§Ù„Ø´Ø§Ø·Ø¦",
      ownerPhone: "0551234006",
      deed: "Ù†Ø¹Ù…",
      bank: "Ù†Ø¹Ù…",
      desc: "Ø¯ÙˆØ± Ù…Ø³ØªÙ‚Ù„ Ù…Ø¹ Ø­ÙˆØ´ ÙˆÙ…ÙˆÙ‚Ø¹ Ù‚Ø±ÙŠØ¨ Ù…Ù† Ø§Ù„Ø®Ø¯Ù…Ø§Øª.",
      images: [
        "https://images.unsplash.com/photo-1475855581690-80acc9d18e0a?q=80&w=1400&auto=format&fit=crop",
        "https://images.unsplash.com/photo-1499951360447-b19be8fe80f5?q=80&w=1400&auto=format&fit=crop",
        "https://images.unsplash.com/photo-1505692794409-7bd2f3c6f3e6?q=80&w=1400&auto=format&fit=crop"
      ],
      status: "approved",
      ownerType: "owner",
      createdAt: Date.now()
    },
    // Pending sample entries
    {
      title: "Ø´Ù‚Ø© Ù„Ù„Ø¥ÙŠØ¬Ø§Ø± Ø¨Ø¹Ø¯ Ø§Ù„ØªØ¬Ø¯ÙŠØ¯",
      category: "Ø´Ù‚Ù‚",
      price: 320000,
      area: 95,
      location: "ØªØ¨ÙˆÙƒ - Ø§Ù„Ø³ÙˆÙŠÙ‚Ø©",
      ownerPhone: "0551234007",
      deed: "Ù„Ø§",
      bank: "Ù„Ø§",
      desc: "Ø´Ù‚Ø© Ø¨Ø¹Ø¯ Ø§Ù„ØªØ¬Ø¯ÙŠØ¯ØŒ Ø¬Ø§Ù‡Ø²Ø© Ù„Ù„Ø³ÙƒÙ†ØŒ Ù…ÙˆÙ‚Ù ÙˆÙ…ØµØ¹Ø¯.",
      images: [
        "https://images.unsplash.com/photo-1560449753-74f0c2b1f16a?q=80&w=1400&auto=format&fit=crop",
        "https://images.unsplash.com/photo-1560448204-e02f11c3d0e2?q=80&w=1400&auto=format&fit=crop",
        "https://images.unsplash.com/photo-1523217582562-09d0def993a6?q=80&w=1400&auto=format&fit=crop"
      ],
      status: "pending",
      ownerType: "owner",
      createdAt: Date.now()
    },
    {
      title: "Ø¹Ù…Ø§Ø±Ø© Ù„Ù„ØªØ±Ù…ÙŠÙ… - ÙØ±ØµØ© Ø§Ø³ØªØ«Ù…Ø§Ø±ÙŠØ©",
      category: "Ø¹Ù…Ø§Ø¦Ø±",
      price: 1450000,
      area: 520,
      location: "Ø§Ù„Ù…Ø¯ÙŠÙ†Ø© - Ø§Ù„ØµÙ†Ø§Ø¹ÙŠØ©",
      ownerPhone: "0551234008",
      deed: "Ù†Ø¹Ù…",
      bank: "Ù„Ø§",
      desc: "Ø¹Ù…Ø§Ø±Ø© ØªØ­ØªØ§Ø¬ ØªØ±Ù…ÙŠÙ…Ø§Øª Ø¨Ø³ÙŠØ·Ø©ØŒ Ø³Ø¹Ø± Ù…Ù†Ø§Ø³Ø¨ Ù„Ù„Ø§Ø³ØªØ«Ù…Ø§Ø±.",
      images: [
        "https://images.unsplash.com/photo-1549187774-b4e9b0445b6b?q=80&w=1400&auto=format&fit=crop",
        "https://images.unsplash.com/photo-1600585154340-be6161a56a0c?q=80&w=1400&auto=format&fit=crop",
        "https://images.unsplash.com/photo-1572120360610-d971b9b3f5a3?q=80&w=1400&auto=format&fit=crop"
      ],
      status: "pending",
      ownerType: "owner",
      createdAt: Date.now()
    }
  ];

  samples.forEach(s => {
    s.id = nextId++;
    properties.push(s);
  });
  persist();
}
seedSampleData();

/* ======================================================================================
   Render functions: grid, pending table, manager table, counts
   ====================================================================================== */

function renderCounts() {
  const approved = properties.filter(p => p.status === 'approved').length;
  const pending = properties.filter(p => p.status === 'pending').length;
  $('cntVal').textContent = approved;
  $('approvedCount').textContent = approved;
  $('pendingCount').textContent = pending;
  $('totalCount').textContent = properties.length;
}

function createCardHTML(prop) {
  // Build element
  const card = el('article', { class: 'card', 'data-id': prop.id });
  const media = el('div', { class: 'card-media' });
  const img = el('img'); img.src = (prop.images && prop.images.length) ? prop.images[0] : '';
  media.appendChild(img);

  const badge = el('div', { class: 'badge' }, prop.category);
  media.appendChild(badge);

  const body = el('div', { class: 'card-body' });
  const title = el('h4', { class: 'card-title' }, prop.title);
  const loc = el('div', { class: 'card-loc' }, prop.location);
  const meta = el('div', { class: 'card-meta' });
  const price = el('div', { class: 'price' }, formatNumber(prop.price) + ' Ø±.Ø³');
  const small = el('div', { class: 'meta-small' }, prop.area + ' Ù…Â²');

  meta.appendChild(price); meta.appendChild(small);

  const actions = el('div', { class: 'card-actions' });
  const btnView = el('button', { class: 'btn-small btn-ghost' }, 'Ø¹Ø±Ø¶ Ø§Ù„Ø¹Ù‚Ø§Ø±');
  btnView.onclick = ()=> openDetail(prop.id);
  const btnWhats = el('a', { class: 'btn-small btn-ws', href:'#', target:'_blank' }, 'ÙˆØ§ØªØ³Ø§Ø¨');
  // WhatsApp should open chat with admin and include property id/title
  btnWhats.onclick = (e)=> {
    e.preventDefault();
    const text = `Ù…Ø±Ø­Ø¨Ù‹Ø§ØŒ Ø£Ø¹Ø¬Ø¨Ù†ÙŠ Ø§Ù„Ø¹Ù‚Ø§Ø±: ${prop.title} (Ø±Ù‚Ù… ${prop.id})\nØ£ÙˆØ¯ Ù…Ø¹Ø±ÙØ© Ø§Ù„Ù…Ø²ÙŠØ¯.`;
    window.open(`https://wa.me/${ADMIN_WHATSAPP}?text=${encodeURIComponent(text)}`, '_blank');
  };

  actions.appendChild(btnView);
  actions.appendChild(btnWhats);

  body.appendChild(title);
  body.appendChild(loc);
  body.appendChild(meta);
  body.appendChild(actions);

  card.appendChild(media);
  card.appendChild(body);

  return card;
}

function renderGrid(filter = 'all', query = '', sortBy='recent') {
  const grid = $('propertiesGrid');
  grid.innerHTML = '';
  let list = properties.filter(p => p.status === 'approved');

  if (filter !== 'all') list = list.filter(p => p.category === filter);

  if (query && query.trim() !== '') {
    const q = query.trim().toLowerCase();
    list = list.filter(p => (
      (p.title||'').toLowerCase().includes(q) ||
      (p.location||'').toLowerCase().includes(q) ||
      (String(p.price)||'').toLowerCase().includes(q) ||
      (p.desc||'').toLowerCase().includes(q)
    ));
  }

  if (sortBy === 'price-asc') list.sort((a,b)=>a.price-b.price);
  else if (sortBy === 'price-desc') list.sort((a,b)=>b.price-a.price);
  else list.sort((a,b)=>b.createdAt - a.createdAt);

  $('propertiesCount').style.display = 'block';
  $('cntVal').textContent = list.length;

  if (list.length === 0) {
    grid.appendChild(el('div', { style: 'padding:20px;color:#556' }, 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¹Ù‚Ø§Ø±Ø§Øª Ø­Ø§Ù„ÙŠØ§Ù‹ ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„Ù‚Ø³Ù….'));
    return;
  }

  list.forEach(p => {
    grid.appendChild(createCardHTML(p));
  });
}

/* ======================================================================================
   Detail view
   ====================================================================================== */
function openDetail(id) {
  const prop = properties.find(x => x.id == id);
  if (!prop) return;
  // fill modal
  $('detailTitle').textContent = prop.title;
  $('detailLocation').textContent = prop.location;
  $('detailPrice').textContent = formatNumber(prop.price);
  $('detailArea').textContent = prop.area || '-';
  $('detailDesc').textContent = prop.desc || '';
  $('detailDeed').textContent = `Ø§Ù„ØµÙƒ: ${prop.deed || 'Ù„Ø§'} â€” Ù‚Ø¨ÙˆÙ„ Ø§Ù„Ø¨Ù†Ùƒ: ${prop.bank || 'Ù„Ø§'}`;
  $('detailStatus').textContent = prop.status === 'approved' ? 'Ù…ÙØ¹Ù„' : 'Ø¨Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø©';
  // images
  const mainImg = $('detailMainImgImg');
  const thumbs = $('detailThumbs');
  thumbs.innerHTML = '';
  const imgs = (prop.images && prop.images.length) ? prop.images : [placeholderImage()];
  mainImg.src = imgs[0];
  imgs.forEach((src,i)=>{
    const t = document.createElement('img');
    t.src = src;
    if (i===0) t.classList.add('active');
    t.onclick = ()=> {
      mainImg.src = src;
      thumbs.querySelectorAll('img').forEach(imgEl=>imgEl.classList.remove('active'));
      t.classList.add('active');
    };
    thumbs.appendChild(t);
  });
  // whatsapp link to admin
  const text = `Ù…Ø±Ø­Ø¨Ù‹Ø§ØŒ Ø£Ø¹Ø¬Ø¨Ù†ÙŠ Ø§Ù„Ø¹Ù‚Ø§Ø±: ${prop.title} (Ø±Ù‚Ù… ${prop.id})\nØ§Ù„Ù…ÙˆÙ‚Ø¹: ${prop.location}\nØ§Ù„Ø³Ø¹Ø±: ${formatNumber(prop.price)} Ø±.Ø³`;
  $('whatsappBtn').href = `https://wa.me/${ADMIN_WHATSAPP}?text=${encodeURIComponent(text)}`;
  // show modal
  const modal = $('detailModal');
  modal.classList.add('show');
  modal.setAttribute('aria-hidden','false');
}

/* close detail modal */
function closeDetail() {
  const modal = $('detailModal');
  modal.classList.remove('show');
  modal.setAttribute('aria-hidden','true');
}

/* ======================================================================================
   Add property: UI handlers
   ====================================================================================== */

function openAdd() {
  $('addModal').classList.add('show');
  $('addModal').setAttribute('aria-hidden','false');
  window.scrollTo({ top:0, behavior:'smooth' });
}
function closeAdd() {
  $('addModal').classList.remove('show');
  $('addModal').setAttribute('aria-hidden','true');
  // reset form
  $('addPropertyForm').reset();
  $('imagesPreview').innerHTML = '';
  selectedImages = [];
}
$('btnShowAdd').addEventListener('click', openAdd);

/* images preview handling */
let selectedImages = []; // store dataURLs
$('imagesInput').addEventListener('change', function(e){
  const files = Array.from(e.target.files).slice(0,3); // limit to 3
  selectedImages = [];
  $('imagesPreview').innerHTML = '';
  if (!files.length) return;
  files.forEach((file, idx)=>{
    const reader = new FileReader();
    reader.onload = function(ev){
      selectedImages.push(ev.target.result);
      const slot = el('div', { class: 'img-slot' });
      const img = el('img'); img.src = ev.target.result;
      slot.appendChild(img);
      $('imagesPreview').appendChild(slot);
    };
    reader.readAsDataURL(file);
  });
});

/* show/hide bank field depending on deed */
$('inputDeed').addEventListener('change', function(){ 
  $('bankWrapper').style.display = (this.value === 'Ù†Ø¹Ù…') ? 'block' : 'none';
});

/* submission: add property (status='pending') */
function onSubmitAdd(e) {
  e.preventDefault();
  // validation
  if (selectedImages.length < 1) {
    alert('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø±ÙØ¹ ØµÙˆØ±Ø© ÙˆØ§Ø­Ø¯Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„ (ÙŠÙØ¶Ù„ Ø£Ù† ØªÙƒÙˆÙ† ØµÙˆØ±Ø© Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© Ø£ÙˆÙ„Ø§Ù‹).');
    return;
  }
  if (selectedImages.length > 3) {
    alert('Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ Ù„Ù„ØµÙˆØ± Ù‡Ùˆ 3 ØµÙˆØ±.');
    return;
  }
  const title = $('inputTitle').value.trim();
  const category = $('inputCategory').value;
  const price = Number($('inputPrice').value);
  const area = Number($('inputArea').value);
  const location = $('inputLocation').value.trim();
  const ownerPhone = $('inputOwnerPhone').value.trim();
  const deed = $('inputDeed').value;
  const bank = $('inputBank').value || 'Ù„Ø§';
  const desc = $('inputDesc').value.trim();

  if (!title || !category || !price || !location || !ownerPhone) {
    alert('Ø§Ù„Ø±Ø¬Ø§Ø¡ ØªØ¹Ø¨Ø¦Ø© Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­.');
    return;
  }

  // create object
  const prop = {
    id: nextId++,
    title,
    category,
    price,
    area,
    location,
    ownerPhone,
    deed,
    bank,
    desc,
    images: selectedImages.slice(0,3),
    status: 'pending',
    ownerType: 'owner',
    createdAt: Date.now()
  };
  properties.push(prop);
  persist();

  // reset & close & show message
  closeAdd();
  alert('ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø¹Ù‚Ø§Ø±Ùƒ Ø¥Ù„Ù‰ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ù„Ù…Ø±Ø§Ø¬Ø¹ØªÙ‡ ÙˆØ§Ù„Ù…ÙˆØ§ÙÙ‚Ø© Ø¹Ù„ÙŠÙ‡. Ø³ØªØªÙ„Ù‚Ù‰ Ø¥Ø´Ø¹Ø§Ø±Ù‹Ø§ Ø¹Ù†Ø¯ Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø©.');
  renderAll();
}

/* ======================================================================================
   Login & Admin actions
   ====================================================================================== */

$('btnLogin').addEventListener('click', ()=> {
  $('loginModal').classList.add('show');
  $('loginModal').setAttribute('aria-hidden','false');
});
function closeLogin() {
  $('loginModal').classList.remove('show');
  $('loginModal').setAttribute('aria-hidden','true');
  $('loginError').style.display = 'none';
}
function doLogin() {
  const u = $('loginUser').value.trim();
  const p = $('loginPass').value.trim();
  if (u === ADMIN_USERNAME && p === ADMIN_PASSWORD) {
    closeLogin();
    // reveal admin section
    $('adminSection').style.display = 'block';
    $('btnLogin').style.display = 'none';
    $('btnShowAdd').style.display = 'inline-block';
    $('btnSiteEdit').style.display = 'inline-block';
    // persist admin session in sessionStorage
    sessionStorage.setItem('alq_admin_logged', 'true');
    renderAdminTables();
    alert('ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ ÙƒÙ…Ø¯ÙŠØ±.');
  } else {
    $('loginError').textContent = 'Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„ ØºÙŠØ± ØµØ­ÙŠØ­Ø©';
    $('loginError').style.display = 'block';
  }
}
function logoutAdmin() {
  sessionStorage.removeItem('alq_admin_logged');
  $('adminSection').style.display = 'none';
  $('btnLogin').style.display = 'inline-block';
  alert('ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬.');
  // hide edit/delete buttons from UI by re-render
  renderAll();
}
$('btnLogout').addEventListener('click', logoutAdmin);

/* adminTable render */
function renderAdminTables(){
  // pending table
  const pendingTbody = document.querySelector('#pendingTable tbody');
  pendingTbody.innerHTML = '';
  const pendings = properties.filter(p => p.status === 'pending');
  pendings.forEach((p, idx) => {
    const tr = el('tr');
    tr.appendChild(el('td', {}, p.id));
    tr.appendChild(el('td', {}, p.title));
    tr.appendChild(el('td', {}, p.category));
    tr.appendChild(el('td', {}, formatNumber(p.price) + ' Ø±.Ø³'));
    tr.appendChild(el('td', {}, p.ownerPhone));
    const actionsTd = el('td');
    const btnApprove = el('button', { class:'btn btn-primary' }, 'Ù…ÙˆØ§ÙÙ‚Ø©');
    btnApprove.onclick = ()=> { approveProperty(p.id); };
    const btnReject = el('button', { class:'btn btn-ghost' }, 'Ø±ÙØ¶');
    btnReject.style.marginLeft = '8px';
    btnReject.onclick = ()=> { if(confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ Ø±ÙØ¶ ÙˆØ­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†ØŸ')) { deletePropertyById(p.id); } };
    const btnView = el('button', { class:'btn btn-ghost' }, 'Ø¹Ø±Ø¶');
    btnView.style.marginLeft = '8px';
    btnView.onclick = ()=> openDetail(p.id);
    const btnEdit = el('button', { class:'btn btn-ghost' }, 'ØªØ¹Ø¯ÙŠÙ„');
    btnEdit.style.marginLeft = '8px';
    btnEdit.onclick = ()=> openEdit(p.id);
    actionsTd.appendChild(btnApprove);
    actionsTd.appendChild(btnReject);
    actionsTd.appendChild(btnEdit);
    actionsTd.appendChild(btnView);
    tr.appendChild(actionsTd);
    pendingTbody.appendChild(tr);
  });

  // manager table (show all but mark status)
  const managerTbody = document.querySelector('#managerTable tbody');
  managerTbody.innerHTML = '';
  properties.forEach(p => {
    const tr = el('tr');
    tr.appendChild(el('td', {}, p.id));
    tr.appendChild(el('td', {}, p.title));
    tr.appendChild(el('td', {}, p.category));
    tr.appendChild(el('td', {}, formatNumber(p.price) + ' Ø±.Ø³'));
    tr.appendChild(el('td', {}, p.status === 'approved' ? 'Ù…ÙØ¹Ù„' : 'Ø¨Ø§Ù†ØªØ¸Ø§Ø±'));
    const actionsTd = el('td');
    const btnToggle = el('button', { class:'btn btn-primary' }, p.status === 'approved' ? 'ØªØ¹Ø·ÙŠÙ„' : 'ØªÙØ¹ÙŠÙ„');
    btnToggle.onclick = ()=> {
      if (p.status === 'approved') {
        if (!confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ ØªØ¹Ø·ÙŠÙ„ Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†ØŸ')) return;
        p.status = 'pending';
      } else {
        p.status = 'approved';
      }
      persist();
      renderAll();
      renderAdminTables();
    };
    const btnEdit = el('button', { class:'btn btn-ghost' }, 'ØªØ¹Ø¯ÙŠÙ„');
    btnEdit.style.marginLeft = '8px';
    btnEdit.onclick = ()=> openEdit(p.id);
    const btnDelete = el('button', { class:'btn btn-ghost' }, 'Ø­Ø°Ù');
    btnDelete.style.marginLeft = '8px';
    btnDelete.onclick = ()=> {
      if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù† Ù†Ù‡Ø§Ø¦ÙŠØ§Ù‹ØŸ')) {
        deletePropertyById(p.id);
      }
    };
    actionsTd.appendChild(btnToggle); actionsTd.appendChild(btnEdit); actionsTd.appendChild(btnDelete);
    tr.appendChild(actionsTd);
    managerTbody.appendChild(tr);
  });

  renderCounts();
}

/* approve property */
function approveProperty(id) {
  const p = properties.find(x=>x.id==id);
  if (!p) return;
  p.status = 'approved';
  persist();
  renderAll();
  renderAdminTables();
  alert('ØªÙ…Øª Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø© ÙˆÙ†Ø´Ø± Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†.');
}

/* delete property */
function deletePropertyById(id) {
  properties = properties.filter(x=>x.id!=id);
  persist();
  renderAll();
  renderAdminTables();
}

/* open edit modal */
function openEdit(id) {
  const p = properties.find(x=>x.id==id);
  if (!p) return;
  $('editId').value = p.id;
  $('editTitle').value = p.title;
  $('editCategory').value = p.category;
  $('editPrice').value = p.price;
  $('editArea').value = p.area;
  $('editLocation').value = p.location;
  $('editOwnerPhone').value = p.ownerPhone;
  $('editDeed').value = p.deed;
  $('editDesc').value = p.desc;
  if (p.deed === 'Ù†Ø¹Ù…') $('editBankWrapper').style.display = 'block'; else $('editBankWrapper').style.display = 'none';
  $('editBank').value = p.bank || 'Ù„Ø§';

  $('editModal').classList.add('show');
  $('editModal').setAttribute('aria-hidden','false');
}
function closeEdit() {
  $('editModal').classList.remove('show');
  $('editModal').setAttribute('aria-hidden','true');
}

/* submit edit */
function onSubmitEdit(e) {
  e.preventDefault();
  const id = Number($('editId').value);
  const p = properties.find(x=>x.id==id);
  if (!p) return;
  p.title = $('editTitle').value.trim();
  p.category = $('editCategory').value;
  p.price = Number($('editPrice').value);
  p.area = Number($('editArea').value);
  p.location = $('editLocation').value.trim();
  p.ownerPhone = $('editOwnerPhone').value.trim();
  p.deed = $('editDeed').value;
  p.bank = $('editBank').value || 'Ù„Ø§';
  p.desc = $('editDesc').value.trim();
  persist();
  closeEdit();
  renderAll();
  renderAdminTables();
  alert('ØªÙ… Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª.');
}

/* ======================================================================================
   Site name edit
   ====================================================================================== */
$('btnSiteEdit').addEventListener('click', ()=> {
  const newName = prompt('Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø¬Ø¯ÙŠØ¯', $('siteNameDisplay').textContent);
  if (newName && newName.trim() !== '') {
    $('siteNameDisplay').textContent = newName.trim();
    $('logoText').textContent = newName.trim().split(' ').map(s=>s[0]).slice(0,3).join('');
  }
});

/* ======================================================================================
   Helpers: render everything, search & filters
   ====================================================================================== */
function renderAll() {
  // determine chosen category pills
  const activePill = document.querySelector('.category-pill.active');
  const cat = activePill ? activePill.getAttribute('data-cat') : 'all';
  const q = $('globalSearch').value || '';
  const sort = $('sortSelect').value || 'recent';
  renderGrid(cat, q, sort);
  renderCounts();
  // admin session? re-render admin tables if logged
  if (sessionStorage.getItem('alq_admin_logged') === 'true') {
    $('adminSection').style.display = 'block';
    $('btnLogin').style.display = 'none';
    renderAdminTables();
  } else {
    $('adminSection').style.display = 'none';
  }
}

/* filter clicks */
document.querySelectorAll('.category-pill').forEach(p=>{
  p.addEventListener('click', function(){
    document.querySelectorAll('.category-pill').forEach(x=>x.classList.remove('active'));
    this.classList.add('active');
    renderAll();
  });
});

/* search handler (debounced) */
let debounceTimer = null;
$('globalSearch').addEventListener('input', function(){
  clearTimeout(debounceTimer);
  debounceTimer = setTimeout(()=> renderAll(), 250);
});
$('sortSelect').addEventListener('change', renderAll);

/* Close modals on overlay click */
document.querySelectorAll('.modal').forEach(mod=>{
  mod.addEventListener('click', function(e){
    if (e.target === this) {
      this.classList.remove('show');
      this.setAttribute('aria-hidden','true');
    }
  });
});

/* close detail modal on ESC */
document.addEventListener('keydown', function(e){
  if (e.key === 'Escape') {
    document.querySelectorAll('.modal.show').forEach(m=>{ m.classList.remove('show'); m.setAttribute('aria-hidden','true'); });
  }
});

/* initial render */
renderAll();

/* For demonstration, expose some functions on window (optional) */
window.openAdd = openAdd;
window.openDetail = openDetail;
window.openEdit = openEdit;
window.approveProperty = approveProperty;
window.deletePropertyById = deletePropertyById;

/* ======================================================================================
   Placeholder image fallback
   ====================================================================================== */
function placeholderImage(){
  return 'data:image/svg+xml;utf8,' + encodeURIComponent(
    `<svg xmlns='http://www.w3.org/2000/svg' width='1400' height='800'><rect width='100%' height='100%' fill='#e9f0f5'/><text x='50%' y='50%' font-size='28' text-anchor='middle' fill='#9bb3c9' font-family='Arial' dy='.3em'>Ù„Ø§ ØªÙˆØ¬Ø¯ ØµÙˆØ±Ø©</text></svg>`
  );
}

/* ======================================================================================
   Extra: ensure admin session persists across reload (if desired)
   ====================================================================================== */
if (sessionStorage.getItem('alq_admin_logged') === 'true') {
  // show admin on load
  $('adminSection').style.display = 'block';
  $('btnLogin').style.display = 'none';
  renderAdminTables();
}

</script>
</body>
</html>
