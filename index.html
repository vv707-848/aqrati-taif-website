<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>إسم الموقع العقاري</title>
<style>
body{margin:0;font-family:Arial,sans-serif;background:#f4f4f4;}
.navbar{background:linear-gradient(to right,#8360c3,#2ebf91);padding:10px 20px;color:white;display:flex;align-items:center;justify-content:space-between;box-shadow:0 2px 4px rgba(0,0,0,0.1);}
.navbar h1{margin:0;font-size:24px;}
.navbar button{background:#ff9a9e;border:none;color:#333;padding:10px 20px;border-radius:20px;cursor:pointer;font-size:16px;transition:background 0.3s;}
.navbar button:hover{background:#ff7e99;}
#landingPage{padding:20px;text-align:center;}
#landingPage h1{font-size:32px;margin-bottom:20px;color:#333;}
#landingPage button{margin:10px;padding:10px 20px;background:#8360c3;color:#fff;border:none;border-radius:20px;cursor:pointer;font-size:18px;transition:transform 0.3s;}
#landingPage button:hover{transform:scale(1.05);}
#loginDiv{background:white;display:inline-block;padding:20px;box-shadow:0 2px 5px rgba(0,0,0,0.1);margin:20px;border-radius:10px;}
#loginDiv h2{margin-top:0;color:#8360c3;}
#loginDiv input{width:200px;padding:8px;margin:5px 0;font-size:16px;border:1px solid #ccc;border-radius:5px;}
#loginDiv button{padding:10px 20px;font-size:16px;background:#2ebf91;color:white;border:none;border-radius:20px;cursor:pointer;transition:background 0.3s;}
#loginDiv button:hover{background:#26a17d;}
#addFormContainer{display:none;background:white;padding:20px;margin:0 auto;width:80%;max-width:500px;box-shadow:0 2px 5px rgba(0,0,0,0.1);border-radius:10px;text-align:right;}
#addFormContainer h2{margin-top:0;color:#8360c3;}
#addFormContainer input,#addFormContainer textarea{width:100%;padding:8px;margin:5px 0 15px 0;font-size:16px;border:1px solid #ccc;border-radius:5px;box-sizing:border-box;}
#addFormContainer label{font-weight:bold;color:#555;}
#addFormContainer input[type="file"]{padding:3px;}
#addFormContainer button{padding:10px 20px;font-size:16px;background:#8360c3;color:white;border:none;border-radius:20px;cursor:pointer;margin-top:10px;transition:background 0.3s;}
#addFormContainer button:hover{background:#684eb9;}
#adminPage{padding:20px;}
h2{color:#8360c3;margin-top:20px;}
table{width:100%;border-collapse:collapse;margin-top:10px;}
table,th,td{border:1px solid #ddd;}
th,td{padding:10px;text-align:right;}
th{background:#8360c3;color:white;}
tr:nth-child(even){background:#f9f9f9;}
tr:hover{background:#f1f1f1;}
.action-btn{background:#2ebf91;border:none;color:white;padding:5px 10px;cursor:pointer;border-radius:5px;margin:0 2px;font-size:14px;transition:background 0.3s;}
.action-btn.delete{background:#d64541;}
.action-btn:hover{opacity:0.9;}
#imgPreview{max-width:100%;margin-top:10px;display:none;}
</style>
</head>
<body>
    <!-- Landing Page -->
    <div id="landingPage">
        <h1 id="siteName">إسم الموقع العقاري</h1>
        <button onclick="toggleAddForm()">إضافة عقار جديد</button>
        <!-- Add Property Form -->
        <div id="addFormContainer">
            <h2>إضافة عقار جديد</h2>
            <label>عنوان العقار:</label>
            <input type="text" id="propTitle" placeholder="عنوان العقار">
            <label>السعر (ريال):</label>
            <input type="number" id="propPrice" placeholder="السعر">
            <label>الموقع:</label>
            <input type="text" id="propLocation" placeholder="الموقع (المدينة، الحي)">
            <label>اسم المالك:</label>
            <input type="text" id="propOwner" placeholder="اسم المالك">
            <label>رقم الجوال (واتساب):</label>
            <input type="text" id="propPhone" placeholder="05XXXXXXXX">
            <label>وصف العقار:</label>
            <textarea id="propDesc" rows="4" placeholder="وصف مختصر"></textarea>
            <label>صورة العقار:</label>
            <input type="file" id="propImage" accept="image/*" onchange="previewImage(event)">
            <img id="imgPreview" alt="معاينة الصورة">
            <button onclick="addProperty()">رفع العقار</button>
        </div>
        <!-- Manager Login -->
        <div id="loginDiv">
            <h2>تسجيل الدخول كمدير</h2>
            <input type="text" id="username" placeholder="اسم المستخدم"><br>
            <input type="password" id="password" placeholder="كلمة المرور"><br>
            <button onclick="login()">دخول</button>
        </div>
    </div>
    <!-- Admin Page -->
    <div id="adminPage" style="display:none;">
        <div class="navbar">
            <h1 id="siteTitle">إسم الموقع العقاري</h1>
            <div>
                <input type="text" id="newNameInput" placeholder="تغيير اسم الموقع">
                <button onclick="updateSiteName()">تغيير</button>
                <button onclick="logout()">تسجيل الخروج</button>
            </div>
        </div>
        <h2>عقارات المدير (المُعتمدة)</h2>
        <table>
            <thead>
                <tr><th>العنوان</th><th>السعر</th><th>الموقع</th><th>تفاصيل المالك</th><th>الصورة</th></tr>
            </thead>
            <tbody id="approvedTableBody"></tbody>
        </table>
        <h2>عقارات الملاك (للموافقة)</h2>
        <table>
            <thead>
                <tr><th>العنوان</th><th>السعر</th><th>الموقع</th><th>تفاصيل المالك</th><th>الصورة</th><th>الموافقة / الرفض</th></tr>
            </thead>
            <tbody id="pendingTableBody"></tbody>
        </table>
    </div>
    <script>
        let pendingProperties = [];
        let approvedProperties = [];

        function toggleAddForm(){
            const f = document.getElementById('addFormContainer');
            f.style.display = (f.style.display == '' || f.style.display == 'none') ? 'block' : 'none';
        }

        function previewImage(event){
            const reader = new FileReader();
            reader.onload = function(){
                const img = document.getElementById('imgPreview');
                img.src = reader.result;
                img.style.display = 'block';
            }
            reader.readAsDataURL(event.target.files[0]);
        }

        function addProperty(){
            const title = document.getElementById('propTitle').value,
                  price = document.getElementById('propPrice').value,
                  loc   = document.getElementById('propLocation').value,
                  owner = document.getElementById('propOwner').value,
                  phone = document.getElementById('propPhone').value,
                  desc  = document.getElementById('propDesc').value;
            let imgSrc = document.getElementById('imgPreview').src;
            if (!title || !price || !loc || !owner || !phone) {
                alert('يرجى تعبئة جميع الحقول المطلوبة.');
                return;
            }
            const p = {
                title: title,
                price: price,
                location: loc,
                owner: owner,
                phone: phone,
                desc: desc,
                image: imgSrc
            };
            pendingProperties.push(p);
            alert('تمت إضافة العقار بنجاح! في انتظار الموافقة.');
            // Reset fields
            document.getElementById('propTitle').value = '';
            document.getElementById('propPrice').value = '';
            document.getElementById('propLocation').value = '';
            document.getElementById('propOwner').value = '';
            document.getElementById('propPhone').value = '';
            document.getElementById('propDesc').value = '';
            document.getElementById('propImage').value = '';
            document.getElementById('imgPreview').style.display = 'none';
            document.getElementById('addFormContainer').style.display = 'none';
            renderPendingProperties();
        }

        function login(){
            const u = document.getElementById('username').value,
                  p = document.getElementById('password').value;
            if (u === 'IVL511' && p === 'IVL511') {
                document.getElementById('landingPage').style.display = 'none';
                document.getElementById('adminPage').style.display = 'block';
                renderApprovedProperties();
                renderPendingProperties();
            } else {
                alert('اسم المستخدم أو كلمة المرور غير صحيحة');
            }
        }

        function logout(){
            document.getElementById('adminPage').style.display = 'none';
            document.getElementById('landingPage').style.display = 'block';
        }

        function updateSiteName(){
            const newName = document.getElementById('newNameInput').value.trim();
            if (!newName) {
                alert('الرجاء إدخال اسم موقع صحيح');
                return;
            }
            document.getElementById('siteName').innerText = newName;
            document.getElementById('siteTitle').innerText = newName;
            document.getElementById('newNameInput').value = '';
        }

        function approveProperty(index){
            const prop = pendingProperties.splice(index, 1)[0];
            approvedProperties.push(prop);
            renderPendingProperties();
            renderApprovedProperties();
        }

        function deleteProperty(index){
            if (!confirm('هل أنت متأكد من رفض وحذف هذا العقار؟')) return;
            pendingProperties.splice(index, 1);
            renderPendingProperties();
        }

        function renderPendingProperties(){
            const table = document.getElementById('pendingTableBody');
            table.innerHTML = '';
            pendingProperties.forEach((prop, i) => {
                const row = document.createElement('tr');
                row.innerHTML = 
                    '<td>' + prop.title + '</td>' +
                    '<td>' + prop.price + ' ريال</td>' +
                    '<td>' + prop.location + '</td>' +
                    '<td>' + prop.owner + ' / ' + prop.phone + '</td>' +
                    '<td>' + (prop.image ? '<img src="' + prop.image + '" width="80">' : '') + '</td>' +
                    '<td><button class="action-btn" onclick="approveProperty(' + i + ')">موافقة</button>' +
                    '<button class="action-btn delete" onclick="deleteProperty(' + i + ')">رفض</button></td>';
                table.appendChild(row);
            });
        }

        function renderApprovedProperties(){
            const table = document.getElementById('approvedTableBody');
            table.innerHTML = '';
            approvedProperties.forEach(prop => {
                const row = document.createElement('tr');
                row.innerHTML = 
                    '<td>' + prop.title + '</td>' +
                    '<td>' + prop.price + ' ريال</td>' +
                    '<td>' + prop.location + '</td>' +
                    '<td>' + prop.owner + ' / ' + prop.phone + '</td>' +
                    '<td>' + (prop.image ? '<img src="' + prop.image + '" width="80">' : '') + '</td>';
                table.appendChild(row);
            });
        }
    </script>
</body>
</html>
