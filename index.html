<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <title>Ø§Ù„Ù†Ø®Ø¨Ø© Ø§Ù„Ø¹Ù‚Ø§Ø±ÙŠØ© â€” Ù…Ù†ØµØ© Ø§Ø­ØªØ±Ø§ÙÙŠØ©</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    /* ========== Reset & Base ========== */
    * { box-sizing: border-box; }
    html,body { height:100%; }
    body {
      margin:0;
      font-family: "Cairo", "Segoe UI", Tahoma, Arial, sans-serif;
      background: linear-gradient(180deg,#f5f7fb 0%, #eef3f8 100%);
      color:#0f2730;
      direction: rtl;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      line-height:1.45;
    }
    a { color:inherit; text-decoration:none; }
    button { cursor:pointer; }

    /* ========== Topbar ========== */
    .topbar {
      position:sticky; top:0; z-index:999;
      display:flex; align-items:center; gap:12px; padding:12px 18px;
      background: linear-gradient(90deg,#0f4c5ccc,#144d4dcc);
      color:#fff; box-shadow: 0 8px 22px rgba(8,24,32,0.14);
    }
    .brand { display:flex; align-items:center; gap:12px; margin-right:auto; }
    .logo {
      width:52px; height:52px; border-radius:12px;
      display:flex; align-items:center; justify-content:center;
      font-weight:900; color:#112;
      background: linear-gradient(135deg,#ffd166,#ef476f);
      box-shadow:0 10px 30px rgba(14,40,50,0.18);
    }
    .site-title { font-weight:900; font-size:1.15rem; }
    .site-sub { font-size:0.8rem; opacity:0.9; }

    .top-actions { display:flex; gap:8px; align-items:center; }
    .btn {
      border:none; padding:8px 12px; border-radius:8px; font-weight:800; transition:all .12s;
      background:rgba(255,255,255,0.1); color:white;
    }
    .btn:hover { transform:translateY(-3px); background:rgba(255,255,255,0.12); }
    .btn-primary { background:linear-gradient(90deg,#ff7a7a,#ffb36b); color:#102; box-shadow:0 8px 22px rgba(255,120,120,0.14); }
    .btn-ghost { background:transparent; border:1px solid rgba(255,255,255,0.08); color:white; }
    .search-wrap { display:flex; gap:8px; align-items:center; background:rgba(255,255,255,0.06); padding:8px 10px; border-radius:10px; min-width:280px; }
    .search-wrap input { background:transparent; border:none; outline:none; color:white; width:220px; }

    /* ========== Layout ========== */
    .container { max-width:1200px; margin:26px auto; padding:0 16px; }

    .hero {
      display:flex; gap:22px; align-items:center; background: linear-gradient(180deg,#fff,#f7fbff);
      border-radius:14px; padding:18px; box-shadow:0 12px 30px rgba(12,28,36,0.06);
    }
    .hero-left { flex:1; min-width:280px; }
    .hero-right { width:380px; display:flex; justify-content:center; }

    .hero h2 { margin:0 0 8px; font-size:1.6rem; color:#062a2f; }
    .hero p { margin:0 0 14px; color:#546; }

    .quick-actions { display:flex; gap:10px; flex-wrap:wrap; margin-top:8px; }
    .quick-card { background:linear-gradient(180deg,#fff,#f6fdff); border-radius:12px; padding:10px; min-width:170px; display:flex; gap:10px; align-items:center; box-shadow:0 8px 18px rgba(10,20,30,0.03); }
    .quick-icon { width:46px; height:46px; border-radius:10px; display:flex; align-items:center; justify-content:center; font-weight:900; color:#042; background:linear-gradient(135deg,#6dd3ff,#87f0d8); }

    /* ========== Filters ========== */
    .filters { display:flex; gap:12px; align-items:center; margin:18px 0; flex-wrap:wrap; }
    .category-pill { padding:8px 14px; background:linear-gradient(180deg,#fff,#f7fbff); border-radius:999px; box-shadow:0 8px 20px rgba(10,20,30,0.03); font-weight:800; cursor:pointer; border:1px solid rgba(10,20,30,0.03); }
    .category-pill.active { background:linear-gradient(90deg,#ffd166,#ff7a7a); color:#102; transform:translateY(-3px); }

    /* ========== Grid ========== */
    .grid { display:grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap:16px; }
    .card { background:linear-gradient(180deg,#fff,#fbfeff); border-radius:12px; overflow:hidden; box-shadow:0 12px 30px rgba(12,28,36,0.06); transition:transform .18s, box-shadow .18s; border:1px solid rgba(8,20,28,0.03); }
    .card:hover { transform:translateY(-8px); box-shadow:0 20px 44px rgba(12,28,36,0.09); }
    .card-media { height:200px; overflow:hidden; position:relative; }
    .card-media img { width:100%; height:100%; object-fit:cover; transition:transform .6s; display:block; }
    .card:hover .card-media img { transform:scale(1.06); }
    .badge { position:absolute; top:12px; left:12px; background:linear-gradient(90deg,#ff8a65,#ffb86b); color:white; padding:6px 10px; border-radius:8px; font-weight:900; box-shadow:0 8px 18px rgba(255,120,80,0.12); }
    .card-body { padding:12px 14px; }
    .card-title { font-weight:900; color:#053; margin:0 0 6px; }
    .card-loc { color:#567; font-size:0.9rem; margin-bottom:8px; }
    .card-meta { display:flex; justify-content:space-between; align-items:center; gap:8px; }
    .price { font-weight:900; color:#ff6b6b; }
    .meta-small { color:#667; font-size:0.9rem; }
    .card-actions { margin-top:10px; display:flex; gap:8px; align-items:center; justify-content:space-between; }

    .btn-small { padding:8px 10px; border-radius:8px; font-weight:800; border:none; }
    .btn-ws { background:linear-gradient(90deg,#25d366,#128c7e); color:white; }

    /* ========== Full-screen detail modal (reused for admin page transition) ========== */
    .modal {
      position:fixed; inset:0; display:none; align-items:center; justify-content:center;
      background:linear-gradient(0deg, rgba(0,0,0,0.45), rgba(0,0,0,0.45)); z-index:1200; padding:20px;
    }
    .modal.show { display:flex; }
    .detail {
      width:100%; max-width:1100px; background:white; border-radius:12px; overflow:hidden;
      display:flex; gap:12px; box-shadow:0 20px 50px rgba(12,28,36,0.25); animation:pop .18s;
    }
    @keyframes pop { from { transform:translateY(12px) scale(.99); opacity:0 } to { transform:none; opacity:1 } }
    .detail-left { flex:1; padding:14px; background:#fafafa; min-width:300px; }
    .main-img { width:100%; height:460px; border-radius:10px; overflow:hidden; background:#ddd; }
    .main-img img { width:100%; height:100%; object-fit:cover; display:block; }
    .thumbs { display:flex; gap:8px; margin-top:12px; }
    .thumbs img { width:88px; height:64px; object-fit:cover; border-radius:8px; cursor:pointer; border:2px solid transparent; transition:border .12s; }
    .thumbs img.active { border-color:#00bfa6; }

    .detail-right { width:420px; padding:18px; display:flex; flex-direction:column; gap:12px; }
    .detail-right h3 { margin:0; color:#043; font-size:1.25rem; }
    .detail-box { background:linear-gradient(180deg,#fff,#fbfbfe); border-radius:8px; padding:12px; border:1px solid rgba(8,20,28,0.04); }
    .label { font-weight:900; color:#2b3b3f; margin-bottom:6px; display:block; }
    .desc { color:#445; white-space:pre-line; }

    /* ========== Add (full-screen panel) ========== */
    /* we will use .fullscreen class to make addModal full screen for comfortable editing */
    #addModal.fullscreen .detail { width:100%; height:100vh; max-width:none; border-radius:0; display:grid; grid-template-columns: 1fr 380px; }
    #addModal.fullscreen .detail > div { overflow:auto; padding:20px; }

    .form-grid { display:grid; gap:12px; grid-template-columns: 1fr; }
    .input, textarea, select { width:100%; padding:10px 12px; border-radius:8px; border:1px solid #e0e6ea; outline:none; font-size:0.95rem; }
    textarea { min-height:120px; resize:vertical; }
    .images-preview { display:flex; gap:8px; margin-top:6px; }
    .img-slot { width:120px; height:84px; border-radius:8px; background:#f4f7f9; border:1px dashed #d7e2e8; display:flex; align-items:center; justify-content:center; overflow:hidden; }
    .img-slot img { width:100%; height:100%; object-fit:cover; }

    .form-actions { display:flex; gap:8px; justify-content:flex-start; margin-top:8px; }

    /* ========== Admin page (full screen view) ========== */
    #adminPage { display:none; position:fixed; inset:0; z-index:1300; background:#f4f6f8; overflow:auto; padding:28px; }
    .admin-shell { max-width:1200px; margin:0 auto; background:white; border-radius:12px; padding:18px; box-shadow:0 16px 38px rgba(12,28,36,0.12); }
    .admin-head { display:flex; justify-content:space-between; gap:12px; align-items:center; margin-bottom:12px; }
    .tabs { display:flex; gap:8px; }
    .tab { padding:8px 12px; border-radius:8px; background:linear-gradient(180deg,#fff,#fbfeff); border:1px solid #eef3f6; font-weight:800; cursor:pointer; }
    .tab.active { background:linear-gradient(90deg,#ffd166,#ff7a7a); color:#102; transform:translateY(-3px); }

    .admin-grid { display:grid; gap:16px; grid-template-columns:1fr; }
    .admin-table { width:100%; border-collapse:collapse; }
    .admin-table th, .admin-table td { padding:10px; text-align:right; border-bottom:1px solid #f2f6f8; }
    .admin-actions button { margin-left:8px; }

    /* ========== Footer ========== */
    footer { padding:22px; text-align:center; color:#567; font-size:0.95rem; margin-top:30px; }

    /* ========== Responsive ========== */
    @media (max-width:980px) {
      .detail { flex-direction:column; max-height:90vh; overflow:auto; }
      .detail-left, .detail-right { width:100%; }
      .hero-right { display:none; }
      .search-wrap input { width:120px; }
      .topbar { padding:10px; }
      #addModal.fullscreen .detail { grid-template-columns: 1fr; height:100vh; }
      .main-img { height:300px; }
    }
  </style>
</head>
<body>

  <!-- TOPBAR -->
  <div class="topbar">
    <div class="brand">
      <div class="logo" id="logoText">Ù†Ø®</div>
      <div>
        <div class="site-title" id="siteNameDisplay">Ø§Ù„Ù†Ø®Ø¨Ø© Ø§Ù„Ø¹Ù‚Ø§Ø±ÙŠØ©</div>
        <div class="site-sub">Ù…Ù†ØµØ© Ø¹Ø±Ø¶ ÙˆØ¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¹Ù‚Ø§Ø±Ø§Øª</div>
      </div>
    </div>

    <div class="search-wrap" title="Ø¨Ø­Ø« Ø³Ø±ÙŠØ¹">
      <svg width="18" height="18" viewBox="0 0 24 24" fill="none" style="opacity:.95;margin-left:6px">
        <path d="M21 21l-4.35-4.35" stroke="white" stroke-width="1.6" stroke-linecap="round"/>
        <circle cx="11" cy="11" r="6" stroke="white" stroke-width="1.6"/>
      </svg>
      <input id="globalSearch" placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† Ø¹Ù†ÙˆØ§Ù†ØŒ Ù…ÙˆÙ‚Ø¹ØŒ Ø³Ø¹Ø±..." />
    </div>

    <div class="top-actions">
      <button class="btn" id="btnShowAdd">Ø¥Ø¶Ø§ÙØ© Ø¹Ù‚Ø§Ø±</button>
      <button class="btn" id="btnLogin">Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…Ø¯ÙŠØ±</button>
      <!-- btnSiteEdit ÙŠØ®ÙÙŠÙ‡ Ù„Ù„Ø¹Ø§Ù…Ø© ÙˆÙŠØ¸Ù‡Ø± Ù„Ù„Ù…Ø¯ÙŠØ± ÙÙ‚Ø· -->
      <button class="btn" id="btnSiteEdit" style="display:none;">ØªØ¹Ø¯ÙŠÙ„ Ø§Ø³Ù… Ø§Ù„Ù…ÙˆÙ‚Ø¹</button>
    </div>
  </div>

  <!-- MAIN CONTAINER -->
  <div class="container" id="mainContent">

    <section class="hero" aria-label="Ù…Ù‚Ø¯Ù…Ø©">
      <div class="hero-left">
        <h2>Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ø§Ù„Ù†Ø®Ø¨Ø© Ø§Ù„Ø¹Ù‚Ø§Ø±ÙŠØ©</h2>
        <p>Ø§Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ø¹Ù‚Ø§Ø± Ø§Ù„Ù…Ù†Ø§Ø³Ø¨ Ø£Ùˆ Ø£Ø¶Ù Ø¹Ø±Ø¶Ùƒ Ø¨Ø³Ù‡ÙˆÙ„Ø© â€” ÙŠØ¸Ù‡Ø± Ø§Ù„Ø¥Ø¹Ù„Ø§Ù† Ø¨Ø¹Ø¯ Ù…ÙˆØ§ÙÙ‚Ø© Ø§Ù„Ù…Ø¯ÙŠØ±.</p>
        <div class="quick-actions">
          <div class="quick-card"><div class="quick-icon">ğŸ </div><div><div style="font-weight:900">Ø¹Ø±Ø¶ Ù…ØªÙ†ÙˆØ¹</div><div class="small-hint">ÙÙ„Ù„ØŒ Ø´Ù‚Ù‚ØŒ Ø£Ø±Ø§Ø¶ÙŠØŒ Ø§Ø³ØªØ±Ø§Ø­Ø§Øª</div></div></div>
          <div class="quick-card"><div class="quick-icon">ğŸ›¡ï¸</div><div><div style="font-weight:900">Ù…ÙˆØ§ÙÙ‚Ø© Ø¢Ù…Ù†Ø©</div><div class="small-hint">Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª ØªØ¸Ù‡Ø± Ø¨Ø¹Ø¯ Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø©</div></div></div>
          <div class="quick-card"><div class="quick-icon">âœ‰ï¸</div><div><div style="font-weight:900">ØªÙˆØ§ØµÙ„ Ù…Ø¨Ø§Ø´Ø±</div><div class="small-hint">Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨ ÙŠÙØªØ­ Ù…Ø­Ø§Ø¯Ø«Ø© Ù„Ù„Ù…Ø¯ÙŠØ±</div></div></div>
        </div>
      </div>

      <div class="hero-right">
        <img src="https://images.unsplash.com/photo-1560448204-e02f11c3d0e2?q=80&w=900&auto=format&fit=crop" alt="hero" style="width:100%;height:220px;object-fit:cover;border-radius:12px;box-shadow:0 10px 28px rgba(12,28,36,0.08)" />
      </div>
    </section>

    <!-- Filters -->
    <div class="filters" role="navigation" aria-label="ÙØ¦Ø§Øª">
      <div class="category-pill active" data-cat="all">Ø§Ù„ÙƒÙ„</div>
      <div class="category-pill" data-cat="ÙÙ„Ù„">ÙÙ„Ù„</div>
      <div class="category-pill" data-cat="Ø´Ù‚Ù‚">Ø´Ù‚Ù‚</div>
      <div class="category-pill" data-cat="Ø¹Ù…Ø§Ø¦Ø±">Ø¹Ù…Ø§Ø¦Ø±</div>
      <div class="category-pill" data-cat="Ø£Ø±Ø§Ø¶ÙŠ">Ø£Ø±Ø§Ø¶ÙŠ</div>
      <div class="category-pill" data-cat="Ø§Ø³ØªØ±Ø§Ø­Ø§Øª">Ø§Ø³ØªØ±Ø§Ø­Ø§Øª</div>
      <div class="category-pill" data-cat="Ø£Ø¯ÙˆØ§Ø± Ù…Ø³ØªÙ‚Ù„Ø©">Ø£Ø¯ÙˆØ§Ø± Ù…Ø³ØªÙ‚Ù„Ø©</div>

      <div style="margin-left:auto; display:flex; gap:8px; align-items:center;">
        <select id="sortSelect" class="input" style="width:auto; padding:8px 10px;">
          <option value="recent">Ø§Ù„Ø£Ø­Ø¯Ø«</option>
          <option value="price-asc">Ø§Ù„Ø³Ø¹Ø±: Ù…Ù† Ø§Ù„Ø£Ù‚Ù„</option>
          <option value="price-desc">Ø§Ù„Ø³Ø¹Ø±: Ù…Ù† Ø§Ù„Ø£Ø¹Ù„Ù‰</option>
        </select>
      </div>
    </div>

    <!-- Grid -->
    <section>
      <div id="propertiesCount" style="font-weight:900; margin-bottom:8px; color:#234">Ø§Ù„Ø¹Ù‚Ø§Ø±Ø§Øª Ø§Ù„Ù…Ø¹Ø±ÙˆØ¶Ø©: <span id="cntVal">0</span></div>
      <div class="grid" id="propertiesGrid" aria-live="polite"></div>
    </section>

    <footer>
      Â© 2025 Ø§Ù„Ù†Ø®Ø¨Ø© Ø§Ù„Ø¹Ù‚Ø§Ø±ÙŠØ© â€” Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø© â€” Ø¬Ø§Ù‡Ø² Ù„Ù„Ø±Ø¨Ø· Ø¨Ù€ Firebase.
    </footer>
  </div>

  <!-- ========== DETAIL MODAL ========== -->
  <div id="detailModal" class="modal" aria-hidden="true" aria-label="ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø¹Ù‚Ø§Ø±">
    <div class="detail" role="dialog">
      <div class="detail-left">
        <div class="main-img" id="detailMainImg"><img id="detailMainImgImg" src="" alt=""></div>
        <div class="thumbs" id="detailThumbs"></div>
      </div>
      <div class="detail-right">
        <div style="display:flex; justify-content:space-between; align-items:center;">
          <h3 id="detailTitle">Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø¹Ù‚Ø§Ø±</h3>
          <div id="detailStatus" class="tag" style="background:#ffd166;color:#222">Ø­Ø§Ù„Ø©</div>
        </div>

        <div class="detail-box"><span class="label">Ø§Ù„Ù…ÙˆÙ‚Ø¹</span><div id="detailLocation" class="meta-small">Ø§Ù„Ø±ÙŠØ§Ø¶</div></div>
        <div class="detail-box"><span class="label">Ø§Ù„Ù…ÙˆØ§ØµÙØ§Øª</span><div style="display:flex;justify-content:space-between"><div class="meta-small"><strong>Ø§Ù„Ø³Ø¹Ø±:</strong> <span id="detailPrice">0</span> Ø±.Ø³</div><div class="meta-small"><strong>Ø§Ù„Ù…Ø³Ø§Ø­Ø©:</strong> <span id="detailArea">0</span> Ù…Â²</div></div></div>
        <div class="detail-box"><span class="label">Ø­Ø§Ù„Ø© Ø§Ù„ØµÙƒ / Ø§Ù„Ø¨Ù†Ùƒ</span><div id="detailDeed" class="meta-small">Ø§Ù„ØµÙƒ: - â€” Ù‚Ø¨ÙˆÙ„ Ø§Ù„Ø¨Ù†Ùƒ: -</div></div>
        <div class="detail-box"><span class="label">Ø§Ù„ÙˆØµÙ</span><div id="detailDesc" class="desc">ÙˆØµÙ ÙƒØ§Ù…Ù„...</div></div>

        <div style="display:flex; gap:10px; margin-top:6px; align-items:center;">
          <a id="whatsappBtn" class="btn btn-ws" target="_blank" rel="noopener noreferrer">Ù…Ø±Ø§Ø³Ù„Ø© Ø¹Ø¨Ø± ÙˆØ§ØªØ³Ø§Ø¨ (Ù„Ù„Ø¥Ø¯Ø§Ø±Ø©)</a>
          <button class="btn btn-ghost" id="backBtn" onclick="closeDetail()">Ø±Ø¬ÙˆØ¹</button>
        </div>

        <div style="font-size:0.85rem; color:#667; margin-top:8px;">
          Ù…Ù„Ø§Ø­Ø¸Ø©: Ø³ÙŠØªÙ… ÙØªØ­ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø© Ù…Ø¹ Ø±Ù‚Ù… Ø§Ù„Ù…Ø¯ÙŠØ± ÙˆØªØ­ØªÙˆÙŠ Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø¹Ù„Ù‰ Ø¹Ù†ÙˆØ§Ù† ÙˆØ±Ù‚Ù… Ø§Ù„Ø¹Ù‚Ø§Ø± Ù„ØªØ³Ù‡ÙŠÙ„ Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø©.
        </div>
      </div>
    </div>
  </div>

  <!-- ========== ADD PROPERTY (FULLSCREEN PANEL) ========== -->
  <div id="addModal" class="modal" aria-hidden="true" aria-label="Ø¥Ø¶Ø§ÙØ© Ø¹Ù‚Ø§Ø±">
    <div class="detail" role="dialog" style="max-width:1200px;">
      <div style="flex:1; padding:18px; overflow:auto;">
        <h3>Ù†Ù…ÙˆØ°Ø¬ Ø¥Ø¶Ø§ÙØ© Ø¹Ù‚Ø§Ø±</h3>
        <p class="small-hint">Ø±ÙØ¹ Ø­ØªÙ‰ 3 ØµÙˆØ± (Ø§Ù„Ø£ÙˆÙ„Ù‰ ÙŠØ¬Ø¨ Ø£Ù† ØªÙƒÙˆÙ† ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ø¹Ù‚Ø§Ø±). Ø§Ù„Ø¥Ø¹Ù„Ø§Ù† Ø³ÙŠØµÙ„ Ù„Ù„Ù…Ø¯ÙŠØ± Ù„Ù„Ù…Ø±Ø§Ø¬Ø¹Ø© Ù‚Ø¨Ù„ Ø§Ù„Ù†Ø´Ø±.</p>

        <form id="addPropertyForm" onsubmit="onSubmitAdd(event)">
          <div class="form-grid">
            <label>Ø§Ù„ØµÙˆØ± (Ø­ØªÙ‰ 3 ØµÙˆØ±)</label>
            <input type="file" id="imagesInput" accept="image/*" multiple />
            <div class="images-preview" id="imagesPreview"></div>

            <label>Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø¹Ø±Ø¶</label>
            <input id="inputTitle" class="input" placeholder="Ù…Ø«Ø§Ù„: Ø¹Ù…Ø§Ø±Ø© Ø¯ÙˆØ±ÙŠÙ† - Ø¹Ù„Ù‰ Ø´Ø§Ø±Ø¹ Ø±Ø¦ÙŠØ³ÙŠ" required />

            <label>Ø§Ù„Ù‚Ø³Ù…</label>
            <select id="inputCategory" class="input" required>
              <option value="ÙÙ„Ù„">ÙÙ„Ù„</option>
              <option value="Ø´Ù‚Ù‚">Ø´Ù‚Ù‚</option>
              <option value="Ø¹Ù…Ø§Ø¦Ø±">Ø¹Ù…Ø§Ø¦Ø±</option>
              <option value="Ø£Ø±Ø§Ø¶ÙŠ">Ø£Ø±Ø§Ø¶ÙŠ</option>
              <option value="Ø§Ø³ØªØ±Ø§Ø­Ø§Øª">Ø§Ø³ØªØ±Ø§Ø­Ø§Øª</option>
              <option value="Ø£Ø¯ÙˆØ§Ø± Ù…Ø³ØªÙ‚Ù„Ø©">Ø£Ø¯ÙˆØ§Ø± Ù…Ø³ØªÙ‚Ù„Ø©</option>
            </select>

            <label>Ø§Ù„Ø³Ø¹Ø± (Ø¨Ø§Ù„Ø£Ø±Ù‚Ø§Ù… Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ© ÙÙ‚Ø·)</label>
            <input id="inputPrice" class="input" placeholder="Ù…Ø«Ø§Ù„: 1500000" inputmode="numeric" pattern="[0-9]*" required />

            <label>Ø§Ù„Ù…Ø³Ø§Ø­Ø© (Ù…Â²)</label>
            <input id="inputArea" class="input" placeholder="Ù…Ø«Ø§Ù„: 450" inputmode="numeric" pattern="[0-9]*" required />

            <label>Ø§Ù„Ù…ÙˆÙ‚Ø¹ (Ù†ØµÙŠÙ‹Ø§)</label>
            <input id="inputLocation" class="input" placeholder="Ù…Ø«Ø§Ù„: Ø§Ù„Ø­ÙˆÙŠØ©ØŒ Ø§Ù„Ø±ÙŠØ§Ø¶ - Ù‚Ø±ÙŠØ¨ Ø¬Ø§Ù…Ø¹ Ø§Ù„Ø³Ù…Ø§Ø­" required />

            <label>Ø±Ù‚Ù… Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨ Ù„Ù„Ù…Ø§Ù„Ùƒ (Ø³ÙŠØ¸Ù‡Ø± Ù„Ù„Ù…Ø¯ÙŠØ± ÙÙ‚Ø·)</label>
            <input id="inputOwnerPhone" class="input" placeholder="Ù…Ø«Ø§Ù„: 0551234567" required />

            <label>Ù‡Ù„ Ø§Ù„Ø¹Ù‚Ø§Ø± Ø¨ØµÙƒØŸ</label>
            <select id="inputDeed" class="input">
              <option value="Ù„Ø§">Ù„Ø§</option>
              <option value="Ù†Ø¹Ù…">Ù†Ø¹Ù…</option>
            </select>

            <div id="bankWrapper" style="display:none;">
              <label>Ù‡Ù„ ÙŠÙ‚Ø¨Ù„ Ø§Ù„Ø¨Ù†ÙƒØŸ</label>
              <select id="inputBank" class="input">
                <option value="Ù„Ø§">Ù„Ø§</option>
                <option value="Ù†Ø¹Ù…">Ù†Ø¹Ù…</option>
              </select>
            </div>

            <label>ÙˆØµÙ ÙƒØ§Ù…Ù„ Ù„Ù„Ø¹Ù‚Ø§Ø±</label>
            <textarea id="inputDesc" placeholder="ÙˆØµÙ Ø§Ù„Ø¹Ù‚Ø§Ø± (Ø§Ù„Ø­Ø§Ù„Ø©ØŒ Ø§Ù„Ù…Ø±Ø§ÙÙ‚ØŒ Ø§Ù„Ù‚Ø±Ø¨ Ù…Ù† Ø§Ù„Ø®Ø¯Ù…Ø§ØªØŒ Ù…Ù„Ø§Ø­Ø¸Ø§Øª)"></textarea>

            <div class="form-actions">
              <button type="submit" class="btn btn-primary">Ù†Ø´Ø± Ù„Ù„Ø¥Ø¯Ø§Ø±Ø© (Ø¨Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø©)</button>
              <button type="button" class="btn btn-ghost" onclick="closeAdd()">Ø¥Ù„ØºØ§Ø¡</button>
            </div>
          </div>
        </form>

      </div>

      <!-- side tips -->
      <div style="width:360px; padding:18px; background:linear-gradient(180deg,#f7fafc,#ffffff);">
        <h4 style="margin-top:0">Ù†ØµØ§Ø¦Ø­ Ù„ØªØ­Ø³ÙŠÙ† Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†</h4>
        <ul style="color:#556; line-height:1.6;">
          <li>Ø¶Ø¹ ØµÙˆØ±Ø© Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© Ø£ÙˆÙ„Ù‹Ø§.</li>
          <li>Ø§Ø®ØªØ± Ø£ÙØ¶Ù„ 3 ØµÙˆØ± ØªÙ…Ø«Ù„ Ø§Ù„Ø¹Ù‚Ø§Ø±.</li>
          <li>Ø§ÙƒØªØ¨ Ø§Ù„Ø³Ø¹Ø± Ø¨Ø§Ù„Ø£Ø±Ù‚Ø§Ù… Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ© Ø¨Ø¯ÙˆÙ† ÙÙˆØ§ØµÙ„.</li>
          <li>Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù… ÙˆØ§ØªØ³Ø§Ø¨ ØµØ­ÙŠØ­ Ù„ÙŠØªÙˆØ§ØµÙ„ Ø§Ù„Ù…Ø¯ÙŠØ± Ù…Ø¹ Ø§Ù„Ù…Ø§Ù„Ùƒ.</li>
        </ul>
      </div>
    </div>
  </div>

  <!-- ========== LOGIN MODAL (Ù„Ø§ ØªØ¹Ø±Ø¶ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± / Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙÙŠ Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©) ========== -->
  <div id="loginModal" class="modal" aria-hidden="true" aria-label="Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…Ø¯ÙŠØ±">
    <div class="detail" role="dialog" style="max-width:420px;">
      <div style="flex:1; padding:18px;">
        <h3>ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…Ø¯ÙŠØ±</h3>
        <p class="small-hint">Ø£Ø¯Ø®Ù„ Ø¨ÙŠØ§Ù†Ø§ØªÙƒ Ù„Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¥Ù„Ù‰ Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø¯ÙŠØ± Ø§Ù„Ø®Ø§ØµØ©.</p>
        <label>Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</label>
        <input id="loginUser" class="input" />
        <label>ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label>
        <input id="loginPass" type="password" class="input" />
        <div style="display:flex; gap:8px; margin-top:12px;">
          <button class="btn btn-primary" onclick="doLogin()">Ø¯Ø®ÙˆÙ„</button>
          <button class="btn btn-ghost" onclick="closeLogin()">Ø¥Ù„ØºØ§Ø¡</button>
        </div>
        <div id="loginError" style="color:#b33; margin-top:8px; display:none;"></div>
      </div>
    </div>
  </div>

  <!-- ========== EDIT MODAL (Ù…Ø¯ÙŠØ± ÙÙ‚Ø·) ========== -->
  <div id="editModal" class="modal" aria-hidden="true" aria-label="ØªØ¹Ø¯ÙŠÙ„ Ø¥Ø¹Ù„Ø§Ù†">
    <div class="detail" role="dialog" style="max-width:820px;">
      <div style="flex:1; padding:18px;">
        <h3>ØªØ¹Ø¯ÙŠÙ„ Ø¥Ø¹Ù„Ø§Ù†</h3>
        <form id="editForm" onsubmit="onSubmitEdit(event)">
          <input type="hidden" id="editId" />
          <label>Ø§Ù„Ø¹Ù†ÙˆØ§Ù†</label><input id="editTitle" class="input" required />
          <label>Ø§Ù„Ù‚Ø³Ù…</label>
          <select id="editCategory" class="input"><option>ÙÙ„Ù„</option><option>Ø´Ù‚Ù‚</option><option>Ø¹Ù…Ø§Ø¦Ø±</option><option>Ø£Ø±Ø§Ø¶ÙŠ</option><option>Ø§Ø³ØªØ±Ø§Ø­Ø§Øª</option><option>Ø£Ø¯ÙˆØ§Ø± Ù…Ø³ØªÙ‚Ù„Ø©</option></select>
          <label>Ø§Ù„Ø³Ø¹Ø±</label><input id="editPrice" class="input" required />
          <label>Ø§Ù„Ù…Ø³Ø§Ø­Ø©</label><input id="editArea" class="input" required />
          <label>Ø§Ù„Ù…ÙˆÙ‚Ø¹</label><input id="editLocation" class="input" required />
          <label>Ø±Ù‚Ù… Ø§Ù„Ù…Ø§Ù„Ùƒ (ÙŠØ¸Ù‡Ø± Ù„Ù„Ù…Ø¯ÙŠØ± ÙÙ‚Ø·)</label><input id="editOwnerPhone" class="input" />
          <label>Ø§Ù„ØµÙƒ</label><select id="editDeed" class="input"><option>Ù†Ø¹Ù…</option><option>Ù„Ø§</option></select>
          <div id="editBankWrapper" style="display:none;"><label>Ù‚Ø¨ÙˆÙ„ Ø§Ù„Ø¨Ù†Ùƒ</label><select id="editBank" class="input"><option>Ù†Ø¹Ù…</option><option>Ù„Ø§</option></select></div>
          <label>Ø§Ù„ÙˆØµÙ</label><textarea id="editDesc" class="input"></textarea>

          <div style="display:flex; gap:8px; margin-top:10px;">
            <button class="btn btn-primary" type="submit">Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª</button>
            <button class="btn btn-ghost" type="button" onclick="closeEdit()">Ø¥Ù„ØºØ§Ø¡</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- ========== ADMIN PAGE (ØµÙØ­Ø© Ø®Ø§ØµØ© ÙƒØ§Ù…Ù„Ø©) ========== -->
  <div id="adminPage" aria-hidden="true">
    <div class="admin-shell">
      <div class="admin-head">
        <div>
          <h2 style="margin:0">Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø¯ÙŠØ± â€” Ø§Ù„Ù†Ø®Ø¨Ø© Ø§Ù„Ø¹Ù‚Ø§Ø±ÙŠØ©</h2>
          <div style="color:#556; font-size:0.95rem; margin-top:4px">Ù‡Ù†Ø§ ÙŠÙ…ÙƒÙ†Ùƒ Ù…Ø´Ø§Ù‡Ø¯Ø© ÙˆØ¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¹Ù‚Ø§Ø±Ø§Øª (Ø§Ù„Ù…Ø¹Ù„Ù‚Ø©ØŒ Ø§Ù„Ù…Ø§Ù„ÙƒØŒ ÙˆØ§Ù„Ø®Ø§Øµ Ø¨Ø§Ù„Ù…Ø¯ÙŠØ±).</div>
        </div>
        <div style="display:flex; gap:10px; align-items:center;">
          <div id="adminSummary" style="text-align:right;">
            <div style="font-weight:900; font-size:1.1rem" id="adminTotal">Ø¥Ø¬Ù…Ø§Ù„ÙŠ: 0</div>
            <div style="color:#667; font-size:0.9rem">Ù…ÙˆØ§ÙÙ‚Ø©: <span id="adminApproved">0</span> / Ø¨Ø§Ù†ØªØ¸Ø§Ø±: <span id="adminPending">0</span></div>
          </div>
          <div>
            <button class="btn btn-ghost" onclick="closeAdmin()">Ø¹ÙˆØ¯Ø© Ù„Ù„Ù…ÙˆÙ‚Ø¹</button>
            <button class="btn btn-primary" onclick="adminCreateProperty()">Ø¥Ø¶Ø§ÙØ© ÙƒÙ…Ø¯ÙŠØ±</button>
            <button class="btn" id="btnLogoutAdmin">ØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬</button>
          </div>
        </div>
      </div>

      <div style="display:flex; gap:12px; align-items:center; margin-bottom:12px;">
        <div class="tabs">
          <div class="tab active" data-tab="pending">Ø¨Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø©</div>
          <div class="tab" data-tab="owners">Ø¹Ù‚Ø§Ø±Ø§Øª Ø§Ù„Ù…Ù„Ø§Ùƒ</div>
          <div class="tab" data-tab="admin">Ø¹Ù‚Ø§Ø±Ø§ØªÙŠ (Ø§Ù„Ù…Ø¯ÙŠØ±)</div>
        </div>
        <div style="margin-left:auto;">
          <input id="adminSearch" class="input" placeholder="Ø¨Ø­Ø« Ø¶Ù…Ù† Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø¯ÙŠØ± (Ø¹Ù†ÙˆØ§Ù†ØŒ Ù…ÙˆÙ‚Ø¹ØŒ Ø±Ù‚Ù…)"/>
        </div>
      </div>

      <div id="adminContent">
        <!-- pending -->
        <div class="admin-grid" id="tab-pending">
          <h4>Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¹Ù‚Ø§Ø±Ø§Øª Ø¨Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø©</h4>
          <table class="admin-table" id="pendingTable">
            <thead><tr><th>Ø±Ù‚Ù…</th><th>Ø§Ù„Ø¹Ù†ÙˆØ§Ù†</th><th>Ø§Ù„Ù‚Ø³Ù…</th><th>Ø§Ù„Ø³Ø¹Ø±</th><th>Ù…Ø§Ù„Ùƒ</th><th>Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th></tr></thead>
            <tbody></tbody>
          </table>
        </div>

        <!-- owners -->
        <div class="admin-grid" id="tab-owners" style="display:none;">
          <h4>Ø¹Ù‚Ø§Ø±Ø§Øª Ø§Ù„Ù…Ù„Ø§Ùƒ</h4>
          <table class="admin-table" id="ownersTable"><thead><tr><th>Ø±Ù‚Ù…</th><th>Ø§Ù„Ø¹Ù†ÙˆØ§Ù†</th><th>Ø§Ù„Ù‚Ø³Ù…</th><th>Ø§Ù„Ø³Ø¹Ø±</th><th>Ù…Ø§Ù„Ùƒ (Ù„Ù„Ø¥Ø¯Ø§Ø±Ø©)</th><th>Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th></tr></thead><tbody></tbody></table>
        </div>

        <!-- admin -->
        <div class="admin-grid" id="tab-admin" style="display:none;">
          <h4>Ø¹Ù‚Ø§Ø±Ø§ØªÙŠ (Ø§Ù„Ù…Ø¯ÙŠØ±)</h4>
          <table class="admin-table" id="adminTable"><thead><tr><th>Ø±Ù‚Ù…</th><th>Ø§Ù„Ø¹Ù†ÙˆØ§Ù†</th><th>Ø§Ù„Ù‚Ø³Ù…</th><th>Ø§Ù„Ø³Ø¹Ø±</th><th>Ø§Ù„Ø­Ø§Ù„Ø©</th><th>Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th></tr></thead><tbody></tbody></table>
        </div>
      </div>

    </div>
  </div>

<script>
/* ========================
   Ø¨ÙŠØ§Ù†Ø§ØªØŒ Ù…ÙØ§ØªÙŠØ­ØŒ Ù…Ø³Ø§Ø¹Ø¯Ø©
   ======================== */
const STORAGE_KEY = 'alq_properties_v2';
const NEXT_ID_KEY = 'alq_nextid_v2';
const ADMIN_USERNAME = 'IVL511';
const ADMIN_PASSWORD = 'IVL511';
const ADMIN_WHATSAPP = '966535342404';

let properties = JSON.parse(localStorage.getItem(STORAGE_KEY) || 'null') || [];
let nextId = parseInt(localStorage.getItem(NEXT_ID_KEY) || '1', 10);
function persist(){ localStorage.setItem(STORAGE_KEY, JSON.stringify(properties)); localStorage.setItem(NEXT_ID_KEY, String(nextId)); }
function $(id){ return document.getElementById(id); }
function el(tag, attrs={}, ...children){ const e=document.createElement(tag); for(const k in attrs){ if(k==='class') e.className=attrs[k]; else e.setAttribute(k, attrs[k]); } children.forEach(c=>{ if(typeof c==='string') e.appendChild(document.createTextNode(c)); else if(c) e.appendChild(c); }); return e; }
function formatNumber(n){ return Number(n).toLocaleString('en-US'); }

/* ========================
   ØªÙ‡ÙŠØ¦Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ù†Ù…ÙˆØ°Ø¬ÙŠØ©
   ======================== */
function seedSampleData(){
  if(properties.length) return;
  const samples = [
    { title:"ÙÙŠÙ„Ø§ ÙØ§Ø®Ø±Ø© 5 ØºØ±Ù - Ø­ÙŠ Ø§Ù„Ù†Ø®ÙŠÙ„", category:"ÙÙ„Ù„", price:2500000, area:450, location:"Ø§Ù„Ø±ÙŠØ§Ø¶ - Ø§Ù„Ù†Ø®ÙŠÙ„", ownerPhone:"0551234001", deed:"Ù†Ø¹Ù…", bank:"Ù†Ø¹Ù…", desc:"ÙÙŠÙ„Ø§ ÙØ§Ø®Ø±Ø© Ù…Ø¹ Ù…Ø³Ø¨Ø­ ÙˆØ­Ø¯ÙŠÙ‚Ø©.", images:["https://images.unsplash.com/photo-1600585154340-be6161a56a0c?q=80&w=1400&auto=format&fit=crop","https://images.unsplash.com/photo-1568605114967-8130f3a36994?q=80&w=1400&auto=format&fit=crop"], status:"approved", ownerType:"owner", createdAt:Date.now()},
    { title:"Ø´Ù‚Ø© Ø±Ø§Ù‚ÙŠØ© 3 ØºØ±Ù - Ø¨Ø±Ø¬ Ø§Ù„ÙØ¬Ø±", category:"Ø´Ù‚Ù‚", price:750000, area:150, location:"Ø¬Ø¯Ø© - Ø§Ù„Ø¨Ù„Ø¯", ownerPhone:"0551234002", deed:"Ù†Ø¹Ù…", bank:"Ù†Ø¹Ù…", desc:"Ø´Ù‚Ø© Ø­Ø¯ÙŠØ«Ø©ØŒ Ù…ÙˆÙ‚Ø¹ Ù…Ù…ØªØ§Ø².", images:["https://images.unsplash.com/photo-1560448204-e02f11c3d0e2?q=80&w=1400&auto=format&fit=crop"], status:"approved", ownerType:"owner", createdAt:Date.now()},
    { title:"Ø§Ø³ØªØ±Ø§Ø­Ø© ÙØ§Ø®Ø±Ø© Ù…Ø¹ Ù…Ø³Ø¨Ø­", category:"Ø§Ø³ØªØ±Ø§Ø­Ø§Øª", price:950000, area:650, location:"Ø§Ù„Ø·Ø§Ø¦Ù - Ø§Ù„Ø®Ù…Ø±Ø©", ownerPhone:"0551234005", deed:"Ù†Ø¹Ù…", bank:"Ù„Ø§", desc:"Ø§Ø³ØªØ±Ø§Ø­Ø© Ù…Ø¬Ù‡Ø²Ø© Ù„Ù‚Ø¶Ø§Ø¡ Ø§Ù„Ø¹Ø·Ù„.", images:["https://images.unsplash.com/photo-1505691723518-36a3b7b1a5c5?q=80&w=1400&auto=format&fit=crop"], status:"approved", ownerType:"owner", createdAt:Date.now()},
    { title:"Ø£Ø±Ø¶ Ø§Ø³ØªØ«Ù…Ø§Ø±ÙŠØ© Ù‚Ø±Ø¨ Ø§Ù„Ø·Ø±ÙŠÙ‚", category:"Ø£Ø±Ø§Ø¶ÙŠ", price:5000000, area:1800, location:"Ø¬Ø¯Ø© - Ø§Ù„ØµÙ†Ø§Ø¹ÙŠØ©", ownerPhone:"0551234004", deed:"Ù†Ø¹Ù…", bank:"Ù†Ø¹Ù…", desc:"Ø£Ø±Ø¶ ØªØ¬Ø§Ø±ÙŠØ© Ø¨Ù…ÙˆÙ‚Ø¹ Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠ.", images:["https://images.unsplash.com/photo-1502672260266-1c1ef2d93688?q=80&w=1400&auto=format&fit=crop"], status:"approved", ownerType:"owner", createdAt:Date.now()},
    { title:"Ø¯ÙˆØ± Ù…Ø³ØªÙ‚Ù„ ÙˆØ§Ø³Ø¹ Ù„Ù„Ø¹Ø§Ø¦Ù„Ø§Øª", category:"Ø£Ø¯ÙˆØ§Ø± Ù…Ø³ØªÙ‚Ù„Ø©", price:600000, area:300, location:"Ø§Ù„Ø¯Ù…Ø§Ù… - Ø§Ù„Ø´Ø§Ø·Ø¦", ownerPhone:"0551234006", deed:"Ù†Ø¹Ù…", bank:"Ù†Ø¹Ù…", desc:"Ø¯ÙˆØ± Ù…Ø³ØªÙ‚Ù„ Ù…Ø¹ Ø­ÙˆØ´.", images:["https://images.unsplash.com/photo-1475855581690-80acc9d18e0a?q=80&w=1400&auto=format&fit=crop"], status:"approved", ownerType:"owner", createdAt:Date.now()},
    // Pending
    { title:"Ø´Ù‚Ø© Ù„Ù„Ø¥ÙŠØ¬Ø§Ø± Ø¨Ø¹Ø¯ Ø§Ù„ØªØ¬Ø¯ÙŠØ¯", category:"Ø´Ù‚Ù‚", price:320000, area:95, location:"ØªØ¨ÙˆÙƒ - Ø§Ù„Ø³ÙˆÙŠÙ‚Ø©", ownerPhone:"0551234007", deed:"Ù„Ø§", bank:"Ù„Ø§", desc:"Ø´Ù‚Ø© Ø¨Ø¹Ø¯ Ø§Ù„ØªØ¬Ø¯ÙŠØ¯.", images:["https://images.unsplash.com/photo-1560449753-74f0c2b1f16a?q=80&w=1400&auto=format&fit=crop"], status:"pending", ownerType:"owner", createdAt:Date.now()},
    { title:"Ø¹Ù…Ø§Ø±Ø© Ù„Ù„ØªØ±Ù…ÙŠÙ… - ÙØ±ØµØ©", category:"Ø¹Ù…Ø§Ø¦Ø±", price:1450000, area:520, location:"Ø§Ù„Ù…Ø¯ÙŠÙ†Ø© - Ø§Ù„ØµÙ†Ø§Ø¹ÙŠØ©", ownerPhone:"0551234008", deed:"Ù†Ø¹Ù…", bank:"Ù„Ø§", desc:"Ø¹Ù…Ø§Ø±Ø© ØªØ­ØªØ§Ø¬ ØªØ±Ù…ÙŠÙ….", images:["https://images.unsplash.com/photo-1549187774-b4e9b0445b6b?q=80&w=1400&auto=format&fit=crop"], status:"pending", ownerType:"owner", createdAt:Date.now()}
  ];
  samples.forEach(s=>{ s.id = nextId++; properties.push(s); });
  persist();
}
seedSampleData();

/* ========================
   Ø±Ø³Ù… Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª ÙˆØ§Ù„Ù‚ÙˆØ§Ø¦Ù…
   ======================== */
function createCard(prop){
  const card = el('article',{class:'card','data-id':prop.id});
  const media = el('div',{class:'card-media'});
  const img = el('img'); img.src = (prop.images && prop.images.length) ? prop.images[0] : placeholderImage();
  media.appendChild(img);
  const badge = el('div',{class:'badge'}, prop.category);
  media.appendChild(badge);
  const body = el('div',{class:'card-body'});
  const title = el('h4',{class:'card-title'}, prop.title);
  const loc = el('div',{class:'card-loc'}, prop.location);
  const meta = el('div',{class:'card-meta'});
  const price = el('div',{class:'price'}, formatNumber(prop.price) + ' Ø±.Ø³');
  const small = el('div',{class:'meta-small'}, (prop.area || '-') + ' Ù…Â²');
  meta.appendChild(price); meta.appendChild(small);
  const actions = el('div',{class:'card-actions'});
  const btnView = el('button',{class:'btn-small btn-ghost'}, 'Ø¹Ø±Ø¶ Ø§Ù„Ø¹Ù‚Ø§Ø±'); btnView.onclick = ()=> openDetail(prop.id);
  const btnWhats = el('button',{class:'btn-small btn-ws'}, 'ÙˆØ§ØªØ³Ø§Ø¨'); btnWhats.onclick = ()=> {
    const text = `Ù…Ø±Ø­Ø¨Ù‹Ø§ØŒ Ø£Ø¹Ø¬Ø¨Ù†ÙŠ Ø§Ù„Ø¹Ù‚Ø§Ø±: ${prop.title} (Ø±Ù‚Ù… ${prop.id})\nØ£ÙˆØ¯ Ù…Ø¹Ø±ÙØ© Ø§Ù„Ù…Ø²ÙŠØ¯.`;
    window.open(`https://wa.me/${ADMIN_WHATSAPP}?text=${encodeURIComponent(text)}`, '_blank');
  };
  actions.appendChild(btnView); actions.appendChild(btnWhats);
  body.appendChild(title); body.appendChild(loc); body.appendChild(meta); body.appendChild(actions);
  card.appendChild(media); card.appendChild(body);
  return card;
}

function renderGrid(filter='all', query='', sortBy='recent'){
  const grid = $('propertiesGrid'); grid.innerHTML = '';
  let list = properties.filter(p => p.status === 'approved');
  if(filter !== 'all') list = list.filter(p => p.category === filter);
  if(query && query.trim() !== '') {
    const q = query.trim().toLowerCase();
    list = list.filter(p => ((p.title||'')+ ' ' + (p.location||'') + ' ' + (p.desc||'')).toLowerCase().includes(q));
  }
  if(sortBy === 'price-asc') list.sort((a,b)=>a.price-b.price);
  else if(sortBy === 'price-desc') list.sort((a,b)=>b.price-a.price);
  else list.sort((a,b)=>b.createdAt - a.createdAt);

  $('cntVal').textContent = list.length;
  if(list.length === 0) { grid.appendChild(el('div', {style:'padding:20px;color:#556'}, 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¹Ù‚Ø§Ø±Ø§Øª ÙÙŠ Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ø­Ø§Ù„ÙŠ.')); return; }
  list.forEach(p => grid.appendChild(createCard(p)));
}

/* ========================
   ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø¹Ù‚Ø§Ø±
   ======================== */
function openDetail(id){
  const prop = properties.find(x=>x.id==id); if(!prop) return;
  $('detailTitle').textContent = prop.title;
  $('detailLocation').textContent = prop.location;
  $('detailPrice').textContent = formatNumber(prop.price);
  $('detailArea').textContent = prop.area || '-';
  $('detailDesc').textContent = prop.desc || '';
  $('detailDeed').textContent = `Ø§Ù„ØµÙƒ: ${prop.deed||'Ù„Ø§'} â€” Ù‚Ø¨ÙˆÙ„ Ø§Ù„Ø¨Ù†Ùƒ: ${prop.bank||'Ù„Ø§'}`;
  $('detailStatus').textContent = prop.status === 'approved' ? 'Ù…ÙØ¹Ù„' : 'Ø¨Ø§Ù†ØªØ¸Ø§Ø±';
  const mainImg = $('detailMainImgImg'); const thumbs = $('detailThumbs'); thumbs.innerHTML = '';
  const imgs = (prop.images && prop.images.length) ? prop.images : [placeholderImage()];
  mainImg.src = imgs[0];
  imgs.forEach((src,i)=>{ const t = document.createElement('img'); t.src = src; if(i===0) t.classList.add('active'); t.onclick = ()=>{ mainImg.src = src; thumbs.querySelectorAll('img').forEach(im=>im.classList.remove('active')); t.classList.add('active'); }; thumbs.appendChild(t); });
  const text = `Ù…Ø±Ø­Ø¨Ù‹Ø§ØŒ Ø£Ø¹Ø¬Ø¨Ù†ÙŠ Ø§Ù„Ø¹Ù‚Ø§Ø±: ${prop.title} (Ø±Ù‚Ù… ${prop.id})\nØ§Ù„Ù…ÙˆÙ‚Ø¹: ${prop.location}\nØ§Ù„Ø³Ø¹Ø±: ${formatNumber(prop.price)} Ø±.Ø³`;
  $('whatsappBtn').href = `https://wa.me/${ADMIN_WHATSAPP}?text=${encodeURIComponent(text)}`;
  const modal = $('detailModal'); modal.classList.add('show'); modal.setAttribute('aria-hidden','false');
}
function closeDetail(){ const modal=$('detailModal'); modal.classList.remove('show'); modal.setAttribute('aria-hidden','true'); }

/* ========================
   Ø¥Ø¶Ø§ÙØ© Ø¹Ù‚Ø§Ø± (Ø¹Ø§Ù…) - full screen panel
   ======================== */
let selectedImages = [];
$('btnShowAdd').addEventListener('click', openAdd);
function openAdd(){ const m = $('addModal'); m.classList.add('show'); m.classList.add('fullscreen'); m.setAttribute('aria-hidden','false'); window.scrollTo({top:0, behavior:'smooth'}); }
function closeAdd(){ const m = $('addModal'); m.classList.remove('show'); m.classList.remove('fullscreen'); m.setAttribute('aria-hidden','true'); $('addPropertyForm').reset(); $('imagesPreview').innerHTML=''; selectedImages=[]; }
$('imagesInput').addEventListener('change', function(e){
  const files = Array.from(e.target.files).slice(0,3); selectedImages=[]; $('imagesPreview').innerHTML='';
  files.forEach(file=>{ const r=new FileReader(); r.onload=function(ev){ selectedImages.push(ev.target.result); const slot = el('div',{class:'img-slot'}); const img=el('img'); img.src=ev.target.result; slot.appendChild(img); $('imagesPreview').appendChild(slot); }; r.readAsDataURL(file); });
});
$('inputDeed').addEventListener('change', function(){ $('bankWrapper').style.display = (this.value === 'Ù†Ø¹Ù…') ? 'block' : 'none'; });

function onSubmitAdd(e){
  e.preventDefault();
  if(selectedImages.length < 1){ alert('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø±ÙØ¹ ØµÙˆØ±Ø© ÙˆØ§Ø­Ø¯Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„ (Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© Ø£ÙˆÙ„Ø§Ù‹).'); return; }
  if(selectedImages.length > 3){ alert('Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ 3 ØµÙˆØ±.'); return; }
  const title = $('inputTitle').value.trim(); const category = $('inputCategory').value; const price = Number($('inputPrice').value);
  const area = Number($('inputArea').value); const location = $('inputLocation').value.trim(); const ownerPhone = $('inputOwnerPhone').value.trim();
  const deed = $('inputDeed').value; const bank = $('inputBank').value || 'Ù„Ø§'; const desc = $('inputDesc').value.trim();
  if(!title || !category || !price || !location || !ownerPhone){ alert('Ø§Ù„Ø±Ø¬Ø§Ø¡ ØªØ¹Ø¨Ø¦Ø© Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©.'); return; }
  const prop = { id: nextId++, title, category, price, area, location, ownerPhone, deed, bank, desc, images: selectedImages.slice(0,3), status:'pending', ownerType:'owner', createdAt:Date.now() };
  properties.push(prop); persist();
  closeAdd(); alert('ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¹Ù‚Ø§Ø± Ù„Ø§Ù†ØªØ¸Ø§Ø± Ù…ÙˆØ§ÙÙ‚Ø© Ø§Ù„Ù…Ø¯ÙŠØ±.');
  renderAll(); if(isAdminLogged()) renderAdminTables();
}

/* ========================
   ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…Ø¯ÙŠØ± (Ù„Ø§ Ù†Ø¹Ø±Ø¶ Ø§Ù„Ø§Ø¹ØªÙ…Ø§Ø¯ÙŠØ§Øª)
   ======================== */
$('btnLogin').addEventListener('click', ()=>{ $('loginModal').classList.add('show'); $('loginModal').setAttribute('aria-hidden','false'); });

function closeLogin(){ $('loginModal').classList.remove('show'); $('loginModal').setAttribute('aria-hidden','true'); $('loginError').style.display='none'; $('loginUser').value=''; $('loginPass').value=''; }

function doLogin(){
  const u = $('loginUser').value.trim(); const p = $('loginPass').value.trim();
  if(u === ADMIN_USERNAME && p === ADMIN_PASSWORD){
    closeLogin();
    sessionStorage.setItem('alq_admin_logged','true');
    openAdmin(); alert('ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ ÙƒÙ…Ø¯ÙŠØ±.');
  } else {
    $('loginError').textContent = 'Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„ ØºÙŠØ± ØµØ­ÙŠØ­Ø©'; $('loginError').style.display='block';
  }
}

function isAdminLogged(){ return sessionStorage.getItem('alq_admin_logged') === 'true'; }

/* ========== ADMIN: ØµÙØ­Ø© Ø®Ø§ØµØ© ÙƒØ§Ù…Ù„Ø© ========== */
function openAdmin(){
  // hide main content
  $('mainContent').style.display = 'none';
  $('adminPage').style.display = 'block'; $('adminPage').setAttribute('aria-hidden','false');
  $('btnSiteEdit').style.display = 'inline-block';
  // hide login button
  document.getElementById('btnLogin').style.display = 'none';
  renderAdminTables();
}
function closeAdmin(){
  $('adminPage').style.display = 'none'; $('adminPage').setAttribute('aria-hidden','true');
  $('mainContent').style.display = 'block';
  $('btnSiteEdit').style.display = 'none';
  document.getElementById('btnLogin').style.display = 'inline-block';
  sessionStorage.removeItem('alq_admin_page'); // optional
}
$('btnLogoutAdmin').addEventListener('click', function(){ if(confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬ØŸ')){ sessionStorage.removeItem('alq_admin_logged'); closeAdmin(); alert('ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬.'); renderAll(); } });

/* admin tabs */
document.querySelectorAll('.tab').forEach(t=> t.addEventListener('click', function(){ document.querySelectorAll('.tab').forEach(x=>x.classList.remove('active')); this.classList.add('active'); const tab = this.getAttribute('data-tab'); document.querySelectorAll('#adminContent > div').forEach(d=>d.style.display='none'); if(tab==='pending') document.getElementById('tab-pending').style.display='block'; if(tab==='owners') document.getElementById('tab-owners').style.display='block'; if(tab==='admin') document.getElementById('tab-admin').style.display='block'; }));

/* admin search */
$('adminSearch').addEventListener('input', function(){ renderAdminTables(this.value.trim().toLowerCase()); });

/* Render admin tables */
function renderAdminTables(filter=''){
  const pendings = properties.filter(p=>p.status==='pending');
  const owners = properties.filter(p=>p.ownerType==='owner' && p.status!=='pending'); // owner's approved
  const adminProps = properties.filter(p=>p.ownerType==='admin');

  // counts
  $('adminTotal').textContent = 'Ø¥Ø¬Ù…Ø§Ù„ÙŠ: ' + properties.length;
  $('adminApproved').textContent = properties.filter(p=>p.status==='approved').length;
  $('adminPending').textContent = pendings.length;

  // pending table
  const pendingTbody = document.querySelector('#pendingTable tbody'); pendingTbody.innerHTML = '';
  pendings.filter(p=> matchesFilter(p, filter)).forEach(p=>{
    const tr = el('tr');
    tr.appendChild(el('td',{},p.id));
    tr.appendChild(el('td',{},p.title));
    tr.appendChild(el('td',{},p.category));
    tr.appendChild(el('td',{},formatNumber(p.price) + ' Ø±.Ø³'));
    tr.appendChild(el('td',{}, p.ownerPhone));
    const actionsTd = el('td'); actionsTd.className='admin-actions';
    const btnApprove = el('button',{class:'btn btn-primary'}, 'Ù…ÙˆØ§ÙÙ‚Ø©'); btnApprove.onclick = ()=> { approveProperty(p.id); };
    const btnReject = el('button',{class:'btn btn-ghost'}, 'Ø±ÙØ¶'); btnReject.onclick = ()=> { if(confirm('Ø±ÙØ¶ ÙˆØ­Ø°Ù Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†ØŸ')) deletePropertyById(p.id); };
    const btnEdit = el('button',{class:'btn btn-ghost'}, 'ØªØ¹Ø¯ÙŠÙ„'); btnEdit.onclick = ()=> openEdit(p.id);
    const btnView = el('button',{class:'btn btn-ghost'}, 'Ø¹Ø±Ø¶'); btnView.onclick = ()=> openDetail(p.id);
    actionsTd.appendChild(btnApprove); actionsTd.appendChild(btnReject); actionsTd.appendChild(btnEdit); actionsTd.appendChild(btnView);
    tr.appendChild(actionsTd); pendingTbody.appendChild(tr);
  });

  // owners table
  const ownersTbody = document.querySelector('#ownersTable tbody'); ownersTbody.innerHTML = '';
  owners.filter(p=> matchesFilter(p, filter)).forEach(p=>{
    const tr = el('tr');
    tr.appendChild(el('td',{},p.id)); tr.appendChild(el('td',{},p.title)); tr.appendChild(el('td',{},p.category));
    tr.appendChild(el('td',{},formatNumber(p.price)+' Ø±.Ø³')); tr.appendChild(el('td',{},p.ownerPhone));
    const actionsTd = el('td'); actionsTd.className='admin-actions';
    const btnToggle = el('button',{class:'btn btn-primary'}, p.status==='approved'?'ØªØ¹Ø·ÙŠÙ„':'ØªÙØ¹ÙŠÙ„'); btnToggle.onclick = ()=> { p.status = (p.status==='approved'?'pending':'approved'); persist(); renderAll(); renderAdminTables(); };
    const btnEdit = el('button',{class:'btn btn-ghost'}, 'ØªØ¹Ø¯ÙŠÙ„'); btnEdit.onclick = ()=> openEdit(p.id);
    const btnDelete = el('button',{class:'btn btn-ghost'}, 'Ø­Ø°Ù'); btnDelete.onclick = ()=> { if(confirm('Ø­Ø°Ù Ù†Ù‡Ø§Ø¦ÙŠØŸ')) deletePropertyById(p.id); };
    actionsTd.appendChild(btnToggle); actionsTd.appendChild(btnEdit); actionsTd.appendChild(btnDelete);
    tr.appendChild(actionsTd); ownersTbody.appendChild(tr);
  });

  // admin table
  const adminTbody = document.querySelector('#adminTable tbody'); adminTbody.innerHTML = '';
  adminProps.filter(p=> matchesFilter(p, filter)).forEach(p=>{
    const tr = el('tr'); tr.appendChild(el('td',{},p.id)); tr.appendChild(el('td',{},p.title)); tr.appendChild(el('td',{},p.category)); tr.appendChild(el('td',{},formatNumber(p.price)+' Ø±.Ø³')); tr.appendChild(el('td',{},p.status));
    const td=el('td'); td.className='admin-actions';
    const btnEdit = el('button',{class:'btn btn-ghost'}, 'ØªØ¹Ø¯ÙŠÙ„'); btnEdit.onclick = ()=> openEdit(p.id);
    const btnDelete = el('button',{class:'btn btn-ghost'}, 'Ø­Ø°Ù'); btnDelete.onclick = ()=> { if(confirm('Ø­Ø°ÙØŸ')) deletePropertyById(p.id); };
    td.appendChild(btnEdit); td.appendChild(btnDelete); tr.appendChild(td); adminTbody.appendChild(tr);
  });
}

/* filter helper */
function matchesFilter(p, q){ if(!q) return true; return (p.title||'').toLowerCase().includes(q) || (p.location||'').toLowerCase().includes(q) || String(p.id)===q || (p.ownerPhone||'').includes(q); }

/* Approve / delete / edit actions */
function approveProperty(id){ const p = properties.find(x=>x.id==id); if(!p) return; p.status='approved'; persist(); renderAll(); renderAdminTables(); alert('ØªÙ…Øª Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø© ÙˆÙ†Ø´Ø± Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†.'); }
function deletePropertyById(id){ properties = properties.filter(x=>x.id!=id); persist(); renderAll(); renderAdminTables(); alert('ØªÙ… Ø§Ù„Ø­Ø°Ù.'); }
function openEdit(id){ const p = properties.find(x=>x.id==id); if(!p) return; $('editId').value = p.id; $('editTitle').value = p.title; $('editCategory').value = p.category; $('editPrice').value = p.price; $('editArea').value = p.area; $('editLocation').value = p.location; $('editOwnerPhone').value = p.ownerPhone; $('editDeed').value = p.deed; $('editDesc').value = p.desc; if(p.deed==='Ù†Ø¹Ù…') $('editBankWrapper').style.display='block'; else $('editBankWrapper').style.display='none'; $('editBank').value = p.bank || 'Ù„Ø§'; $('editModal').classList.add('show'); $('editModal').setAttribute('aria-hidden','false'); }
function closeEdit(){ $('editModal').classList.remove('show'); $('editModal').setAttribute('aria-hidden','true'); }
function onSubmitEdit(e){ e.preventDefault(); const id = Number($('editId').value); const p = properties.find(x=>x.id==id); if(!p) return; p.title = $('editTitle').value.trim(); p.category = $('editCategory').value; p.price = Number($('editPrice').value); p.area = Number($('editArea').value); p.location = $('editLocation').value.trim(); p.ownerPhone = $('editOwnerPhone').value.trim(); p.deed = $('editDeed').value; p.bank = $('editBank').value || 'Ù„Ø§'; p.desc = $('editDesc').value.trim(); persist(); closeEdit(); renderAll(); renderAdminTables(); alert('ØªÙ… Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª.'); }

/* Admin: create property as admin */
function adminCreateProperty(){
  // open add modal but mark created by admin
  openAdd();
  // once submit, change ownerType to admin inside onSubmitAdd flow by setting a flag
  adminCreateFlag = true;
}
let adminCreateFlag = false;
/* modify onSubmitAdd to support adminCreateFlag */
const originalOnSubmitAdd = onSubmitAdd;
onSubmitAdd = function(e){
  // reuse original validation code but set ownerType based on flag
  e.preventDefault();
  if(selectedImages.length < 1){ alert('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø±ÙØ¹ ØµÙˆØ±Ø© ÙˆØ§Ø­Ø¯Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„ (Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© Ø£ÙˆÙ„Ø§Ù‹).'); return; }
  if(selectedImages.length > 3){ alert('Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ 3 ØµÙˆØ±.'); return; }
  const title = $('inputTitle').value.trim(); const category = $('inputCategory').value; const price = Number($('inputPrice').value);
  const area = Number($('inputArea').value); const location = $('inputLocation').value.trim(); const ownerPhone = $('inputOwnerPhone').value.trim();
  const deed = $('inputDeed').value; const bank = $('inputBank').value || 'Ù„Ø§'; const desc = $('inputDesc').value.trim();
  if(!title || !category || !price || !location || !ownerPhone){ alert('Ø§Ù„Ø±Ø¬Ø§Ø¡ ØªØ¹Ø¨Ø¦Ø© Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©.'); return; }
  const prop = { id: nextId++, title, category, price, area, location, ownerPhone, deed, bank, desc, images: selectedImages.slice(0,3), status:'pending', ownerType: adminCreateFlag ? 'admin' : 'owner', createdAt:Date.now() };
  properties.push(prop); persist();
  adminCreateFlag = false;
  closeAdd(); alert('ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¹Ù‚Ø§Ø± Ù„Ø§Ù†ØªØ¸Ø§Ø± Ù…ÙˆØ§ÙÙ‚Ø© Ø§Ù„Ù…Ø¯ÙŠØ±.');
  renderAll(); if(isAdminLogged()) renderAdminTables();
};

/* ========== Ù„ÙˆØ­Ø© ØªØ¹Ø¯ÙŠÙ„ Ø§Ø³Ù… Ø§Ù„Ù…ÙˆÙ‚Ø¹ (Ù…Ø¯ÙŠØ± ÙÙ‚Ø·) ========== */
$('btnSiteEdit').addEventListener('click', ()=> {
  const newName = prompt('Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø¬Ø¯ÙŠØ¯', $('siteNameDisplay').textContent);
  if(newName && newName.trim()!==''){ $('siteNameDisplay').textContent = newName.trim(); $('logoText').textContent = newName.trim().split(' ').map(s=>s[0]).slice(0,3).join(''); }
});

/* ========== Ø¨Ø­Ø« ÙˆÙÙ„ØªØ±Ø© ÙˆØªÙ‡ÙŠØ¦Ø© Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© ========== */
document.querySelectorAll('.category-pill').forEach(p=> p.addEventListener('click', function(){ document.querySelectorAll('.category-pill').forEach(x=>x.classList.remove('active')); this.classList.add('active'); renderAll(); }));
let debounceTimer = null; $('globalSearch').addEventListener('input', function(){ clearTimeout(debounceTimer); debounceTimer = setTimeout(()=> renderAll(), 250); });
$('sortSelect').addEventListener('change', renderAll);

/* Close modals on overlay click */
document.querySelectorAll('.modal').forEach(mod=>{ mod.addEventListener('click', function(e){ if(e.target===this){ this.classList.remove('show'); this.setAttribute('aria-hidden','true'); if(this.id==='addModal'){ this.classList.remove('fullscreen'); adminCreateFlag=false; } } }); });
document.addEventListener('keydown', function(e){ if(e.key === 'Escape') document.querySelectorAll('.modal.show').forEach(m=>{ m.classList.remove('show'); m.setAttribute('aria-hidden','true'); m.classList.remove('fullscreen'); adminCreateFlag=false; }); });

/* placeholder image */
function placeholderImage(){ return 'data:image/svg+xml;utf8,' + encodeURIComponent(`<svg xmlns='http://www.w3.org/2000/svg' width='1400' height='800'><rect width='100%' height='100%' fill='#e9f0f5'/><text x='50%' y='50%' font-size='28' text-anchor='middle' fill='#9bb3c9' font-family='Arial' dy='.3em'>Ù„Ø§ ØªÙˆØ¬Ø¯ ØµÙˆØ±Ø©</text></svg>`); }

/* ========================
   Initial render
   ======================== */
function renderAll(){ const active = document.querySelector('.category-pill.active'); const cat = active ? active.getAttribute('data-cat') : 'all'; const q = $('globalSearch').value || ''; const sort = $('sortSelect').value || 'recent'; renderGrid(cat, q, sort); if(isAdminLogged()) openAdmin(); else { $('btnSiteEdit').style.display='none'; } }
renderAll();

/* If already logged as admin on reload, open admin view */
if(isAdminLogged()){ openAdmin(); }

/* adminSearch binding (dynamic as user types) */
$('adminSearch').addEventListener('input', function(){ renderAdminTables(this.value.trim().toLowerCase()); });

</script>

</body>
</html>
