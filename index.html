<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Ø§Ù„Ù†Ø®Ø¨Ø© Ø§Ù„Ø¹Ù‚Ø§Ø±ÙŠØ© â€” Ù…Ù†ØµØ© Ø§Ø­ØªØ±Ø§ÙÙŠØ©</title>
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;800&display=swap" rel="stylesheet">
<style>
  /* ========== Base & Reset ========== */
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0;
    font-family:"Cairo",sans-serif;
    background: linear-gradient(180deg,#f3f7fb 0%,#eef6fb 100%);
    color:#072026;
    -webkit-font-smoothing:antialiased;
    -moz-osx-font-smoothing:grayscale;
    direction:rtl;
  }
  a{color:inherit;text-decoration:none}
  button{cursor:pointer;font-weight:700}
  input,textarea,select{font-family:inherit}

  /* ========== Topbar ========== */
  .topbar{
    position:sticky;top:0;z-index:1000;
    display:flex;align-items:center;gap:12px;padding:12px 22px;
    background:linear-gradient(90deg,#0b6f6f,#0f4c5c);
    color:#fff;box-shadow:0 8px 30px rgba(6,20,24,.12)
  }
  .brand{display:flex;align-items:center;gap:12px;margin-right:auto}
  .logo{
    width:56px;height:56px;border-radius:12px;display:flex;align-items:center;justify-content:center;
    color:#072026;font-weight:900;background:linear-gradient(135deg,#ffd166,#ef476f);
    box-shadow:0 8px 20px rgba(0,0,0,.12);
    font-size:18px
  }
  .site-title{font-weight:800;font-size:1.15rem}
  .site-sub{font-size:0.82rem;opacity:.92}

  .search-wrap{display:flex;align-items:center;background:rgba(255,255,255,0.08);padding:7px 10px;border-radius:10px;min-width:300px}
  .search-wrap input{background:transparent;border:none;outline:none;color:#fff;width:230px}

  .top-actions{display:flex;gap:8px;align-items:center}
  .btn{border:none;padding:9px 14px;border-radius:10px;background:rgba(255,255,255,0.08);color:#fff;transition:all .14s}
  .btn:hover{transform:translateY(-3px);background:rgba(255,255,255,0.11)}
  .btn-primary{background:linear-gradient(90deg,#ff8a65,#ffb86b);color:#072}
  .btn-ghost{background:transparent;border:1px solid rgba(255,255,255,0.08)}

  /* ========== Container ========== */
  .container{max-width:1240px;margin:26px auto;padding:0 16px}

  /* ========== Hero ========== */
  .hero{
    display:flex;gap:20px;align-items:center;justify-content:space-between;
    background:#fff;border-radius:14px;padding:18px;box-shadow:0 12px 30px rgba(12,28,36,.06)
  }
  .hero-left h1{margin:0;font-size:1.5rem;color:#042;font-weight:900}
  .hero-left p{margin:6px 0 12px;color:#546}

  /* ========== Categories (refined modern tiles) ========== */
  .categories-wrap{display:flex;gap:12px;flex-wrap:wrap;margin:18px 0;align-items:center}
  .cat-tile{
    display:flex;align-items:center;gap:12px;padding:14px;border-radius:12px;background:linear-gradient(180deg,#fff,#f8fbff);
    min-width:180px;border:2px solid rgba(6,20,24,0.04);box-shadow:0 10px 26px rgba(8,20,28,0.04);
    cursor:pointer;transition:transform .14s,box-shadow .14s,border-color .14s;
  }
  .cat-tile:hover{transform:translateY(-6px);box-shadow:0 24px 50px rgba(8,20,28,0.06)}
  .cat-tile.active{border-color:#ffb36b;box-shadow:0 26px 56px rgba(255,179,107,0.12)}
  .cat-icon{width:56px;height:56px;border-radius:10px;display:flex;align-items:center;justify-content:center;color:#fff;font-size:22px}
  .cat-text{display:flex;flex-direction:column;align-items:flex-start}
  .cat-title{font-weight:900;font-size:1rem}
  .cat-sub{font-size:.82rem;color:#556}

  /* ========== Controls ========== */
  .controls{display:flex;gap:12px;align-items:center;margin:10px 0}
  .controls .stat{font-weight:900;color:#234}

  /* ========== Cards grid ========== */
  .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:18px}
  .prop-card{
    background:linear-gradient(180deg,#fff,#fbfeff);border-radius:14px;overflow:hidden;border:1px solid rgba(6,20,24,0.04);
    box-shadow:0 12px 34px rgba(12,28,36,0.06);transition:transform .18s,box-shadow .18s;
    display:flex;flex-direction:column;height:100%;
  }
  .prop-card:hover{transform:translateY(-8px);box-shadow:0 26px 60px rgba(12,28,36,0.12)}
  .prop-media{height:200px;overflow:hidden;position:relative}
  .prop-media img{width:100%;height:100%;object-fit:cover;display:block;transition:transform .6s}
  .prop-card:hover .prop-media img{transform:scale(1.06)}
  .prop-body{padding:14px;flex:1;display:flex;flex-direction:column}
  .prop-title{font-weight:900;color:#043;margin:0 0 6px;font-size:1.02rem}
  .prop-short{color:#556;font-size:.95rem;margin-bottom:8px;min-height:40px}
  .prop-meta{display:flex;justify-content:space-between;align-items:center;margin-top:auto}
  .price{color:#ff6b6b;font-weight:900}
  .meta-right{display:flex;gap:8px;align-items:center}
  .chip{padding:6px 10px;border-radius:999px;font-weight:900;font-size:.82rem;border:1px solid rgba(6,20,24,0.04);background:linear-gradient(180deg,#fff,#f6fafc)}

  /* package ribbon style (small top-left) */
  .package-badge{position:absolute;left:12px;top:12px;padding:8px 10px;border-radius:10px;color:#fff;font-weight:900}
  .pkg-basic{background:linear-gradient(90deg,#9fb8ff,#7ec6ff)}
  .pkg-featured{background:linear-gradient(90deg,#ffd166,#ff8a65)}
  .pkg-premium{background:linear-gradient(90deg,#b388ff,#7e57c2)}

  /* quick actions area inside card */
  .card-actions{display:flex;gap:8px;margin-top:12px}
  .btn-small{padding:8px 12px;border-radius:10px;border:none;font-weight:900}
  .btn-view{background:linear-gradient(90deg,#e6f7ff,#dff3ff);color:#072}
  .btn-ws{background:linear-gradient(90deg,#25d366,#128c7e);color:#fff}

  /* ========== Floating WhatsApp quick contact ========== */
  .whatsapp-fab{
    position:fixed;bottom:18px;left:18px;z-index:2000;
    display:flex;flex-direction:column;gap:8px;align-items:flex-end;
  }
  .whatsapp-fab .fab{
    width:56px;height:56px;border-radius:14px;background:linear-gradient(90deg,#25d366,#06a86b);display:flex;align-items:center;justify-content:center;color:#fff;font-weight:900;box-shadow:0 14px 36px rgba(2,120,80,0.14)
  }
  .ws-menu{display:none;background:#fff;padding:10px;border-radius:10px;box-shadow:0 8px 30px rgba(8,20,24,0.12);min-width:220px}
  .whatsapp-fab:hover .ws-menu{display:block}

  /* ========== Detail page ========== */
  .detail-wrap{display:grid;grid-template-columns:1fr 420px;gap:18px;margin-top:18px}
  .detail-gallery{background:#fff;padding:12px;border-radius:12px;border:1px solid rgba(6,20,24,0.04);box-shadow:0 10px 30px rgba(12,28,36,0.06)}
  .detail-main{height:460px;border-radius:10px;overflow:hidden;background:#eef6fb;display:flex;align-items:center;justify-content:center}
  .detail-main img{width:100%;height:100%;object-fit:cover}
  .thumbs{display:flex;gap:10px;margin-top:12px;flex-wrap:wrap}
  .thumbs img{width:120px;height:84px;object-fit:cover;border-radius:8px;border:2px solid transparent;cursor:pointer}
  .thumbs img.active{border-color:#ffb36b}

  .detail-info{background:#fff;padding:16px;border-radius:12px;border:1px solid rgba(6,20,24,0.04);box-shadow:0 10px 30px rgba(12,28,36,0.06)}
  .detail-info h2{margin:0 0 6px;font-weight:900;color:#043}
  .detail-info .label{font-weight:900;color:#234;margin-bottom:6px;display:block}
  .detail-box{padding:12px;border-radius:8px;background:linear-gradient(180deg,#fff,#fbfeff);border:1px solid rgba(8,20,28,0.03)}

  /* ========== Admin page (full screen) ========== */
  #adminPanel{
    position:fixed;inset:0;z-index:1500;background:linear-gradient(180deg,#f6fafc,#eef6fb);display:none;padding:28px;overflow:auto
  }
  .admin-shell{max-width:1200px;margin:0 auto;background:#fff;border-radius:12px;padding:18px;box-shadow:0 14px 44px rgba(12,28,36,0.12)}
  .admin-head{display:flex;justify-content:space-between;align-items:center;gap:12px}
  .admin-stats{display:flex;gap:12px;align-items:center}
  .stat-card{padding:12px;border-radius:10px;background:linear-gradient(180deg,#fff,#fbfeff);border:1px solid rgba(8,20,28,0.03);min-width:140px;text-align:center}
  .admin-controls{display:flex;gap:8px;align-items:center}

  .admin-tables{margin-top:14px}
  .admin-table{width:100%;border-collapse:collapse}
  .admin-table th,.admin-table td{padding:10px;border-bottom:1px solid #f2f6f8;text-align:right}
  .admin-actions button{margin-left:6px}

  /* small screens */
  @media(max-width:980px){
    .detail-wrap,.hero{flex-direction:column}
    .detail-wrap{grid-template-columns:1fr}
    .grid{grid-template-columns:repeat(auto-fill,minmax(220px,1fr))}
    .search-wrap input{width:140px}
    .categories-wrap{overflow:auto;padding-bottom:8px}
  }
</style>
</head>
<body>

<!-- Topbar -->
<header class="topbar">
  <div class="brand">
    <div class="logo" id="logoText">Ù†Ø®</div>
    <div>
      <div class="site-title" id="siteName">Ø§Ù„Ù†Ø®Ø¨Ø© Ø§Ù„Ø¹Ù‚Ø§Ø±ÙŠØ©</div>
      <div class="site-sub">Ù…Ù†ØµØ© Ù…ØªØ·ÙˆØ±Ø© Ù„Ø¥Ø¯Ø§Ø±Ø© ÙˆØ¹Ø±Ø¶ Ø§Ù„Ø¹Ù‚Ø§Ø±Ø§Øª</div>
    </div>
  </div>

  <div class="search-wrap" title="Ø¨Ø­Ø« Ø³Ø±ÙŠØ¹">
    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" style="margin-left:8px">
      <path d="M21 21l-4.35-4.35" stroke="white" stroke-width="1.6" stroke-linecap="round"/>
      <circle cx="11" cy="11" r="6" stroke="white" stroke-width="1.6"/>
    </svg>
    <input id="globalSearch" placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† Ø¹Ù†ÙˆØ§Ù†ØŒ Ù…ÙˆÙ‚Ø¹ØŒ ÙˆØµÙ Ø£Ùˆ ÙƒÙ„Ù…Ø§Øª (EN tags)..." />
  </div>

  <div class="top-actions">
    <button class="btn" onclick="goHome()">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button>
    <button class="btn" id="btnAdd" onclick="openAddPage()">Ø¥Ø¶Ø§ÙØ© Ø¹Ù‚Ø§Ø±</button>
    <button class="btn" id="btnLogin" onclick="showLogin()">Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…Ø¯ÙŠØ±</button>
    <button class="btn" id="btnSiteEdit" style="display:none" onclick="editSiteName()">ØªØ¹Ø¯ÙŠÙ„ Ø§Ø³Ù… Ø§Ù„Ù…ÙˆÙ‚Ø¹</button>
  </div>
</header>

<!-- Main -->
<main class="container" id="mainArea">
  <!-- Hero -->
  <section class="hero">
    <div class="hero-left">
      <h1>Ø§Ù„Ù†Ø®Ø¨Ø© Ø§Ù„Ø¹Ù‚Ø§Ø±ÙŠØ© â€” Ø§Ø¨Ø­Ø«ØŒ Ø£Ø¶ÙØŒ ÙˆØ§Ø¯Ù…Ø¬ Ø¨Ø³Ù‡ÙˆÙ„Ø©</h1>
      <p>ÙˆØ§Ø¬Ù‡Ø© Ø­Ø¯ÙŠØ«Ø©ØŒ Ù†Ø¸Ø§Ù… Ù…ÙˆØ§ÙÙ‚Ø§Øª Ù„Ù„Ù…Ø¯ÙŠØ±ØŒ ØªÙˆØ§ØµÙ„ Ø³Ø±ÙŠØ¹ Ø¹Ø¨Ø± ÙˆØ§ØªØ³Ø§Ø¨ØŒ ÙˆØªØµÙ…ÙŠÙ… Ù…Ø±Ø¦ÙŠ ÙŠØ¬Ø°Ø¨ Ø§Ù„Ø²Ø¨Ø§Ø¦Ù†.</p>
      <div style="display:flex;gap:12px;flex-wrap:wrap;margin-top:12px">
        <div class="chip">Ø³Ù‡Ù„ Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…</div>
        <div class="chip">Ù…ÙˆØ§ÙÙ‚Ø§Øª Ø§Ù„Ù…Ø¯ÙŠØ±</div>
        <div class="chip">ØªÙˆØ§ØµÙ„ Ø¹Ø¨Ø± ÙˆØ§ØªØ³Ø§Ø¨</div>
        <div class="chip">Ù‚Ø§Ø¨Ù„ Ù„Ù„ØªØ·ÙˆÙŠØ± (Firebase)</div>
      </div>
    </div>
    <div class="hero-right">
      <img src="https://images.unsplash.com/photo-1560448204-e02f11c3d0e2?q=80&w=900&auto=format&fit=crop" style="width:360px;height:180px;object-fit:cover;border-radius:12px;box-shadow:0 10px 28px rgba(12,28,36,.08)" alt="">
    </div>
  </section>

  <!-- Categories -->
  <div class="categories-wrap" id="categories"></div>

  <!-- Controls -->
  <div class="controls">
    <div class="stat">Ø§Ù„Ø¹Ù‚Ø§Ø±Ø§Øª Ø§Ù„Ù…Ø¹Ø±ÙˆØ¶Ø©: <span id="countShown">0</span></div>
    <div style="margin-left:auto;display:flex;gap:8px;align-items:center">
      <select id="sort" style="padding:8px;border-radius:10px;border:1px solid #e6eef3">
        <option value="recent">Ø§Ù„Ø£Ø­Ø¯Ø«</option>
        <option value="price-asc">Ø§Ù„Ø³Ø¹Ø±: Ù…Ù† Ø§Ù„Ø£Ù‚Ù„</option>
        <option value="price-desc">Ø§Ù„Ø³Ø¹Ø±: Ù…Ù† Ø§Ù„Ø£Ø¹Ù„Ù‰</option>
      </select>
      <button class="btn" onclick="clearFilters()">Ø¥Ø¹Ø§Ø¯Ø©</button>
    </div>
  </div>

  <!-- Properties grid -->
  <section class="grid" id="gridProperties" aria-live="polite"></section>

  <footer style="text-align:center;margin-top:28px;color:#667">
    Â© 2025 Ø§Ù„Ù†Ø®Ø¨Ø© Ø§Ù„Ø¹Ù‚Ø§Ø±ÙŠØ© â€” Ø¬Ø§Ù‡Ø² Ù„Ù„Ø±Ø¨Ø· Ù…Ø¹ Firebase Ø£Ùˆ Ø£ÙŠ Ù†Ø¸Ø§Ù… Ø®Ø§Ø±Ø¬ÙŠ.
  </footer>
</main>

<!-- Detail Page (ØµÙØ­Ø© Ù…Ù†ÙØµÙ„Ø© Ø¯Ø§Ø®Ù„ Ù†ÙØ³ Ø§Ù„Ù…Ù„Ù) -->
<section id="detailPage" style="display:none;padding:28px" aria-hidden="true">
  <div class="container">
    <div style="display:flex;justify-content:space-between;align-items:center">
      <div>
        <button class="btn" onclick="goHome()">Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button>
      </div>
      <div style="text-align:left"><span class="chip">Ø¹Ø±Ø¶ ØªÙØµÙŠÙ„ÙŠ</span></div>
    </div>

    <div class="detail-wrap" id="detailWrap">
      <div class="detail-gallery">
        <div class="detail-main" id="detailMain"><img src="" alt="ØµÙˆØ±Ø©"></div>
        <div class="thumbs" id="detailThumbs"></div>
      </div>
      <div class="detail-info">
        <h2 id="detailTitle">Ø¹Ù†ÙˆØ§Ù†</h2>
        <div class="detail-box"><span class="label">Ø§Ù„Ù…ÙˆÙ‚Ø¹</span><div id="detailLocation">-</div></div>
        <div class="detail-box"><span class="label">Ø§Ù„Ø³Ø¹Ø± ÙˆØ§Ù„Ù…Ø³Ø§Ø­Ø©</span><div style="display:flex;justify-content:space-between"><div id="detailPrice">0 Ø±.Ø³</div><div id="detailArea">- Ù…Â²</div></div></div>
        <div class="detail-box"><span class="label">Ø­Ø§Ù„Ø© Ø§Ù„ØµÙƒ / Ø§Ù„Ø¨Ù†Ùƒ</span><div id="detailDeed">-</div></div>
        <div class="detail-box"><span class="label">Ø§Ù„Ø¨Ø§Ù‚Ø©</span><div id="detailPackage">-</div></div>
        <div class="detail-box"><span class="label">Ø§Ù„ÙƒÙ„Ù…Ø§Øª (EN Tags)</span><div id="detailTags" style="display:flex;gap:8px;flex-wrap:wrap"></div></div>
        <div class="detail-box"><span class="label">Ø§Ù„ÙˆØµÙ</span><div id="detailDesc" style="white-space:pre-line"></div></div>

        <div style="display:flex;gap:8px;margin-top:10px">
          <a id="detailWhats" class="btn btn-primary" target="_blank">Ù…Ø±Ø§Ø³Ù„Ø© Ø¹Ø¨Ø± ÙˆØ§ØªØ³Ø§Ø¨</a>
          <button class="btn btn-ghost" onclick="goHome()">Ø§Ù„Ø¹ÙˆØ¯Ø©</button>
        </div>

        <div style="margin-top:10px;color:#667">Ù…Ù„Ø§Ø­Ø¸Ø©: Ø£Ø±Ù‚Ø§Ù… Ø§Ù„Ù…Ù„Ø§Ùƒ ØªØ¸Ù‡Ø± Ø¯Ø§Ø®Ù„ Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø¯ÙŠØ± ÙÙ‚Ø· Ø¨Ø¹Ø¯ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„.</div>
      </div>
    </div>
  </div>
</section>

<!-- Add Page -->
<section id="addPage" style="display:none;padding:28px" aria-hidden="true">
  <div class="container">
    <div style="display:flex;justify-content:space-between;align-items:center">
      <div><button class="btn" onclick="goHome()">Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button></div>
      <div><span class="chip">Ù†Ù…ÙˆØ°Ø¬ Ø¥Ø¶Ø§ÙØ© Ø¹Ù‚Ø§Ø± Ø§Ø­ØªØ±Ø§ÙÙŠ</span></div>
    </div>

    <div style="margin-top:14px;display:grid;grid-template-columns:1fr 360px;gap:16px">
      <div style="background:#fff;padding:16px;border-radius:12px;border:1px solid rgba(6,20,24,.04)">
        <form id="formAdd" onsubmit="submitAdd(event)">
          <div style="display:grid;gap:10px">
            <label>Ø§Ù„ØµÙˆØ± (1-3 â€” Ø§Ù„Ø£ÙˆÙ„Ù‰ ÙˆØ§Ø¬Ù‡Ø©)</label>
            <input type="file" id="addImgs" accept="image/*" multiple />
            <div id="previewAdd" style="display:flex;gap:8px;margin-top:8px;flex-wrap:wrap"></div>

            <label>Ø§Ù„Ø¨Ø§Ù‚Ø©</label>
            <select id="inputPackage">
              <option value="basic">Basic</option>
              <option value="featured">Featured</option>
              <option value="premium">Premium</option>
            </select>

            <label>Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø¹Ø±Ø¶</label>
            <input id="inputTitle" required/>

            <label>Ø§Ù„Ù‚Ø³Ù…</label>
            <select id="inputCategory" required>
              <option>ÙÙ„Ù„</option><option>Ø´Ù‚Ù‚</option><option>Ø¹Ù…Ø§Ø¦Ø±</option><option>Ø£Ø±Ø§Ø¶ÙŠ</option><option>Ø§Ø³ØªØ±Ø§Ø­Ø§Øª</option><option>Ø£Ø¯ÙˆØ§Ø± Ù…Ø³ØªÙ‚Ù„Ø©</option>
            </select>

            <label>Ø§Ù„Ø³Ø¹Ø± (Ø¨Ø§Ù„Ø£Ø±Ù‚Ø§Ù… Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©)</label>
            <input id="inputPrice" pattern="[0-9]*" inputmode="numeric" required/>

            <label>Ø§Ù„Ù…Ø³Ø§Ø­Ø© (Ù…Â²)</label>
            <input id="inputArea" pattern="[0-9]*" inputmode="numeric"/>

            <label>Ø§Ù„Ù…ÙˆÙ‚Ø¹ (Ù†ØµÙŠÙ‹Ø§)</label>
            <input id="inputLocation" required/>

            <label>Ø±Ù‚Ù… Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨ Ù„Ù„Ù…Ø§Ù„Ùƒ (Ù…Ø«Ø§Ù„: 0551234567)</label>
            <input id="inputOwnerPhone" required/>

            <label>Ù‡Ù„ Ø§Ù„Ø¹Ù‚Ø§Ø± Ø¨ØµÙƒØŸ</label>
            <select id="inputDeed"><option>Ù„Ø§</option><option>Ù†Ø¹Ù…</option></select>

            <div id="bankRow" style="display:none">
              <label>Ù‡Ù„ ÙŠÙ‚Ø¨Ù„ Ø§Ù„Ø¨Ù†ÙƒØŸ</label>
              <select id="inputBank"><option>Ù„Ø§</option><option>Ù†Ø¹Ù…</option></select>
            </div>

            <label>ÙƒÙ„Ù…Ø§Øª Ù…ÙØªØ§Ø­ÙŠØ© Ø¨Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ© (English tags â€” Ù…ÙØµÙˆÙ„Ø© Ø¨ÙÙˆØ§ØµÙ„)</label>
            <input id="inputTags" placeholder="villa, pool, luxury"/>

            <label>ÙˆØµÙ ÙƒØ§Ù…Ù„</label>
            <textarea id="inputDesc"></textarea>

            <div style="display:flex;gap:8px;margin-top:8px">
              <button class="btn btn-primary" type="submit">Ù†Ø´Ø± ÙˆØ§Ù†ØªØ¸Ø§Ø± Ù…ÙˆØ§ÙÙ‚Ø© Ø§Ù„Ù…Ø¯ÙŠØ±</button>
              <button type="button" class="btn btn-ghost" onclick="goHome()">Ø¥Ù„ØºØ§Ø¡</button>
            </div>
          </div>
        </form>
      </div>

      <aside style="background:linear-gradient(180deg,#fff,#fbfeff);padding:16px;border-radius:12px;border:1px solid rgba(6,20,24,.03)">
        <h4>Ù†ØµØ§Ø¦Ø­ Ù„ØªØ­Ø³ÙŠÙ† Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†</h4>
        <ul style="color:#556">
          <li>Ø¶Ø¹ ØµÙˆØ±Ø© ÙˆØ§Ø¬Ù‡Ø© ÙˆØ§Ø¶Ø­Ø© ÙƒØ£ÙˆÙ„ ØµÙˆØ±Ø©.</li>
          <li>Ø§Ø®ØªØ± Ø¨Ø§Ù‚Ø© Featured Ø£Ùˆ Premium Ù„Ø¸Ù‡ÙˆØ± Ø£Ù‚ÙˆÙ‰.</li>
          <li>Ø§ÙƒØªØ¨ ÙƒÙ„Ù…Ø§Øª Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ© Ø¯Ù‚ÙŠÙ‚Ø© (tags) Ù„Ø³Ù‡ÙˆÙ„Ø© Ø§Ù„Ø¨Ø­Ø«.</li>
        </ul>

        <hr/>

        <h4>Ø§Ù„Ù…Ø¯ÙŠØ±</h4>
        <p style="color:#556">Ø¹Ù†Ø¯ Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø© Ø³ÙŠÙÙ†Ø´ÙØ± Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†. ÙŠÙ…ÙƒÙ† Ù„Ù„Ù…Ø¯ÙŠØ± ØªØ¹Ø¯ÙŠÙ„ Ø£Ùˆ Ø­Ø°Ù Ø£Ùˆ Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø§Ù„Ù…Ø§Ù„Ùƒ Ø¯Ø§Ø®Ù„ Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©.</p>
      </aside>
    </div>
  </div>
</section>

<!-- Admin Panel -->
<section id="adminPanel">
  <div class="admin-shell">
    <div class="admin-head">
      <div>
        <h2 style="margin:0">Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø¯ÙŠØ± â€” Ø§Ù„Ù†Ø®Ø¨Ø© Ø§Ù„Ø¹Ù‚Ø§Ø±ÙŠØ©</h2>
        <div style="color:#667;margin-top:6px">Ù…Ø³Ø§Ø­Ø© Ø®Ø§ØµØ© Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¹Ù‚Ø§Ø±Ø§ØªØŒ Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø§ØªØŒ ÙˆØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø§Ù„Ù…Ù„Ø§Ùƒ.</div>
      </div>
      <div class="admin-stats">
        <div class="stat-card" id="statTotal"><div style="font-size:18px;font-weight:900">0</div><div style="color:#667">Ø¥Ø¬Ù…Ø§Ù„ÙŠ</div></div>
        <div class="stat-card" id="statPending"><div style="font-size:18px;font-weight:900">0</div><div style="color:#667">Ø¨Ø§Ù†ØªØ¸Ø§Ø±</div></div>
        <div class="stat-card" id="statApproved"><div style="font-size:18px;font-weight:900">0</div><div style="color:#667">Ù…ÙØ¹Ù„</div></div>
        <div style="margin-left:12px" class="admin-controls">
          <button class="btn btn-ghost" onclick="goHome()">Ø¹ÙˆØ¯Ø© Ù„Ù„Ù…ÙˆÙ‚Ø¹</button>
          <button class="btn btn-primary" onclick="adminAdd()">Ø£Ø¶Ù ÙƒÙ…Ø¯ÙŠØ±</button>
          <button class="btn" id="btnLogoutAdmin" onclick="adminLogout()">ØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬</button>
        </div>
      </div>
    </div>

    <div style="display:flex;gap:12px;align-items:center;margin-top:12px">
      <div class="tabs" style="display:flex;gap:8px">
        <button class="tab active" data-tab="pending" onclick="switchTab(event)">Ø¨Ø§Ù†ØªØ¸Ø§Ø±</button>
        <button class="tab" data-tab="owners" onclick="switchTab(event)">Ø¹Ù‚Ø§Ø±Ø§Øª Ø§Ù„Ù…Ù„Ø§Ùƒ</button>
        <button class="tab" data-tab="admin" onclick="switchTab(event)">Ø¹Ù‚Ø§Ø±Ø§ØªÙŠ</button>
      </div>
      <div style="margin-left:auto;display:flex;gap:8px;align-items:center">
        <input id="adminSearch" placeholder="Ø¨Ø­Ø« Ø¯Ø§Ø®Ù„ Ø§Ù„Ù„ÙˆØ­Ø© (Ø¹Ù†ÙˆØ§Ù†ØŒ Ù…ÙˆÙ‚Ø¹ØŒ Ø±Ù‚Ù…)"/>
        <button class="btn" onclick="bulkApprove()">Ù…ÙˆØ§ÙÙ‚Ø© Ø¨Ø§Ù„Ø¬Ù…Ù„Ø©</button>
        <button class="btn" onclick="exportCSV()">ØªØµØ¯ÙŠØ± CSV</button>
      </div>
    </div>

    <div class="admin-tables" id="adminTables">
      <!-- Pending -->
      <div id="tab-pending" class="admin-table-wrap" style="margin-top:12px">
        <h3>Ø§Ù„Ø¹Ù‚Ø§Ø±Ø§Øª Ø¨Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø©</h3>
        <table class="admin-table" id="tablePending">
          <thead><tr><th>#</th><th>Ø¹Ù†ÙˆØ§Ù†</th><th>Ù‚ÙØ³Ù…</th><th>Ø§Ù„Ø³Ø¹Ø±</th><th>Ù…Ø§Ù„Ùƒ</th><th>Ø¨Ø§Ù‚Ø©</th><th>Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th></tr></thead>
          <tbody></tbody>
        </table>
      </div>

      <!-- Owners -->
      <div id="tab-owners" class="admin-table-wrap" style="display:none;margin-top:12px">
        <h3>Ø¹Ù‚Ø§Ø±Ø§Øª Ø§Ù„Ù…Ù„Ø§Ùƒ</h3>
        <table class="admin-table" id="tableOwners">
          <thead><tr><th>#</th><th>Ø¹Ù†ÙˆØ§Ù†</th><th>Ù‚ÙØ³Ù…</th><th>Ø§Ù„Ø³Ø¹Ø±</th><th>Ù…Ø§Ù„Ùƒ</th><th>Ø§Ù„Ø­Ø§Ù„Ø©</th><th>Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th></tr></thead>
          <tbody></tbody>
        </table>
      </div>

      <!-- Admin -->
      <div id="tab-admin" class="admin-table-wrap" style="display:none;margin-top:12px">
        <h3>Ø¹Ù‚Ø§Ø±Ø§ØªÙŠ (Ø§Ù„Ù…Ø¯ÙŠØ±)</h3>
        <table class="admin-table" id="tableAdmin">
          <thead><tr><th>#</th><th>Ø¹Ù†ÙˆØ§Ù†</th><th>Ù‚ÙØ³Ù…</th><th>Ø§Ù„Ø³Ø¹Ø±</th><th>Ø§Ù„Ø­Ø§Ù„Ø©</th><th>Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th></tr></thead>
          <tbody></tbody>
        </table>
      </div>
    </div>

  </div>
</section>

<!-- Floating WhatsApp -->
<div class="whatsapp-fab" title="ØªÙˆØ§ØµÙ„ Ø³Ø±ÙŠØ¹">
  <div class="ws-menu">
    <div style="font-weight:900;margin-bottom:8px">ØªÙˆØ§ØµÙ„ Ø³Ø±ÙŠØ¹ Ø¹Ø¨Ø± ÙˆØ§ØªØ³Ø§Ø¨</div>
    <div style="display:flex;flex-direction:column;gap:8px">
      <button class="btn" onclick="openWhats('general')">Ø§Ø³ØªÙØ³Ø§Ø± Ø¹Ø§Ù…</button>
      <button class="btn btn-primary" onclick="openWhats('visit')">Ø£Ø±ÙŠØ¯ Ø²ÙŠØ§Ø±Ø© Ø¹Ù‚Ø§Ø±</button>
    </div>
  </div>
  <div class="fab" onclick="openWhats('general')">ğŸ’¬</div>
</div>

<!-- Login prompt (simple non-visible UI; we use prompt() to avoid showing credentials) -->
<script>
/* ==========================
   Data model + persistence
   ========================== */
const ADMIN_USERNAME = 'IVL511';
const ADMIN_PASSWORD = 'IVL511';
const ADMIN_WHATSAPP = '966535342404'; // Ù…Ø¯ÙŠØ±
const STORAGE = 'alq_v_final_v1';
const NEXTID = 'alq_nextid_v_final_v1';

let props = JSON.parse(localStorage.getItem(STORAGE) || 'null') || [];
let nextId = parseInt(localStorage.getItem(NEXTID) || '1', 10);

function persist(){
  localStorage.setItem(STORAGE, JSON.stringify(props));
  localStorage.setItem(NEXTID, String(nextId));
}

/* seed if empty */
function seedIfEmpty(){
  if(props.length) return;
  const samples = [
    { id: nextId++, title:"ÙÙŠÙ„Ø§ ÙØ§Ø®Ø±Ø© 5 ØºØ±Ù - Ø­ÙŠ Ø§Ù„Ù†Ø®ÙŠÙ„", category:"ÙÙ„Ù„", price:2500000, area:450, location:"Ø§Ù„Ø±ÙŠØ§Ø¶ - Ø§Ù„Ù†Ø®ÙŠÙ„", ownerPhone:"0551234001", deed:"Ù†Ø¹Ù…", bank:"Ù†Ø¹Ù…", desc:"ÙÙŠÙ„Ø§ ÙØ§Ø®Ø±Ø© Ø¨Ù…ÙˆØ§ØµÙØ§Øª Ù…Ù…ØªØ§Ø²Ø© ÙˆÙ…Ø³Ø¨Ø­.", images:["https://images.unsplash.com/photo-1600585154340-be6161a56a0c?q=80&w=1400&auto=format&fit=crop","https://images.unsplash.com/photo-1505691723518-36a3b7b1a5c5?q=80&w=1400&auto=format&fit=crop"], status:"approved", ownerType:"owner", package:"premium", tagsEN:["villa","pool","luxury"], createdAt:Date.now()},
    { id: nextId++, title:"Ø´Ù‚Ø© Ø±Ø§Ù‚ÙŠØ© 3 ØºØ±Ù - Ø¨Ø±Ø¬ Ø§Ù„ÙØ¬Ø±", category:"Ø´Ù‚Ù‚", price:750000, area:150, location:"Ø¬Ø¯Ø© - Ø§Ù„Ø¨Ù„Ø¯", ownerPhone:"0551234002", deed:"Ù†Ø¹Ù…", bank:"Ù†Ø¹Ù…", desc:"Ø´Ù‚Ø© Ù…Ø¹ Ø§Ø·Ù„Ø§Ù„Ø© Ø¬Ù…ÙŠÙ„Ø© ÙˆÙ…ÙˆÙ‚Ù", images:["https://images.unsplash.com/photo-1560448204-e02f11c3d0e2?q=80&w=1400&auto=format&fit=crop"], status:"approved", ownerType:"owner", package:"featured", tagsEN:["apartment","modern"], createdAt:Date.now()},
    { id: nextId++, title:"Ø§Ø³ØªØ±Ø§Ø­Ø© ÙØ§Ø®Ø±Ø© Ù…Ø¹ Ù…Ø³Ø¨Ø­", category:"Ø§Ø³ØªØ±Ø§Ø­Ø§Øª", price:950000, area:650, location:"Ø§Ù„Ø·Ø§Ø¦Ù - Ø§Ù„Ø®Ù…Ø±Ø©", ownerPhone:"0551234005", deed:"Ù†Ø¹Ù…", bank:"Ù„Ø§", desc:"Ø§Ø³ØªØ±Ø§Ø­Ø© Ù…Ø«Ø§Ù„ÙŠØ© Ù„Ù‚Ø¶Ø§Ø¡ Ø§Ù„Ø¹Ø·Ù„.", images:["https://images.unsplash.com/photo-1502672260266-1c1ef2d93688?q=80&w=1400&auto=format&fit=crop"], status:"approved", ownerType:"owner", package:"basic", tagsEN:["resort","pool"], createdAt:Date.now()},
    { id: nextId++, title:"Ø£Ø±Ø¶ Ø§Ø³ØªØ«Ù…Ø§Ø±ÙŠØ© Ù‚Ø±Ø¨ Ø§Ù„Ø·Ø±ÙŠÙ‚", category:"Ø£Ø±Ø§Ø¶ÙŠ", price:5000000, area:1800, location:"Ø¬Ø¯Ø© - Ø§Ù„ØµÙ†Ø§Ø¹ÙŠØ©", ownerPhone:"0551234004", deed:"Ù†Ø¹Ù…", bank:"Ù†Ø¹Ù…", desc:"Ø£Ø±Ø¶ Ø¨Ù…ÙˆÙ‚Ø¹ Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠ.", images:["https://images.unsplash.com/photo-1469474968028-56623f02e42e?q=80&w=1400&auto=format&fit=crop"], status:"approved", ownerType:"owner", package:"premium", tagsEN:["land","investment"], createdAt:Date.now()},
    { id: nextId++, title:"Ø¯ÙˆØ± Ù…Ø³ØªÙ‚Ù„ ÙˆØ§Ø³Ø¹ Ù„Ù„Ø¹ÙˆØ§Ø¦Ù„", category:"Ø£Ø¯ÙˆØ§Ø± Ù…Ø³ØªÙ‚Ù„Ø©", price:600000, area:300, location:"Ø§Ù„Ø¯Ù…Ø§Ù… - Ø§Ù„Ø´Ø§Ø·Ø¦", ownerPhone:"0551234006", deed:"Ù†Ø¹Ù…", bank:"Ù†Ø¹Ù…", desc:"Ø¯ÙˆØ± Ù…Ø³ØªÙ‚Ù„ Ù…Ø¹ Ø­ÙˆØ´ ÙˆØ§Ø³Ø¹.", images:["https://images.unsplash.com/photo-1475855581690-80acc9d18e0a?q=80&w=1400&auto=format&fit=crop"], status:"approved", ownerType:"owner", package:"basic", tagsEN:["floor","family"], createdAt:Date.now()},
    { id: nextId++, title:"Ø´Ù‚Ø© Ù„Ù„Ø¥ÙŠØ¬Ø§Ø± Ø¨Ø¹Ø¯ Ø§Ù„ØªØ¬Ø¯ÙŠØ¯", category:"Ø´Ù‚Ù‚", price:320000, area:95, location:"ØªØ¨ÙˆÙƒ - Ø§Ù„Ø³ÙˆÙŠÙ‚Ø©", ownerPhone:"0551234007", deed:"Ù„Ø§", bank:"Ù„Ø§", desc:"Ø´Ù‚Ø© Ø­Ø¯ÙŠØ«Ø© Ø¨Ø¹Ø¯ Ø§Ù„ØªØ¬Ø¯ÙŠØ¯", images:["https://images.unsplash.com/photo-1560449753-74f0c2b1f16a?q=80&w=1400&auto=format&fit=crop"], status:"pending", ownerType:"owner", package:"basic", tagsEN:["apartment","renovated"], createdAt:Date.now()},
    { id: nextId++, title:"Ø¹Ù…Ø§Ø±Ø© Ù„Ù„ØªØ±Ù…ÙŠÙ… - ÙØ±ØµØ©", category:"Ø¹Ù…Ø§Ø¦Ø±", price:1450000, area:520, location:"Ø§Ù„Ù…Ø¯ÙŠÙ†Ø© - Ø§Ù„ØµÙ†Ø§Ø¹ÙŠØ©", ownerPhone:"0551234008", deed:"Ù†Ø¹Ù…", bank:"Ù„Ø§", desc:"Ø¹Ù…Ø§Ø±Ø© ØªØ­ØªØ§Ø¬ ØªØ±Ù…ÙŠÙ…ØŒ ÙØ±ØµØ© Ø§Ø³ØªØ«Ù…Ø§Ø±ÙŠØ©", images:["https://images.unsplash.com/photo-1549187774-b4e9b0445b6b?q=80&w=1400&auto=format&fit=crop"], status:"pending", ownerType:"owner", package:"featured", tagsEN:["building","investment"], createdAt:Date.now()}
  ];
  samples.forEach(s=>props.push(s));
  persist();
}
seedIfEmpty();

/* ==========================
   UI Elements creation
   ========================== */
const categoriesMeta = [
  {key:'all',title:'Ø§Ù„ÙƒÙ„',sub:'Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¹Ù‚Ø§Ø±Ø§Øª',color:'#7ec6ff',icon:'ğŸ·ï¸'},
  {key:'ÙÙ„Ù„',title:'ÙÙ„Ù„',sub:'Ø¹Ù‚Ø§Ø±Ø§Øª Ø³ÙƒÙ†ÙŠØ© ÙØ§Ø®Ø±Ø©',color:'#ff8a65',icon:'ğŸ '},
  {key:'Ø´Ù‚Ù‚',title:'Ø´Ù‚Ù‚',sub:'Ø´Ù‚Ù‚ Ø³ÙƒÙ†ÙŠØ©',color:'#6dd3ff',icon:'ğŸ¢'},
  {key:'Ø¹Ù…Ø§Ø¦Ø±',title:'Ø¹Ù…Ø§Ø¦Ø±',sub:'Ø¹Ù‚Ø§Ø±Ø§Øª Ø§Ø³ØªØ«Ù…Ø§Ø±ÙŠØ©',color:'#ffd166',icon:'ğŸ¬'},
  {key:'Ø£Ø±Ø§Ø¶ÙŠ',title:'Ø£Ø±Ø§Ø¶ÙŠ',sub:'Ù‚Ø·Ø¹ Ø£Ø±Ø§Ø¶ÙŠ',color:'#b388ff',icon:'ğŸŒ±'},
  {key:'Ø§Ø³ØªØ±Ø§Ø­Ø§Øª',title:'Ø§Ø³ØªØ±Ø§Ø­Ø§Øª',sub:'Ø§Ø³ØªØ±Ø®Ø§Ø¡ ÙˆØªØ±ÙÙŠÙ‡',color:'#87f0d8',icon:'ğŸ–ï¸'},
  {key:'Ø£Ø¯ÙˆØ§Ø± Ù…Ø³ØªÙ‚Ù„Ø©',title:'Ø£Ø¯ÙˆØ§Ø± Ù…Ø³ØªÙ‚Ù„Ø©',sub:'Ø£Ø¯ÙˆØ§Ø± Ù„Ù„Ø¹ÙˆØ§Ø¦Ù„',color:'#a3d39c',icon:'ğŸ¡'}
];

function renderCategories(){
  const container = document.getElementById('categories');
  container.innerHTML = '';
  categoriesMeta.forEach(c=>{
    const d = document.createElement('div'); d.className='cat-tile'; d.setAttribute('data-cat',c.key);
    const icon = document.createElement('div'); icon.className='cat-icon'; icon.style.background=`linear-gradient(135deg, ${c.color}, rgba(255,255,255,0.14))`; icon.textContent = c.icon;
    const txt = document.createElement('div'); txt.className='cat-text'; txt.innerHTML = `<div class="cat-title">${c.title}</div><div class="cat-sub">${c.sub}</div>`;
    d.appendChild(icon); d.appendChild(txt);
    d.onclick = ()=>{ document.querySelectorAll('.cat-tile').forEach(x=>x.classList.remove('active')); d.classList.add('active'); renderGrid(); };
    container.appendChild(d);
  });
  // default active = all
  const first = container.querySelector('[data-cat="all"]'); if(first) first.classList.add('active');
}

/* ==========================
   Render Grid & Cards
   ========================== */
function getActiveCategory(){
  const el = document.querySelector('.cat-tile.active'); return el ? el.getAttribute('data-cat') : 'all';
}

function packageBadgeClass(pkg){
  if(pkg==='premium') return 'pkg-premium';
  if(pkg==='featured') return 'pkg-featured';
  return 'pkg-basic';
}

function createCard(p){
  const card = document.createElement('article'); card.className='prop-card'; card.dataset.id = p.id;
  // media
  const media = document.createElement('div'); media.className='prop-media';
  const img = document.createElement('img'); img.src = (p.images && p.images.length) ? p.images[0] : placeholder();
  media.appendChild(img);
  // package
  const badge = document.createElement('div'); badge.className = 'package-badge ' + packageBadgeClass(p.package || 'basic'); badge.textContent = (p.package || 'basic').toUpperCase();
  media.appendChild(badge);

  // body
  const body = document.createElement('div'); body.className='prop-body';
  const title = document.createElement('h3'); title.className='prop-title'; title.textContent = p.title;
  const short = document.createElement('div'); short.className='prop-short'; short.textContent = p.location + ' â€” ' + (p.desc ? (p.desc.length>80 ? p.desc.substring(0,80)+'...' : p.desc) : '');
  const meta = document.createElement('div'); meta.className='prop-meta';
  const price = document.createElement('div'); price.className='price'; price.textContent = numberFormat(p.price) + ' Ø±.Ø³';
  const rightMeta = document.createElement('div'); rightMeta.className = 'meta-right';
  const area = document.createElement('div'); area.className='chip'; area.textContent = (p.area? p.area+' Ù…Â²':'-');
  // English tags chips (small, optional)
  const tags = document.createElement('div'); tags.style.display='flex'; tags.style.gap='6px';
  (p.tagsEN||[]).slice(0,3).forEach(tg=>{ const c = document.createElement('div'); c.className='chip'; c.textContent = tg; c.style.fontSize='12px'; tags.appendChild(c); });

  rightMeta.appendChild(area); rightMeta.appendChild(tags);

  meta.appendChild(price); meta.appendChild(rightMeta);

  // actions
  const actions = document.createElement('div'); actions.className='card-actions';
  const btnView = document.createElement('button'); btnView.className='btn-small btn-view'; btnView.textContent='Ø¹Ø±Ø¶'; btnView.onclick = ()=> openDetail(p.id);
  const btnWS = document.createElement('button'); btnWS.className='btn-small btn-ws'; btnWS.textContent='ÙˆØ§ØªØ³Ø§Ø¨'; btnWS.onclick = ()=> {
    const text = `Ù…Ø±Ø­Ø¨Ù‹Ø§ØŒ Ø£Ø¹Ø¬Ø¨Ù†ÙŠ Ø§Ù„Ø¹Ù‚Ø§Ø±: ${p.title} (Ø±Ù‚Ù… ${p.id})\nØ§Ù„Ù…ÙˆÙ‚Ø¹: ${p.location}\nØ§Ù„Ø³Ø¹Ø±: ${numberFormat(p.price)} Ø±.Ø³\nØ£Ø±ÙŠØ¯ Ø§Ù„Ø§Ø³ØªÙØ³Ø§Ø±/Ø§Ù„Ø²ÙŠØ§Ø±Ø©.`;
    window.open(`https://wa.me/${ADMIN_WHATSAPP}?text=${encodeURIComponent(text)}`,'_blank');
  };

  actions.appendChild(btnView); actions.appendChild(btnWS);

  body.appendChild(title); body.appendChild(short); body.appendChild(meta); body.appendChild(actions);

  card.appendChild(media); card.appendChild(body);
  return card;
}

function numberFormat(n){ return Number(n).toLocaleString('en-US'); }

function renderGrid(){
  const grid = document.getElementById('gridProperties'); grid.innerHTML = '';
  const cat = getActiveCategory();
  const q = document.getElementById('globalSearch').value.trim().toLowerCase();
  const sort = document.getElementById('sort').value;
  let list = props.filter(p => p.status === 'approved');
  if(cat && cat !== 'all') list = list.filter(p => p.category === cat);
  if(q) list = list.filter(p => ((p.title||'') + ' ' + (p.location||'') + ' ' + (p.desc||'') + ' ' + (p.tagsEN||[]).join(' ')).toLowerCase().includes(q));
  if(sort === 'price-asc') list.sort((a,b)=>a.price-b.price);
  else if(sort === 'price-desc') list.sort((a,b)=>b.price-a.price);
  else list.sort((a,b)=>b.createdAt - a.createdAt);
  document.getElementById('countShown').textContent = list.length;
  if(!list.length){
    const no = document.createElement('div'); no.style.padding='20px'; no.style.color='#556'; no.textContent = 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¹Ù‚Ø§Ø±Ø§Øª Ø­Ø§Ù„ÙŠØ§Ù‹ ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„Ù‚Ø³Ù….';
    grid.appendChild(no); return;
  }
  list.forEach(p => grid.appendChild(createCard(p)));
}

/* show detail page (separate section) */
function openDetail(id){
  const p = props.find(x=>x.id==id); if(!p) return;
  document.getElementById('mainArea').style.display='none';
  document.getElementById('detailPage').style.display='block';
  fillDetail(p);
}
function fillDetail(p){
  document.getElementById('detailTitle').textContent = p.title;
  document.getElementById('detailLocation').textContent = p.location;
  document.getElementById('detailPrice').textContent = numberFormat(p.price) + ' Ø±.Ø³';
  document.getElementById('detailArea').textContent = (p.area || '-') + ' Ù…Â²';
  document.getElementById('detailDesc').textContent = p.desc || '-';
  document.getElementById('detailDeed').textContent = `Ø§Ù„ØµÙƒ: ${p.deed || 'Ù„Ø§'} â€” Ù‚Ø¨ÙˆÙ„ Ø§Ù„Ø¨Ù†Ùƒ: ${p.bank || 'Ù„Ø§'}`;
  document.getElementById('detailPackage').textContent = (p.package||'basic').toUpperCase();
  // tags
  const tagsWrap = document.getElementById('detailTags'); tagsWrap.innerHTML = '';
  (p.tagsEN||[]).forEach(tg=>{ const c=document.createElement('div'); c.className='chip'; c.style.fontSize='12px'; c.textContent=tg; tagsWrap.appendChild(c); });

  // images
  const main = document.querySelector('#detailMain img'); const thumbs = document.getElementById('detailThumbs'); thumbs.innerHTML='';
  const imgArr = (p.images && p.images.length) ? p.images : [placeholder()];
  main.src = imgArr[0];
  imgArr.forEach((src,i)=>{
    const im = document.createElement('img'); im.src = src; if(i===0) im.classList.add('active');
    im.onclick = ()=>{ main.src = src; thumbs.querySelectorAll('img').forEach(x=>x.classList.remove('active')); im.classList.add('active'); };
    thumbs.appendChild(im);
  });

  // whatsapp link (two modes offered: inquiry or visit)
  const base = `Ù…Ø±Ø­Ø¨Ù‹Ø§ØŒ Ø£Ø¹Ø¬Ø¨Ù†ÙŠ Ø§Ù„Ø¹Ù‚Ø§Ø±: ${p.title} (Ø±Ù‚Ù… ${p.id})\nØ§Ù„Ù…ÙˆÙ‚Ø¹: ${p.location}\nØ§Ù„Ø³Ø¹Ø±: ${numberFormat(p.price)} Ø±.Ø³`;
  document.getElementById('detailWhats').href = `https://wa.me/${ADMIN_WHATSAPP}?text=${encodeURIComponent(base + '\\n\\nØ£Ø±ÙŠØ¯ Ø§Ù„Ø§Ø³ØªÙØ³Ø§Ø±')}`;
}

/* go home */
function goHome(){
  document.getElementById('detailPage').style.display='none';
  document.getElementById('addPage').style.display='none';
  document.getElementById('adminPanel').style.display='none';
  document.getElementById('mainArea').style.display='block';
  renderCategories();
  renderGrid();
  // UI buttons
  document.getElementById('btnSiteEdit').style.display = isAdmin() ? 'inline-block' : 'none';
  document.getElementById('btnLogin').style.display = isAdmin() ? 'none' : 'inline-block';
}

/* ========== Add page actions ========== */
document.getElementById('addImgs').addEventListener('change', function(e){
  const files = Array.from(e.target.files).slice(0,3);
  const preview = document.getElementById('previewAdd'); preview.innerHTML='';
  const list = [];
  files.forEach(f=>{
    const fr = new FileReader();
    fr.onload = ev => {
      const img = document.createElement('img'); img.src = ev.target.result; img.style.width='120px'; img.style.height='80px'; img.style.objectFit='cover'; img.style.borderRadius='8px';
      preview.appendChild(img);
      list.push(ev.target.result);
      // store temporarily in window for submit
      window.__addImgs = list;
    };
    fr.readAsDataURL(f);
  });
});

document.getElementById('inputDeed').addEventListener('change', function(){
  document.getElementById('bankRow').style.display = this.value === 'Ù†Ø¹Ù…' ? 'block' : 'none';
});

/* submit add */
function submitAdd(e){
  e.preventDefault();
  const imgs = window.__addImgs || [];
  if(imgs.length < 1){ alert('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø±ÙØ¹ ØµÙˆØ±Ø© ÙˆØ§Ø­Ø¯Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„ (Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© Ø£ÙˆÙ„Ø§Ù‹).'); return; }
  if(imgs.length > 3){ alert('Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ 3 ØµÙˆØ±.'); return; }
  const pkg = document.getElementById('inputPackage').value || 'basic';
  const title = document.getElementById('inputTitle').value.trim(); const category = document.getElementById('inputCategory').value;
  const price = Number(document.getElementById('inputPrice').value || 0);
  const area = Number(document.getElementById('inputArea').value || 0);
  const location = document.getElementById('inputLocation').value.trim();
  const ownerPhone = document.getElementById('inputOwnerPhone').value.trim();
  const deed = document.getElementById('inputDeed').value; const bank = document.getElementById('inputBank').value || 'Ù„Ø§';
  const tagsEN = (document.getElementById('inputTags').value || '').split(',').map(x=>x.trim()).filter(Boolean);
  const desc = document.getElementById('inputDesc').value.trim();
  if(!title || !category || !price || !location || !ownerPhone){ alert('Ø§Ù„Ø±Ø¬Ø§Ø¡ ØªØ¹Ø¨Ø¦Ø© Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©'); return; }
  const obj = { id: nextId++, title, category, price, area, location, ownerPhone, deed, bank, desc, images: imgs.slice(0,3), status:'pending', ownerType:'owner', package:pkg, tagsEN, createdAt:Date.now() };
  props.push(obj); persist();
  alert('ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù† Ù„Ø§Ù†ØªØ¸Ø§Ø± Ù…ÙˆØ§ÙÙ‚Ø© Ø§Ù„Ù…Ø¯ÙŠØ±.');
  goHome(); renderGrid();
}

/* ========== WhatsApp quick actions ========== */
function openWhats(mode){
  if(mode === 'general'){
    const txt = encodeURIComponent('Ù…Ø±Ø­Ø¨Ù‹Ø§ØŒ Ù„Ø¯ÙŠ Ø§Ø³ØªÙØ³Ø§Ø± Ø¹Ø§Ù… Ø¹Ù† Ø§Ù„Ø¹Ù‚Ø§Ø±Ø§Øª ÙÙŠ Ù…Ù†ØµÙ‘ØªÙƒÙ….');
    window.open(`https://wa.me/${ADMIN_WHATSAPP}?text=${txt}`,'_blank');
  } else if(mode === 'visit'){
    const txt = encodeURIComponent('Ù…Ø±Ø­Ø¨Ù‹Ø§ØŒ Ø£Ø±ØºØ¨ Ø¨Ø²ÙŠØ§Ø±Ø© Ø¹Ù‚Ø§Ø± â€” Ù…Ù† ÙØ¶Ù„ÙƒÙ… Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹ÙŠ.');
    window.open(`https://wa.me/${ADMIN_WHATSAPP}?text=${txt}`,'_blank');
  }
}

/* ========== Admin (login via prompt) ========== */
function showLogin(){
  const u = prompt('Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…:'); if(!u) return;
  const p = prompt('ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±:'); if(!p) return;
  if(u === ADMIN_USERNAME && p === ADMIN_PASSWORD){
    sessionStorage.setItem('alq_admin_logged','true');
    openAdmin();
    alert('ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ ÙƒÙ…Ø¯ÙŠØ±');
  } else alert('Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„ ØºÙŠØ± ØµØ­ÙŠØ­Ø©');
}
function isAdmin(){ return sessionStorage.getItem('alq_admin_logged') === 'true' }
function adminLogout(){ if(confirm('ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬ØŸ')){ sessionStorage.removeItem('alq_admin_logged'); goHome(); alert('ØªÙ… Ø§Ù„Ø®Ø±ÙˆØ¬'); } }

function openAdmin(){
  document.getElementById('mainArea').style.display='none';
  document.getElementById('adminPanel').style.display='block';
  document.getElementById('btnSiteEdit').style.display='inline-block';
  document.getElementById('btnLogin').style.display='none';
  renderAdmin(); renderAdminTables();
}

/* admin features: stats, tables, approve, delete etc. */
function renderAdmin(){
  const total = props.length;
  const pending = props.filter(p=>p.status==='pending').length;
  const approved = props.filter(p=>p.status==='approved').length;
  document.getElementById('statTotal').querySelector('div').textContent = total;
  document.getElementById('statPending').querySelector('div').textContent = pending;
  document.getElementById('statApproved').querySelector('div').textContent = approved;
}

function switchTab(ev){
  document.querySelectorAll('.tabs .tab').forEach(t=>t.classList.remove('active'));
  ev.target.classList.add('active');
  const key = ev.target.getAttribute('data-tab');
  document.getElementById('tab-pending').style.display = key==='pending' ? 'block' : 'none';
  document.getElementById('tab-owners').style.display = key==='owners' ? 'block' : 'none';
  document.getElementById('tab-admin').style.display = key==='admin' ? 'block' : 'none';
  renderAdminTables();
}

function renderAdminTables(){
  const filter = document.getElementById('adminSearch').value.trim().toLowerCase();

  // pending
  const tbodyP = document.querySelector('#tablePending tbody'); tbodyP.innerHTML='';
  props.filter(p=>p.status==='pending').filter(p=>matchesFilter(p,filter)).forEach(p=>{
    const tr=document.createElement('tr');
    tr.innerHTML = `<td>${p.id}</td><td>${p.title}</td><td>${p.category}</td><td>${numberFormat(p.price)} Ø±.Ø³</td><td>${p.ownerPhone}</td><td>${(p.package||'basic').toUpperCase()}</td><td></td>`;
    const td = tr.querySelector('td:last-child');
    const btnA=document.createElement('button'); btnA.className='btn'; btnA.textContent='Ù…ÙˆØ§ÙÙ‚Ø©'; btnA.onclick=()=>{ approve(p.id); };
    const btnR=document.createElement('button'); btnR.className='btn btn-ghost'; btnR.textContent='Ø±ÙØ¶/Ø­Ø°Ù'; btnR.onclick=()=>{ if(confirm('Ø­Ø°Ù Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†ØŸ')) deleteById(p.id); };
    const btnE=document.createElement('button'); btnE.className='btn btn-ghost'; btnE.textContent='ØªØ¹Ø¯ÙŠÙ„'; btnE.onclick=()=> editAsAdmin(p.id);
    td.appendChild(btnA); td.appendChild(btnR); td.appendChild(btnE);
    tbodyP.appendChild(tr);
  });

  // owners
  const tbodyO = document.querySelector('#tableOwners tbody'); tbodyO.innerHTML='';
  props.filter(p=>p.ownerType==='owner').filter(p=>matchesFilter(p,filter)).forEach(p=>{
    const tr=document.createElement('tr');
    tr.innerHTML = `<td>${p.id}</td><td>${p.title}</td><td>${p.category}</td><td>${numberFormat(p.price)} Ø±.Ø³</td><td><span style="font-weight:900">${p.ownerPhone}</span></td><td>${p.status}</td><td></td>`;
    const td=tr.querySelector('td:last-child');
    const btnToggle=document.createElement('button'); btnToggle.className='btn'; btnToggle.textContent = p.status==='approved' ? 'ØªØ¹Ø·ÙŠÙ„' : 'ØªÙØ¹ÙŠÙ„'; btnToggle.onclick=()=>{ p.status = p.status==='approved' ? 'pending' : 'approved'; persist(); renderGrid(); renderAdminTables(); };
    const btnEdit=document.createElement('button'); btnEdit.className='btn btn-ghost'; btnEdit.textContent='ØªØ¹Ø¯ÙŠÙ„'; btnEdit.onclick=()=> editAsAdmin(p.id);
    const btnDelete=document.createElement('button'); btnDelete.className='btn btn-ghost'; btnDelete.textContent='Ø­Ø°Ù'; btnDelete.onclick=()=> { if(confirm('Ø­Ø°Ù Ù†Ù‡Ø§Ø¦ÙŠ')) deleteById(p.id); };
    td.appendChild(btnToggle); td.appendChild(btnEdit); td.appendChild(btnDelete);
    tbodyO.appendChild(tr);
  });

  // admin properties
  const tbodyA = document.querySelector('#tableAdmin tbody'); tbodyA.innerHTML='';
  props.filter(p=>p.ownerType==='admin').filter(p=>matchesFilter(p,filter)).forEach(p=>{
    const tr=document.createElement('tr');
    tr.innerHTML = `<td>${p.id}</td><td>${p.title}</td><td>${p.category}</td><td>${numberFormat(p.price)} Ø±.Ø³</td><td>${p.status}</td><td></td>`;
    const td=tr.querySelector('td:last-child');
    const btnEdit=document.createElement('button'); btnEdit.className='btn btn-ghost'; btnEdit.textContent='ØªØ¹Ø¯ÙŠÙ„'; btnEdit.onclick=()=> editAsAdmin(p.id);
    const btnDelete=document.createElement('button'); btnDelete.className='btn btn-ghost'; btnDelete.textContent='Ø­Ø°Ù'; btnDelete.onclick=()=> { if(confirm('Ø­Ø°ÙØŸ')) deleteById(p.id); };
    td.appendChild(btnEdit); td.appendChild(btnDelete);
    tbodyA.appendChild(tr);
  });
}

/* helpers */
function matchesFilter(p, q){
  if(!q) return true;
  return (p.title||'').toLowerCase().includes(q) || (p.location||'').toLowerCase().includes(q) || (String(p.id)===q) || (p.ownerPhone||'').includes(q) || ((p.tagsEN||[]).join(' ').toLowerCase().includes(q));
}

function approve(id){ const p = props.find(x=>x.id==id); if(!p) return; p.status='approved'; persist(); renderGrid(); renderAdminTables(); alert('ØªÙ…Øª Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø©'); }
function deleteById(id){ props = props.filter(x=>x.id!=id); persist(); renderGrid(); renderAdminTables(); alert('ØªÙ… Ø§Ù„Ø­Ø°Ù'); }
function editAsAdmin(id){
  // open add page and prefill; mark ownerType admin if chosen
  const p = props.find(x=>x.id==id); if(!p) return;
  openAddPage();
  // fill fields
  document.getElementById('inputPackage').value = p.package || 'basic';
  document.getElementById('inputTitle').value = p.title;
  document.getElementById('inputCategory').value = p.category;
  document.getElementById('inputPrice').value = p.price;
  document.getElementById('inputArea').value = p.area || '';
  document.getElementById('inputLocation').value = p.location;
  document.getElementById('inputOwnerPhone').value = p.ownerPhone;
  document.getElementById('inputDeed').value = p.deed || 'Ù„Ø§';
  document.getElementById('inputBank').value = p.bank || 'Ù„Ø§';
  document.getElementById('inputTags').value = (p.tagsEN||[]).join(',');
  document.getElementById('inputDesc').value = p.desc || '';
  // preview images
  const preview = document.getElementById('previewAdd'); preview.innerHTML='';
  window.__addImgs = (p.images || []).slice();
  (p.images || []).forEach(src => {
    const img = document.createElement('img'); img.src = src; img.style.width='120px'; img.style.height='80px'; img.style.objectFit='cover'; img.style.borderRadius='8px';
    preview.appendChild(img);
  });
  // mark edit state
  window.__editing = p.id;
}

/* bulk approve */
function bulkApprove(){
  const toApprove = props.filter(p=>p.status==='pending');
  if(!toApprove.length) return alert('Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¥Ø¹Ù„Ø§Ù†Ø§Øª Ø¨Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø©');
  if(!confirm(`Ù‡Ù„ ØªØ±ÙŠØ¯ Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø© Ø¹Ù„Ù‰ ${toApprove.length} Ø¥Ø¹Ù„Ø§Ù†ØŸ`)) return;
  toApprove.forEach(p=>p.status='approved');
  persist(); renderGrid(); renderAdminTables(); alert('ØªÙ…Øª Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø¬Ù…ÙŠØ¹');
}

/* export CSV */
function exportCSV(){
  const rows = [['id','title','category','price','area','location','ownerPhone','status','package','tagsEN','createdAt']];
  props.forEach(p=>{
    rows.push([p.id,escapeCSV(p.title),p.category,p.price,p.area,p.location,p.ownerPhone,p.status,p.package,(p.tagsEN||[]).join('|'),p.createdAt]);
  });
  const csvContent = rows.map(r=>r.join(',')).join('\n');
  const blob = new Blob([csvContent],{type:'text/csv;charset=utf-8;'});
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a'); a.href = url; a.download = 'properties_export.csv'; a.click(); URL.revokeObjectURL(url);
}

/* escape CSV helper */
function escapeCSV(s){ if(!s) return ''; return `"${String(s).replace(/"/g,'""')}"`; }

/* admin add as admin */
function adminAdd(){ // open add page and set flag
  openAddPage();
  window.__asAdminAdd = true;
}

/* submit add updated: support edit and admin add */
const originalSubmitAdd = submitAdd;
submitAdd = function(e){
  e.preventDefault();
  const imgs = window.__addImgs || [];
  if(imgs.length < 1){ alert('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø±ÙØ¹ ØµÙˆØ±Ø© ÙˆØ§Ø­Ø¯Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„'); return; }
  if(imgs.length > 3){ alert('Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ 3 ØµÙˆØ±'); return; }
  const pkg = document.getElementById('inputPackage').value || 'basic';
  const title = document.getElementById('inputTitle').value.trim(); const category = document.getElementById('inputCategory').value;
  const price = Number(document.getElementById('inputPrice').value);
  const area = Number(document.getElementById('inputArea').value || 0);
  const location = document.getElementById('inputLocation').value.trim();
  const ownerPhone = document.getElementById('inputOwnerPhone').value.trim();
  const deed = document.getElementById('inputDeed').value;
  const bank = document.getElementById('inputBank').value || 'Ù„Ø§';
  const tagsEN = (document.getElementById('inputTags').value||'').split(',').map(x=>x.trim()).filter(Boolean);
  const desc = document.getElementById('inputDesc').value.trim();
  if(!title || !category || !price || !location || !ownerPhone){ alert('Ø§Ù„Ø±Ø¬Ø§Ø¡ ØªØ¹Ø¨Ø¦Ø© Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©'); return; }

  // editing existing
  if(window.__editing){
    const id = window.__editing; const p = props.find(x=>x.id==id);
    if(!p){ alert('Ø®Ø·Ø£: Ø§Ù„Ø¹Ù‚Ø§Ø± ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯'); window.__editing = null; return; }
    p.title = title; p.category = category; p.price = price; p.area = area; p.location = location; p.ownerPhone = ownerPhone; p.deed = deed; p.bank = bank; p.tagsEN = tagsEN; p.desc = desc; p.images = imgs.slice(0,3);
    persist(); window.__editing = null; alert('ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ù‚Ø§Ø±'); goHome(); renderGrid(); renderAdminTables(); return;
  }

  // adding
  const obj = { id: nextId++, title, category, price, area, location, ownerPhone, deed, bank, desc, images: imgs.slice(0,3), status: window.__asAdminAdd ? 'approved' : 'pending', ownerType: window.__asAdminAdd ? 'admin' : 'owner', package:pkg, tagsEN, createdAt:Date.now() };
  props.push(obj); persist();
  window.__asAdminAdd = false;
  alert(obj.status==='approved' ? 'ØªÙ… Ø¥Ø¶Ø§ÙØ© ÙˆÙ†Ø´Ø± Ø§Ù„Ø¹Ù‚Ø§Ø±' : 'ØªÙ… Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ Ø¨Ø§Ù†ØªØ¸Ø§Ø± Ù…ÙˆØ§ÙÙ‚Ø© Ø§Ù„Ù…Ø¯ÙŠØ±');
  goHome(); renderGrid(); renderAdminTables();
};

/* edit site name (admin only) */
function editSiteName(){
  if(!isAdmin()) return alert('ØºÙŠØ± Ù…ØµØ±Ø­');
  const v = prompt('Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù…ÙˆÙ‚Ø¹', document.getElementById('siteName').textContent);
  if(v && v.trim()!==''){ document.getElementById('siteName').textContent=v.trim(); document.getElementById('logoText').textContent=v.trim().split(' ').map(s=>s[0]).slice(0,3).join(''); }
}

/* open add page */
function openAddPage(){ document.getElementById('mainArea').style.display='none'; document.getElementById('addPage').style.display='block'; document.getElementById('detailPage').style.display='none'; }

/* helper placeholder image */
function placeholder(){ return 'data:image/svg+xml;utf8,'+encodeURIComponent(`<svg xmlns='http://www.w3.org/2000/svg' width='1200' height='800'><rect width='100%' height='100%' fill='#e9f0f5'/><text x='50%' y='50%' font-size='28' text-anchor='middle' fill='#9bb3c9' font-family='Arial' dy='.3em'>No Image</text></svg>`); }

/* clear filters */
function clearFilters(){ document.getElementById('globalSearch').value=''; document.getElementById('sort').value='recent'; document.querySelectorAll('.cat-tile').forEach(x=>x.classList.remove('active')); document.querySelector('.cat-tile[data-cat="all"]').classList.add('active'); renderGrid(); }

/* ========== Initialization ========== */
renderCategories();
renderGrid();

/* render admin only if logged in */
if(isAdmin()) openAdmin();

/* events */
document.getElementById('globalSearch').addEventListener('input', ()=> setTimeout(renderGrid,200));
document.getElementById('sort').addEventListener('change', renderGrid);
document.getElementById('adminSearch').addEventListener('input', renderAdminTables);

/* keyboard escape to go home */
document.addEventListener('keydown', e=>{ if(e.key==='Escape') goHome(); });

</script>
</body>
</html>
